---
title: Игнорировать текст внутри Вставить исправления
linktitle: Игнорировать текст внутри Вставить исправления
second_title: Справочник по API Aspose.Words для .NET
description: Узнайте, как использовать функцию «Игнорировать текст внутри ревизий вставки» в Aspose.Words для .NET для управления вставками редакций в документы Word.
type: docs
weight: 10
url: /ru/net/find-and-replace-text/ignore-text-inside-insert-revisions/
---

В этой статье мы рассмотрим приведенный выше исходный код C#, чтобы понять, как использовать функцию «Игнорировать текст внутри вставки изменений» в библиотеке Aspose.Words для .NET. Эта функция полезна, когда мы хотим игнорировать текст внутри ревизий вставки при манипулировании документами.

## Предпосылки

- Базовые знания языка С#.
- Среда разработки .NET с установленной библиотекой Aspose.Words.

## Шаг 1: Создание нового документа

 Прежде чем мы начнем манипулировать текстом внутри ревизий вставки, нам нужно создать новый документ, используя Aspose.Words для .NET. Это можно сделать, создав экземпляр`Document` объект:

```csharp
Document doc = new Document();
```

## Шаг 2. Вставьте текст с отслеживанием изменений

 Когда у нас есть документ, мы можем вставить текст с отслеживанием изменений, используя`DocumentBuilder` объект. Например, чтобы вставить текст «Вставлено» с отслеживанием изменений, мы можем использовать`StartTrackRevisions`, `Writeln` и`StopTrackRevisions` методы:

```csharp
DocumentBuilder builder = new DocumentBuilder(doc);
doc.StartTrackRevisions("author", DateTime.Now);
builder.Writeln("Inserted");
doc.StopTrackRevisions();
```

## Шаг 3. Вставьте непроверенный текст

 В дополнение к тексту с отслеживанием редакций мы также можем вставлять неотредактированный текст, используя`DocumentBuilder`объект. Например, чтобы вставить текст «Текст» без редактирования, мы можем использовать`Write` метод:

```csharp
builder.Write("Text");
```

## Шаг 4. Использование функции «Игнорировать текст внутри вставки изменений»

 Чтобы игнорировать текст внутри ревизий вставки при последующих операциях, мы можем использовать`FindReplaceOptions` объект и установить`IgnoreInserted` собственность на`true`:

```csharp
FindReplaceOptions options = new FindReplaceOptions { IgnoreInserted = true };
```

## Шаг 5. Использование регулярных выражений для поиска и замены

Для выполнения операций поиска и замены в тексте документа будем использовать регулярные выражения. В нашем примере мы будем искать все вхождения буквы «e» и заменять их звездочкой «* ". Мы будем использовать .NET`Regex` класс для этого:

```csharp
Regex regex = new Regex("e");
doc.Range.Replace(regex, "*", options);
```

## Шаг 6: Просмотр измененного вывода документа

После применения поиска и замены мы можем отобразить измененное содержимое документа с помощью`GetText` метод:

```csharp
Console.WriteLine(doc.GetText());
```

## Шаг 7. Изменение параметров для включения ревизий вставки

 Если мы хотим включить текст внутри ревизий вставки в выходной результат, мы можем изменить параметры, чтобы не игнорировать ревизии вставки. Для этого установим`IgnoreInserted` собственность на`false`:

```csharp
options.IgnoreInserted = false;
```

## Шаг 8: Просмотр измененного документа со вставкой изменений

После изменения параметров мы можем снова выполнить поиск и замену, чтобы получить результат с включенным текстом внутри ревизий вставки:

```csharp
doc.Range.Replace(regex, "*", options);
Console.WriteLine(doc.GetText());
```


### Пример исходного кода для игнорирования текста внутри вставки ревизий с использованием Aspose.Words для .NET

Вот полный пример исходного кода, демонстрирующий использование функции «Игнорировать текст внутри вставки изменений» с Aspose.Words для .NET:


```csharp
       
	Document doc = new Document();
	DocumentBuilder builder = new DocumentBuilder(doc);

	// Вставьте текст с отслеживанием изменений.
	doc.StartTrackRevisions("author", DateTime.Now);
	builder.Writeln("Inserted");
	doc.StopTrackRevisions();

	// Вставьте неисправленный текст.
	builder.Write("Text");

	FindReplaceOptions options = new FindReplaceOptions { IgnoreInserted = true };

	Regex regex = new Regex("e");
	doc.Range.Replace(regex, "*", options);
	
	Console.WriteLine(doc.GetText());

	options.IgnoreInserted = false;
	doc.Range.Replace(regex, "*", options);
	
	Console.WriteLine(doc.GetText());
   
```

## Заключение

В этой статье мы изучили исходный код C#, чтобы понять, как использовать функцию «Игнорировать текст внутри вставки изменений» в Aspose.Words для .NET. Мы следовали пошаговому руководству по созданию документа, вставке текста с отслеживанием редакций и неисправленного текста, использованию функции «Игнорировать текст внутри вставки редакций», выполнению операций поиска и замены с помощью регулярных выражений и отображению измененного документа.