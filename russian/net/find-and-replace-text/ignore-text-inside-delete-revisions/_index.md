---
title: Игнорировать текст внутри Удалить версии
linktitle: Игнорировать текст внутри Удалить версии
second_title: Справочник по API Aspose.Words для .NET
description: Узнайте, как использовать функцию «Игнорировать текст внутри удаления ревизий» Aspose.Words для .NET.
type: docs
weight: 10
url: /ru/net/find-and-replace-text/ignore-text-inside-delete-revisions/
---

В этой статье мы рассмотрим приведенный выше исходный код C#, чтобы понять, как использовать функцию «Игнорировать текст внутри удаления ревизий» в библиотеке Aspose.Words для .NET. Эта функция полезна, когда мы хотим игнорировать текст внутри редакций удаления при работе с документами.

## Обзор библиотеки Aspose.Words для .NET

Прежде чем углубляться в детали кода, позвольте мне кратко представить библиотеку Aspose.Words for .NET. Это мощная библиотека, позволяющая создавать, изменять и преобразовывать документы Word в приложениях .NET. Он предлагает множество расширенных функций для работы с документами, включая управление версиями.

## Понимание функции «Игнорировать текст внутри удаления ревизий»

Функция «Игнорировать текст внутри редакций удаления» в Aspose.Words для .NET позволяет указать, следует ли игнорировать текст внутри редакций удаления во время определенных операций, таких как поиск и замена текста. Когда эта функция включена, удаленный текст внутри ревизий не учитывается при выполнении операций.

## Шаг 1: Создание нового документа с помощью Aspose.Words для .NET

 Прежде чем мы начнем манипулировать текстом в документе, нам нужно создать новый документ, используя Aspose.Words для .NET. Это можно сделать, создав экземпляр`Document` объект:

```csharp
Document doc = new Document();
```

## Шаг 2. Вставка неотредактированного текста в документ

 Когда у нас есть документ, мы можем вставить непросмотренный текст, используя`DocumentBuilder` объект. Например, чтобы вставить текст «Удаленный текст», мы можем использовать`Writeln` и`Write` методы:

```csharp
DocumentBuilder builder = new DocumentBuilder(doc);
builder. Writen("Deleted");
builder. Write("Text");
```

## Шаг 3. Удаление абзаца с отслеживанием правок

Чтобы проиллюстрировать использование функции «Игнорировать текст внутри удаления редакций», мы удалим абзац из документа с помощью отслеживания редакций. Это позволит нам увидеть, как эта функция влияет на последующие операции.

```csharp
doc.StartTrackRevisions("author", DateTime.Now);
doc.FirstSection.Body.FirstParagraph.Remove();
doc.StopTrackRevisions();
```

## Шаг 4. Применение функции «Игнорировать текст внутри удаления ревизий»

 Теперь, когда мы подготовили наш документ, удалив абзац, мы можем включить функцию «Игнорировать текст внутри удаления ревизий», используя`FindReplaceOptions` объект. Мы установим`IgnoreDeleted` собственность на`true`:

```csharp
FindReplaceOptions options = new FindReplaceOptions { IgnoreDeleted = true };
```

## Шаг 5. Использование регулярных выражений для поиска и замены

Для выполнения операций поиска и замены по тексту документа будем использовать регулярные выражения. В нашем примере мы будем искать все вхождения буквы «e» и заменять их звездочкой «* ". .СЕТЬ`Regex` для этого используется класс:

```csharp
Regex regex = new Regex("e");
doc.Range.Replace(regex, "*", options);
```

## Шаг 6: Отображение измененного вывода документа

После применения поиска и замены мы можем отобразить измененное содержимое документа с помощью`GetText` метод:

```csharp
Console.WriteLine(doc.GetText());
```

## Шаг 7. Изменение параметров для включения удаленного текста

 Если мы хотим включить удаленный текст в результат вывода, мы можем изменить параметры, чтобы не игнорировать удаленный текст. Для этого установим`IgnoreDeleted` собственность на`false`:

```csharp
options. IgnoreDeleted = false;
```

## Шаг 8: Вывод измененного документа с удаленным текстом

После изменения параметров мы можем снова выполнить поиск и замену, чтобы получить результат с включенным удаленным текстом:

```csharp
doc.Range.Replace(regex, "*", options);
Console.WriteLine(doc.GetText());
```

### Пример исходного кода для игнорирования текста внутри удаления ревизий с использованием Aspose.Words для .NET

Вот полный пример исходного кода, демонстрирующий использование функции «Игнорировать текст внутри удаления ревизий» с Aspose.Words для .NET:

```csharp
        
	Document doc = new Document();
	DocumentBuilder builder = new DocumentBuilder(doc);

	// Вставьте неисправленный текст.
	builder.Writeln("Deleted");
	builder.Write("Text");

	// Удалите первый абзац с отслеживанием правок.
	doc.StartTrackRevisions("author", DateTime.Now);
	doc.FirstSection.Body.FirstParagraph.Remove();
	doc.StopTrackRevisions();

	FindReplaceOptions options = new FindReplaceOptions { IgnoreDeleted = true };

	Regex regex = new Regex("e");
	doc.Range.Replace(regex, "*", options);

	Console.WriteLine(doc.GetText());

	options.IgnoreDeleted = false;
	doc.Range.Replace(regex, "*", options);

	Console.WriteLine(doc.GetText());
    
```

## Заключение

В этой статье мы изучили исходный код C#, чтобы понять, как использовать функцию «Игнорировать текст внутри удаления ревизий» в Aspose.Words для .NET. Эта функция полезна для игнорирования текста внутри редакций удаления при манипулировании документами. Мы следовали пошаговому руководству, чтобы создать документ, вставить текст, удалить абзац с отслеживанием изменений, применить функцию «Игнорировать текст внутри удаления изменений» и выполнить операции поиска и замены.

