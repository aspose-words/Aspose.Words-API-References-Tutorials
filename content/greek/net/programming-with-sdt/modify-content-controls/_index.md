---
title: Τροποποίηση στοιχείων ελέγχου περιεχομένου
linktitle: Τροποποίηση στοιχείων ελέγχου περιεχομένου
second_title: Aspose.Words Document Processing API
description: Μάθετε πώς να τροποποιείτε ετικέτες δομημένων εγγράφων στο Word χρησιμοποιώντας το Aspose.Words για .NET. Ενημερώστε κείμενο, αναπτυσσόμενα μενού και εικόνες βήμα προς βήμα.
type: docs
weight: 10
url: /el/net/programming-with-sdt/modify-content-controls/
---
## Εισαγωγή

Εάν έχετε εργαστεί ποτέ με έγγραφα του Word και χρειάστηκε να τροποποιήσετε στοιχεία ελέγχου δομημένου περιεχομένου—όπως απλό κείμενο, αναπτυσσόμενες λίστες ή εικόνες—χρησιμοποιώντας το Aspose.Words για .NET, είστε στο σωστό μέρος! Οι ετικέτες δομημένου εγγράφου (SDT) είναι ισχυρά εργαλεία που κάνουν την αυτοματοποίηση εγγράφων ευκολότερη και πιο ευέλικτη. Σε αυτό το σεμινάριο, θα εξετάσουμε πώς μπορείτε να τροποποιήσετε αυτά τα SDT για να ταιριάζουν στις ανάγκες σας. Είτε ενημερώνετε κείμενο, αλλάζετε τις αναπτυσσόμενες επιλογές ή αλλάζετε εικόνες, αυτός ο οδηγός θα σας καθοδηγήσει στη διαδικασία βήμα προς βήμα.

## Προαπαιτούμενα

Προτού προχωρήσουμε στην απρόσκοπτη τροποποίηση των στοιχείων ελέγχου περιεχομένου, βεβαιωθείτε ότι έχετε τα εξής:

1.  Aspose.Words for .NET Installed: Βεβαιωθείτε ότι έχετε εγκαταστήσει τη βιβλιοθήκη Aspose.Words. Εάν όχι, μπορείτε[κατεβάστε το εδώ](https://releases.aspose.com/words/net/).

2. Βασικές γνώσεις C#: Αυτό το σεμινάριο προϋποθέτει ότι είστε εξοικειωμένοι με βασικές έννοιες προγραμματισμού C#.

3. Ένα περιβάλλον ανάπτυξης .NET: Θα πρέπει να έχετε ρυθμίσει ένα IDE όπως το Visual Studio για την εκτέλεση εφαρμογών .NET.

4. Ένα δείγμα εγγράφου: Θα χρησιμοποιήσουμε ένα δείγμα εγγράφου του Word με διάφορους τύπους SDT. Μπορείτε να χρησιμοποιήσετε αυτό από το παράδειγμα ή να δημιουργήσετε το δικό σας.

5.  Πρόσβαση στην τεκμηρίωση Aspose: Για πιο λεπτομερείς πληροφορίες, ανατρέξτε στο[Aspose.Words τεκμηρίωση](https://reference.aspose.com/words/net/).

## Εισαγωγή χώρων ονομάτων

Για να ξεκινήσετε να εργάζεστε με το Aspose.Words, πρέπει να εισαγάγετε τους σχετικούς χώρους ονομάτων στο έργο σας C#. Δείτε πώς το κάνετε:

```csharp
using Aspose.Words;
using Aspose.Words.Drawing;
using Aspose.Words.Tables;
```

Αυτοί οι χώροι ονομάτων θα σας δώσουν πρόσβαση στις κλάσεις και τις μεθόδους που είναι απαραίτητες για τον χειρισμό ετικετών δομημένων εγγράφων στα έγγραφα του Word.

## Βήμα 1: Ρυθμίστε τη διαδρομή του εγγράφου σας

 Πριν κάνετε οποιεσδήποτε αλλαγές, πρέπει να καθορίσετε τη διαδρομή προς το έγγραφό σας. Αντικαθιστώ`"YOUR DOCUMENT DIRECTORY"` με την πραγματική διαδρομή όπου είναι αποθηκευμένο το έγγραφό σας.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document doc = new Document(dataDir + "Structured document tags.docx");
```

## Βήμα 2: Κάνε βρόχο μέσω ετικετών δομημένου εγγράφου

 Για να τροποποιήσετε τα SDT, πρέπει πρώτα να πραγματοποιήσετε αναζήτηση σε όλα τα SDT στο έγγραφο. Αυτό γίνεται χρησιμοποιώντας το`GetChildNodes` μέθοδος λήψης όλων των κόμβων τύπου`StructuredDocumentTag`.

```csharp
foreach (StructuredDocumentTag sdt in doc.GetChildNodes(NodeType.StructuredDocumentTag, true))
{
    // Τροποποιήστε τα SDT με βάση τον τύπο τους
}
```

## Βήμα 3: Τροποποίηση SDT απλού κειμένου

Εάν το SDT είναι τύπος απλού κειμένου, μπορείτε να αντικαταστήσετε το περιεχόμενό του. Πρώτα, διαγράψτε το υπάρχον περιεχόμενο και, στη συνέχεια, προσθέστε νέο κείμενο.

```csharp
if (sdt.SdtType == SdtType.PlainText)
{
    sdt.RemoveAllChildren();
    Paragraph para = sdt.AppendChild(new Paragraph(doc)) as Paragraph;
    Run run = new Run(doc, "new text goes here");
    para.AppendChild(run);
}
```

 Εξήγηση: Εδώ,`RemoveAllChildren()`διαγράφει το υπάρχον περιεχόμενο του SDT. Στη συνέχεια δημιουργούμε ένα νέο`Paragraph`και`Run` αντικείμενο για να εισαγάγετε το νέο κείμενο.

## Βήμα 4: Τροποποίηση SDT της αναπτυσσόμενης λίστας

 Για τα SDT της αναπτυσσόμενης λίστας, μπορείτε να αλλάξετε το επιλεγμένο στοιχείο μεταβαίνοντας στο`ListItems` συλλογή. Εδώ, επιλέγουμε το τρίτο στοιχείο στη λίστα.

```csharp
if (sdt.SdtType == SdtType.DropDownList)
{
    SdtListItem secondItem = sdt.ListItems[2];
    sdt.ListItems.SelectedValue = secondItem;
}
```

Επεξήγηση: Αυτό το απόσπασμα κώδικα επιλέγει το στοιχείο στο ευρετήριο 2 (τρίτο στοιχείο) από την αναπτυσσόμενη λίστα. Προσαρμόστε το ευρετήριο με βάση τις ανάγκες σας.

## Βήμα 5: Τροποποίηση SDT εικόνας

Για να ενημερώσετε μια εικόνα σε μια εικόνα SDT, μπορείτε να αντικαταστήσετε την υπάρχουσα εικόνα με μια νέα.

```csharp
if (sdt.SdtType == SdtType.Picture)
{
    Shape shape = (Shape) sdt.GetChild(NodeType.Shape, 0, true);
    if (shape.HasImage)
    {
        shape.ImageData.SetImage(ImagesDir + "Watermark.png");
    }
}
```

 Επεξήγηση: Αυτός ο κώδικας ελέγχει εάν το σχήμα περιέχει μια εικόνα και στη συνέχεια την αντικαθιστά με μια νέα εικόνα που βρίσκεται στο`ImagesDir`.

## Βήμα 6: Αποθηκεύστε το τροποποιημένο έγγραφό σας

Αφού κάνετε όλες τις απαραίτητες αλλαγές, αποθηκεύστε το τροποποιημένο έγγραφο με νέο όνομα για να διατηρήσετε ανέπαφο το αρχικό σας έγγραφο.

```csharp
doc.Save(dataDir + "WorkingWithSdt.ModifyContentControls.docx");
```

Επεξήγηση: Αυτό αποθηκεύει το έγγραφο με ένα νέο όνομα αρχείου, ώστε να μπορείτε να το διαφοροποιήσετε εύκολα από το πρωτότυπο.

## συμπέρασμα

Η τροποποίηση των στοιχείων ελέγχου περιεχομένου σε ένα έγγραφο του Word χρησιμοποιώντας το Aspose.Words για .NET είναι απλή όταν κατανοήσετε τα βήματα που απαιτούνται. Είτε ενημερώνετε κείμενο, αλλάζετε τις αναπτυσσόμενες επιλογές ή αλλάζετε εικόνες, το Aspose.Words παρέχει ένα ισχυρό API για αυτές τις εργασίες. Ακολουθώντας αυτό το σεμινάριο, μπορείτε να διαχειριστείτε αποτελεσματικά και να προσαρμόσετε τα στοιχεία ελέγχου δομημένου περιεχομένου του εγγράφου σας, κάνοντας τα έγγραφά σας πιο δυναμικά και προσαρμοσμένα στις ανάγκες σας.

## Συχνές ερωτήσεις

1. Τι είναι η ετικέτα δομημένου εγγράφου (SDT);

Τα SDT είναι στοιχεία σε έγγραφα του Word που βοηθούν στη διαχείριση και τη μορφοποίηση του περιεχομένου του εγγράφου, όπως πλαίσια κειμένου, αναπτυσσόμενες λίστες ή εικόνες.

2. Πώς μπορώ να προσθέσω ένα νέο αναπτυσσόμενο στοιχείο σε ένα SDT;

 Για να προσθέσετε ένα νέο στοιχείο, χρησιμοποιήστε το`ListItems` ιδιοκτησία και προσάρτηση νέας`SdtListItem` στη συλλογή.

3. Μπορώ να χρησιμοποιήσω το Aspose.Words για να αφαιρέσω SDT από ένα έγγραφο;

Ναι, μπορείτε να αφαιρέσετε SDT μεταβαίνοντας στους κόμβους του εγγράφου και διαγράφοντας το επιθυμητό SDT.

4. Πώς μπορώ να χειριστώ τα SDT που είναι ένθετα μέσα σε άλλα στοιχεία;

 Χρησιμοποιήστε το`GetChildNodes` μέθοδος με κατάλληλες παραμέτρους για πρόσβαση σε ένθετα SDT.

5. Τι πρέπει να κάνω εάν το SDT που πρέπει να τροποποιήσω δεν είναι ορατό στο έγγραφο;

Βεβαιωθείτε ότι το SDT δεν είναι κρυφό ή προστατευμένο. Ελέγξτε τις ρυθμίσεις του εγγράφου και βεβαιωθείτε ότι ο κωδικός σας στοχεύει σωστά τον τύπο SDT.


### Παράδειγμα πηγαίου κώδικα για Τροποποίηση στοιχείων ελέγχου περιεχομένου χρησιμοποιώντας το Aspose.Words για .NET 

```csharp
// Διαδρομή στον κατάλογο εγγράφων σας
string dataDir = "YOUR DOCUMENT DIRECTORY";

Document doc = new Document(dataDir + "Structured document tags.docx");
foreach (StructuredDocumentTag sdt in doc.GetChildNodes(NodeType.StructuredDocumentTag, true))
{
	switch (sdt.SdtType)
	{
		case SdtType.PlainText:
		{
			sdt.RemoveAllChildren();
			Paragraph para = sdt.AppendChild(new Paragraph(doc)) as Paragraph;
			Run run = new Run(doc, "new text goes here");
			para.AppendChild(run);
			break;
		}
		case SdtType.DropDownList:
		{
			SdtListItem secondItem = sdt.ListItems[2];
			sdt.ListItems.SelectedValue = secondItem;
			break;
		}
		case SdtType.Picture:
		{
			Shape shape = (Shape) sdt.GetChild(NodeType.Shape, 0, true);
			if (shape.HasImage)
			{
				shape.ImageData.SetImage(ImagesDir + "Watermark.png");
			}
			break;
		}
	}
}
doc.Save(dataDir + "WorkingWithSdt.ModifyContentControls.docx");

```

Αυτό είναι! Έχετε τροποποιήσει με επιτυχία διαφορετικούς τύπους στοιχείων ελέγχου περιεχομένου στο έγγραφο του Word χρησιμοποιώντας το Aspose.Words για .NET.