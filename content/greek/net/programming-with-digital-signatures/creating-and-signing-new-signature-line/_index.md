---
title: Δημιουργία και υπογραφή νέας γραμμής υπογραφής
linktitle: Δημιουργία και υπογραφή νέας γραμμής υπογραφής
second_title: Aspose.Words Document Processing API
description: Μάθετε πώς να δημιουργείτε και να υπογράφετε ψηφιακά μια γραμμή υπογραφής σε ένα έγγραφο του Word χρησιμοποιώντας το Aspose.Words για .NET με αυτό το βήμα προς βήμα σεμινάριο. Ιδανικό για αυτοματοποίηση εγγράφων.
type: docs
weight: 10
url: /el/net/programming-with-digital-signatures/creating-and-signing-new-signature-line/
---
## Εισαγωγή

Γεια σου! Έτσι, έχετε ένα έγγραφο του Word και πρέπει να προσθέσετε μια γραμμή υπογραφής και στη συνέχεια να το υπογράψετε ψηφιακά. Ακούγεται δύσκολο; Καθόλου! Χάρη στο Aspose.Words για .NET, μπορείτε να το επιτύχετε απρόσκοπτα με λίγες μόνο γραμμές κώδικα. Σε αυτό το σεμινάριο, θα σας καθοδηγήσουμε σε όλη τη διαδικασία από τη ρύθμιση του περιβάλλοντος σας έως την αποθήκευση του εγγράφου σας με μια λαμπερή νέα υπογραφή. Ετοιμος; Ας βουτήξουμε!

## Προαπαιτούμενα

Προτού μεταβούμε στον κώδικα, ας βεβαιωθούμε ότι έχετε όλα όσα χρειάζεστε:
1.  Aspose.Words for .NET - Μπορείτε[κατεβάστε το εδώ](https://releases.aspose.com/words/net/).
2. Ένα .NET Development Environment - Visual Studio συνιστάται ιδιαίτερα.
3. Ένα έγγραφο προς υπογραφή - Δημιουργήστε ένα απλό έγγραφο του Word ή χρησιμοποιήστε ένα υπάρχον.
4.  Ένα αρχείο πιστοποιητικού - Αυτό είναι απαραίτητο για ψηφιακές υπογραφές. Μπορείτε να χρησιμοποιήσετε α`.pfx` αρχείο.
5. Images for Signature Line - Προαιρετικά, ένα αρχείο εικόνας για την υπογραφή.

## Εισαγωγή χώρων ονομάτων

Αρχικά, πρέπει να εισαγάγουμε τους απαραίτητους χώρους ονομάτων. Αυτό το βήμα είναι ζωτικής σημασίας καθώς δημιουργεί το περιβάλλον για τη χρήση των λειτουργιών Aspose.Words.

```csharp
using System;
using System.IO;
using Aspose.Words;
using Aspose.Words.Drawing;
using Aspose.Words.Saving;
using Aspose.Words.Signing;
```

## Βήμα 1: Ρύθμιση του καταλόγου εγγράφων

Κάθε έργο χρειάζεται μια καλή αρχή. Ας ορίσουμε τη διαδρομή προς τον κατάλογο εγγράφων σας. Εδώ θα αποθηκευτούν και θα ανακτηθούν τα έγγραφά σας.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## Βήμα 2: Δημιουργία νέου εγγράφου

Τώρα, ας δημιουργήσουμε ένα νέο έγγραφο του Word χρησιμοποιώντας το Aspose.Words. Αυτός θα είναι ο καμβάς μας όπου προσθέτουμε τη γραμμή υπογραφής.

```csharp
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## Βήμα 3: Εισαγωγή της γραμμής υπογραφής

 Εδώ συμβαίνει η μαγεία. Εισάγουμε μια γραμμή υπογραφής στο έγγραφό μας χρησιμοποιώντας το`DocumentBuilder` τάξη.

```csharp
SignatureLine signatureLine = builder.InsertSignatureLine(new SignatureLineOptions()).SignatureLine;
```

## Βήμα 4: Αποθήκευση του εγγράφου με τη γραμμή υπογραφής

Μόλις τοποθετηθεί η γραμμή υπογραφής, πρέπει να αποθηκεύσουμε το έγγραφο. Αυτό είναι ένα ενδιάμεσο βήμα πριν προχωρήσουμε στην υπογραφή του.

```csharp
doc.Save(dataDir + "SignDocuments.SignatureLine.docx");
```

## Βήμα 5: Ρύθμιση επιλογών υπογραφής

Τώρα, ας ρυθμίσουμε τις επιλογές για την υπογραφή του εγγράφου. Αυτό περιλαμβάνει τον καθορισμό του αναγνωριστικού γραμμής υπογραφής και της εικόνας που θα χρησιμοποιηθεί.

```csharp
SignOptions signOptions = new SignOptions
{
    SignatureLineId = signatureLine.Id,
    SignatureLineImage = File.ReadAllBytes(dataDir + "Enhanced Windows MetaFile.emf")
};
```

## Βήμα 6: Φόρτωση του πιστοποιητικού

Οι ψηφιακές υπογραφές απαιτούν πιστοποιητικό. Εδώ, φορτώνουμε το αρχείο πιστοποιητικού που θα χρησιμοποιηθεί για την υπογραφή του εγγράφου.

```csharp
CertificateHolder certHolder = CertificateHolder.Create(dataDir + "morzal.pfx", "aw");
```

## Βήμα 7: Υπογραφή του Εγγράφου

 Αυτό είναι το τελικό βήμα. Χρησιμοποιούμε το`DigitalSignatureUtil`τάξη για να υπογράψει το έγγραφο. Το υπογεγραμμένο έγγραφο αποθηκεύεται με νέο όνομα.

```csharp
DigitalSignatureUtil.Sign(dataDir + "SignDocuments.SignatureLine.docx",
    dataDir + "SignDocuments.NewSignatureLine.docx", certHolder, signOptions);
```

## Σύναψη

Και ορίστε το! Με αυτά τα βήματα, δημιουργήσατε με επιτυχία ένα νέο έγγραφο του Word, προσθέσατε μια γραμμή υπογραφής και το υπογράψατε ψηφιακά χρησιμοποιώντας το Aspose.Words για .NET. Είναι ένα ισχυρό εργαλείο που κάνει την αυτοματοποίηση εγγράφων παιχνιδάκι. Είτε έχετε να κάνετε με συμβόλαια, συμφωνίες ή οποιαδήποτε επίσημα έγγραφα, αυτή η μέθοδος διασφαλίζει ότι έχουν υπογραφεί και πιστοποιηθεί με ασφάλεια.

## Συχνές ερωτήσεις

### Μπορώ να χρησιμοποιήσω άλλες μορφές εικόνας για τη γραμμή υπογραφής;
Ναι, μπορείτε να χρησιμοποιήσετε διάφορες μορφές εικόνας όπως PNG, JPG, BMP κ.λπ.

###  Είναι απαραίτητη η χρήση α`.pfx` file for the certificate?
 Ναι, α`.pfx` Το αρχείο είναι μια κοινή μορφή για την αποθήκευση κρυπτογραφικών πληροφοριών, συμπεριλαμβανομένων των πιστοποιητικών και των ιδιωτικών κλειδιών.

### Μπορώ να προσθέσω πολλές γραμμές υπογραφής σε ένα μόνο έγγραφο;
Απολύτως! Μπορείτε να εισαγάγετε πολλές γραμμές υπογραφής επαναλαμβάνοντας το βήμα εισαγωγής για κάθε υπογραφή.

### Τι γίνεται αν δεν έχω ψηφιακό πιστοποιητικό;
Θα χρειαστεί να αποκτήσετε ένα ψηφιακό πιστοποιητικό από μια αξιόπιστη αρχή έκδοσης πιστοποιητικών ή να δημιουργήσετε ένα χρησιμοποιώντας εργαλεία όπως το OpenSSL.

### Πώς μπορώ να επαληθεύσω την ψηφιακή υπογραφή στο έγγραφο;
Μπορείτε να ανοίξετε το υπογεγραμμένο έγγραφο στο Word και να μεταβείτε στα στοιχεία της υπογραφής για να επαληθεύσετε τη γνησιότητα και την ακεραιότητα της υπογραφής.