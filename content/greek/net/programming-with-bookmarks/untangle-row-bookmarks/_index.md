---
title: Ξεμπερδέψτε τους σελιδοδείκτες σειράς στο έγγραφο του Word
linktitle: Ξεμπερδέψτε τους σελιδοδείκτες σειράς στο έγγραφο του Word
second_title: Aspose.Words Document Processing API
description: Ξεμπερδέψτε τους μπερδεμένους σελιδοδείκτες σειρών στα έγγραφά σας του Word με ευκολία χρησιμοποιώντας το Aspose.Words για .NET. Αυτός ο οδηγός σας καθοδηγεί στη διαδικασία για καθαρότερη και ασφαλέστερη διαχείριση σελιδοδεικτών.
type: docs
weight: 10
url: /el/net/programming-with-bookmarks/untangle-row-bookmarks/
---
## Εισαγωγή

Έχετε συναντήσει ποτέ μια κατάσταση όπου η διαγραφή μιας σειράς σε ένα έγγραφο του Word από έναν σελιδοδείκτη ανακατεύει άλλους σελιδοδείκτες σε παρακείμενες σειρές; Αυτό μπορεί να είναι απίστευτα απογοητευτικό, ειδικά όταν έχουμε να κάνουμε με πολύπλοκα τραπέζια. Ευτυχώς, το Aspose.Words για .NET προσφέρει μια ισχυρή λύση: ξεμπλέξιμο σελιδοδεικτών σειρών. 

Αυτός ο οδηγός θα σας καθοδηγήσει στη διαδικασία ξεμπερδέματος σελιδοδεικτών σειρών στα έγγραφα του Word χρησιμοποιώντας το Aspose.Words για .NET. Θα αναλύσουμε τον κώδικα σε εύκολα κατανοητά βήματα και θα εξηγήσουμε τον σκοπό κάθε λειτουργίας, δίνοντάς σας τη δυνατότητα να αντιμετωπίσετε αυτά τα ενοχλητικά προβλήματα σελιδοδεικτών με σιγουριά.

## Προαπαιτούμενα

Πριν βουτήξετε, θα χρειαστείτε μερικά πράγματα:

1.  Aspose.Words για .NET: Αυτή η εμπορική βιβλιοθήκη παρέχει λειτουργίες για εργασία με έγγραφα του Word μέσω προγραμματισμού. 2. Μπορείτε να κάνετε λήψη μιας δωρεάν δοκιμής από[σύνδεσμος λήψης](https://releases.aspose.com/words/net/) ή αγοράστε άδεια από[αγορά](https://purchase.aspose.com/buy).
3. Περιβάλλον ανάπτυξης AC#: Το Visual Studio ή οποιοδήποτε άλλο C# IDE θα λειτουργήσει τέλεια.
4. Έγγραφο Word με σελιδοδείκτες σειρών: Θα χρησιμοποιήσουμε ένα δείγμα εγγράφου με το όνομα "Table column bookmarks.docx" για σκοπούς επίδειξης.

## Εισαγωγή χώρων ονομάτων

Το πρώτο βήμα περιλαμβάνει την εισαγωγή των απαραίτητων χώρων ονομάτων στο έργο σας C#. Αυτοί οι χώροι ονομάτων παρέχουν πρόσβαση στις κλάσεις και τις λειτουργίες που θα χρησιμοποιήσουμε από το Aspose.Words για .NET:

```csharp
using Aspose.Words;
using System;
```

## Βήμα 1: Φορτώστε το έγγραφο του Word

 Ξεκινάμε φορτώνοντας το έγγραφο του Word που περιέχει τους σελιδοδείκτες μπερδεμένων σειρών. Ο`Document` Η κλάση χειρίζεται τη διαχείριση εγγράφων στο Aspose.Words. Δείτε πώς μπορείτε να φορτώσετε το έγγραφο:

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY"; // Αντικαταστήστε με τη θέση του εγγράφου σας
Document doc = new Document(dataDir + "Table column bookmarks.docx");
```

 Θυμηθείτε να αντικαταστήσετε`"YOUR DOCUMENT DIRECTORY"` με την πραγματική διαδρομή προς το αρχείο "Σελιδοδείκτες στήλης πίνακα.docx".

## Βήμα 2: Ξεμπερδέψτε τους σελιδοδείκτες σειράς

 Εδώ συμβαίνει η μαγεία! Ο`Untangle` Η λειτουργία φροντίζει να ξεμπλέξει τους σελιδοδείκτες της σειράς. Ας αναλύσουμε τη λειτουργικότητά του:

```csharp
private void Untangle(Document doc)
{
   foreach (Bookmark bookmark in doc.Range.Bookmarks)
   {
	   // Λάβετε τη γονική σειρά τόσο του σελιδοδείκτη όσο και του τέλους του σελιδοδείκτη
	   Row row1 = (Row)bookmark.BookmarkStart.GetAncestor(typeof(Row));
	   Row row2 = (Row)bookmark.BookmarkEnd.GetAncestor(typeof(Row));

	   // Ελέγξτε εάν οι σειρές είναι έγκυρες και γειτονικές
	   if (row1 != null && row2 != null && row1.NextSibling == row2)
		   //Μετακινήστε το τέλος του σελιδοδείκτη στην τελευταία παράγραφο του τελευταίου κελιού της επάνω σειράς
		   row1.LastCell.LastParagraph.AppendChild(bookmark.BookmarkEnd);
   }
}
```

Ακολουθεί μια βήμα προς βήμα εξήγηση του τι κάνει ο κώδικας:

 Επαναλαμβάνουμε όλους τους σελιδοδείκτες του εγγράφου χρησιμοποιώντας α`foreach` βρόχος.
Για κάθε σελιδοδείκτη, ανακτούμε τη γονική σειρά και της αρχής του σελιδοδείκτη (`bookmark.BookmarkStart`) και το τέλος του σελιδοδείκτη (`bookmark.BookmarkEnd` ) χρησιμοποιώντας το`GetAncestor` μέθοδος.
Στη συνέχεια ελέγχουμε αν βρέθηκαν και οι δύο σειρές (`row1 != null`και`row2 != null`) και αν είναι διπλανές σειρές (`row1.NextSibling == row2`). Αυτό διασφαλίζει ότι τροποποιούμε μόνο σελιδοδείκτες που εκτείνονται σε παρακείμενες σειρές.
Εάν πληρούνται οι προϋποθέσεις, μετακινούμε τον τερματικό κόμβο σελιδοδεικτών στο τέλος της τελευταίας παραγράφου στο τελευταίο κελί της επάνω σειράς (`row1.LastCell.LastParagraph.AppendChild(bookmark.BookmarkEnd)`) να τα ξεμπερδέψει αποτελεσματικά.

## Βήμα 3: Διαγραφή σειράς ανά σελιδοδείκτη

 Τώρα που οι σελιδοδείκτες έχουν ξεμπερδευτεί, μπορούμε να διαγράψουμε με ασφάλεια σειρές χρησιμοποιώντας τα ονόματα των σελιδοδεικτών τους. Ο`DeleteRowByBookmark` η συνάρτηση χειρίζεται αυτήν την εργασία:

```csharp
private void DeleteRowByBookmark(Document doc, string bookmarkName)
{
   Bookmark bookmark = doc.Range.Bookmarks[bookmarkName];

   Row row = (Row)bookmark?.BookmarkStart.GetAncestor(typeof(Row));
   row?.Remove();
}
```

Ακολουθεί μια ανάλυση αυτής της συνάρτησης:

Παίρνουμε το όνομα του σελιδοδείκτη (`bookmarkName`) ως είσοδος.
 Ανακτούμε το αντίστοιχο αντικείμενο σελιδοδείκτη χρησιμοποιώντας`doc.Range.Bookmarks[bookmarkName]`.
Στη συνέχεια, η μητρική σειρά του σελιδοδείκτη αρχίζει να χρησιμοποιεί`GetAncestor` (παρόμοιο με το`Untangle` λειτουργία).
Τέλος, ελέγχουμε αν υπάρχουν ο σελιδοδείκτης και η σειρά (`bookmark != null` και

## Βήμα 4: Επαληθεύστε το ξεμπέρδεμα

 Ενώ το`Untangle` Η λειτουργία πρέπει να διασφαλίζει την ασφάλεια άλλων σελιδοδεικτών, είναι πάντα καλή πρακτική να επαληθεύετε. Δείτε πώς μπορούμε να ελέγξουμε εάν η διαδικασία ξεμπερδέματος δεν διέγραψε κατά λάθος το τέλος ενός άλλου σελιδοδείκτη:

```csharp
if (doc.Range.Bookmarks["ROW1"].BookmarkEnd == null)
   throw new Exception("Wrong, the end of the bookmark was deleted.");
```

Αυτό το απόσπασμα κώδικα ελέγχει εάν το τέλος του σελιδοδείκτη με το όνομα "ROW1" εξακολουθεί να υπάρχει μετά τη διαγραφή της σειράς με τον σελιδοδείκτη "ROW2". Εάν είναι μηδενικό, δημιουργείται μια εξαίρεση, υποδεικνύοντας ένα πρόβλημα με τη διαδικασία ξεμπερδέματος. 

## Βήμα 5: Αποθηκεύστε το έγγραφο

 Τέλος, αφού ξεμπερδέψετε τους σελιδοδείκτες και πιθανώς διαγράψετε σειρές, αποθηκεύστε το τροποποιημένο έγγραφο χρησιμοποιώντας το`Save` μέθοδος:

```csharp
doc.Save(dataDir + "WorkingWithBookmarks.UntangleRowBookmarks.docx");
```

Αυτό αποθηκεύει το έγγραφο με τους ξεμπερδεμένους σελιδοδείκτες και τυχόν διαγραμμένες σειρές κάτω από ένα νέο όνομα αρχείου "WorkingWithBookmarks.UntangleRowBookmarks.docx". 

## Σύναψη

 Ακολουθώντας αυτά τα βήματα και χρησιμοποιώντας το`Untangle`Μπορείτε να ξεμπερδέψετε αποτελεσματικά τους σελιδοδείκτες σειρών στα έγγραφα του Word με το Aspose.Words για .NET. Αυτό διασφαλίζει ότι η διαγραφή σειρών ανά σελιδοδείκτες δεν προκαλεί ανεπιθύμητες συνέπειες με άλλους σελιδοδείκτες σε παρακείμενες σειρές. Θυμηθείτε να αντικαταστήσετε τα σύμβολα κράτησης θέσης όπως`"YOUR DOCUMENT DIRECTORY"` με τις πραγματικές διαδρομές και τα ονόματα αρχείων σας.

## Συχνές ερωτήσεις

### Είναι δωρεάν το Aspose.Words για .NET;

 Το Aspose.Words for .NET είναι μια εμπορική βιβλιοθήκη με διαθέσιμη δωρεάν δοκιμή. Μπορείτε να το κατεβάσετε από[σύνδεσμος λήψης](https://releases.aspose.com/words/net/).

### Μπορώ να ξεμπερδέψω με μη αυτόματο τρόπο τους σελιδοδείκτες σειρών στο Word;

Αν και είναι τεχνικά δυνατό, το χειροκίνητο ξεμπέρδεμα σελιδοδεικτών στο Word μπορεί να είναι κουραστικό και επιρρεπές σε σφάλματα. Το Aspose.Words for .NET αυτοματοποιεί αυτή τη διαδικασία, εξοικονομώντας χρόνο και προσπάθεια.

###  Τι συμβαίνει εάν το`Untangle` function encounters an error?

Ο κώδικας περιλαμβάνει ένα πρόγραμμα χειρισμού εξαιρέσεων που δημιουργεί μια εξαίρεση εάν η διαδικασία ξεμπερδέματος διαγράψει κατά λάθος το τέλος ενός άλλου σελιδοδείκτη. Μπορείτε να προσαρμόσετε αυτόν τον χειρισμό σφαλμάτων για να ταιριάζει στις συγκεκριμένες ανάγκες σας.

### Μπορώ να χρησιμοποιήσω αυτόν τον κώδικα για να ξεμπερδέψω τους σελιδοδείκτες σε μη γειτονικές σειρές;

Επί του παρόντος, ο κώδικας εστιάζει στο ξεμπλέξιμο σελιδοδεικτών που εκτείνονται σε παρακείμενες σειρές. Η τροποποίηση του κώδικα για τον χειρισμό μη γειτονικών σειρών θα απαιτούσε πρόσθετη λογική για τον εντοπισμό και τον χειρισμό αυτών των σεναρίων.

### Υπάρχουν περιορισμοί στη χρήση αυτής της προσέγγισης;

Αυτή η προσέγγιση προϋποθέτει ότι οι σελιδοδείκτες είναι καλά καθορισμένοι μέσα στα κελιά του πίνακα. Εάν οι σελιδοδείκτες τοποθετηθούν εκτός κελιών ή σε μη αναμενόμενες τοποθεσίες, η διαδικασία ξεμπερδέματος ενδέχεται να μην λειτουργήσει όπως προβλέπεται.