---
title: Εισαγάγετε το πεδίο συγχώνευσης χρησιμοποιώντας το DOM
linktitle: Εισαγάγετε το πεδίο συγχώνευσης χρησιμοποιώντας το DOM
second_title: Aspose.Words Document Processing API
description: Μάθετε πώς να εισάγετε προσαρμοσμένα πεδία συγχώνευσης πεδίων στα έγγραφά σας του Word με το Aspose.Words για .NET.
type: docs
weight: 10
url: /el/net/working-with-fields/insert-merge-field-using-dom/
---

Ακολουθεί ένας οδηγός βήμα προς βήμα για να εξηγήσετε τον πηγαίο κώδικα C# παρακάτω, ο οποίος χρησιμοποιεί τη δυνατότητα "Εισαγωγή πεδίου συγχώνευσης πεδίου" του Aspose.Words για .NET. Φροντίστε να ακολουθήσετε προσεκτικά κάθε βήμα για να έχετε τα επιθυμητά αποτελέσματα.

## Βήμα 1: Ρύθμιση καταλόγου εγγράφων

Στον κωδικό που παρέχεται, πρέπει να καθορίσετε τον κατάλογο των εγγράφων σας. Αντικαταστήστε την τιμή "YOUR DOCUMENT DIRECTORY" με την κατάλληλη διαδρομή προς τον κατάλογο των εγγράφων σας.

```csharp
string dataDir = "YOUR DOCUMENTS DIRECTORY";
```

## Βήμα 2: Δημιουργία του Document και του DocumentBuilder

Ξεκινάμε δημιουργώντας ένα νέο έγγραφο και αρχικοποιώντας ένα DocumentBuilder.

```csharp
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## Βήμα 3: Μετακίνηση δρομέα στην παράγραφο

 Χρησιμοποιούμε το`MoveTo()` μέθοδο του DocumentBuilder για να μετακινήσουμε τον κέρσορα στην παράγραφο όπου θέλουμε να εισαγάγουμε το πεδίο συγχώνευσης πεδίων.

```csharp
Paragraph para = (Paragraph)doc.GetChildNodes(NodeType.Paragraph, true)[0];
builder. MoveTo(para);
```

## Βήμα 4: Εισαγωγή του πεδίου συγχώνευσης πεδίων

 Χρησιμοποιούμε το DocumentBuilder's`InsertField()` μέθοδο για την εισαγωγή ενός πεδίου συγχώνευσης πεδίου στην παράγραφο.

```csharp
FieldMergeField field = (FieldMergeField)builder.InsertField(FieldType.FieldMergeField, false);
```

Στη συνέχεια διαμορφώνουμε τις ιδιότητες του πεδίου συγχώνευσης πεδίων καθορίζοντας τις κατάλληλες επιλογές, όπως το όνομα του πεδίου, το κείμενο πριν και μετά το πεδίο και τις επιλογές κάθετης μορφοποίησης.

```csharp
field.FieldName = "Test1";
field.TextBefore = "Test2";
field. TextAfter = "Test3";
field. IsMapped = true;
field. IsVerticalFormatting = true;
```

 Τέλος, ονομάζουμε το`Update()` μέθοδο ενημέρωσης του πεδίου.

```csharp
field. Update();
```

### Δείγμα πηγαίου κώδικα για την εισαγωγή ενός πεδίου συγχώνευσης πεδίων με το Aspose.Words για .NET

```csharp
// Η διαδρομή προς τον κατάλογο εγγράφων.
string dataDir = "YOUR DOCUMENTS DIRECTORY";

// Δημιουργήστε το έγγραφο και το DocumentBuilder.
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

// Μετακίνηση δρομέα στην παράγραφο.
Paragraph para = (Paragraph)doc.GetChildNodes(NodeType.Paragraph, true)[0];
builder. MoveTo(para);

// Εισαγωγή πεδίου συγχώνευσης.
FieldMergeField field = (FieldMergeField)builder.InsertField(FieldType.FieldMergeField, false);

field.FieldName = "Test1";
field.TextBefore = "Test2";
field. TextAfter = "Test3";
field. IsMapped = true;
field. IsVerticalFormatting = true;

// Ενημερώστε το πεδίο.
field. Update();

doc.Save(dataDir + "InsertionChampMergeChamp.docx");
```

Σε αυτό το παράδειγμα, δημιουργήσαμε ένα νέο έγγραφο, μετακινήσαμε τον κέρσορα στην επιθυμητή παράγραφο και, στη συνέχεια, εισαγάγαμε ένα πεδίο συγχώνευσης πεδίων στο έγγραφο.

### Συχνές ερωτήσεις

#### Ε: Πώς μπορώ να εισαγάγω ένα πεδίο συγχώνευσης σε ένα έγγραφο του Word χρησιμοποιώντας το Aspose.Words για .NET με το DOM;

Α: Για να εισαγάγετε ένα πεδίο συγχώνευσης σε ένα έγγραφο του Word χρησιμοποιώντας το Aspose.Words για .NET με DOM, μπορείτε να ακολουθήσετε τα εξής βήματα:

1. Μεταβείτε στην παράγραφο όπου θέλετε να εισαγάγετε το πεδίο συγχώνευσης.
2.  Δημιουργώ ένα`FieldMergeField` αντικείμενο.
3. Ορίστε τις ιδιότητες του πεδίου συγχώνευσης, όπως το όνομα πεδίου και τις επιλογές μορφοποίησης.
4.  Προσθέστε το πεδίο συγχώνευσης στην παράγραφο χρησιμοποιώντας το`Paragraph.AppendChild` μέθοδος.

#### Ε: Πώς μπορώ να καθορίσω δεδομένα προέλευσης για το πεδίο συγχώνευσης στο Aspose.Words για .NET;

Α: Για να καθορίσετε τα δεδομένα προέλευσης για το πεδίο συγχώνευσης στο Aspose.Words για .NET, μπορείτε να χρησιμοποιήσετε το`FieldMergeField.FieldName` μέθοδος για να ορίσετε το όνομα του πεδίου συγχώνευσης, το οποίο είναι το όνομα ενός πεδίου σε μια εξωτερική πηγή δεδομένων, όπως ένα αρχείο CSV, μια βάση δεδομένων κ.λπ. Μπορείτε επίσης να χρησιμοποιήσετε το`FieldMergeField.Text` μέθοδο για να ορίσετε απευθείας την τιμή του πεδίου συγχώνευσης.

#### Ε: Μπορώ να προσαρμόσω την εμφάνιση του πεδίου συγχώνευσης σε ένα έγγραφο του Word με το Aspose.Words για .NET;

 Α: Ναι, μπορείτε να προσαρμόσετε την εμφάνιση του πεδίου συγχώνευσης σε ένα έγγραφο του Word με το Aspose.Words για .NET. Μπορείτε να ορίσετε τις επιλογές μορφοποίησης, όπως πεζά, γραμματοσειρά, χρώμα κ.λπ. χρησιμοποιώντας τις ιδιότητες του`FieldMergeField` αντικείμενο.

#### Ε: Πώς μπορώ να ελέγξω εάν ένα πεδίο συγχώνευσης εισήχθη με επιτυχία σε ένα έγγραφο του Word με το Aspose.Words για .NET;

 Α: Για να ελέγξετε εάν ένα πεδίο συγχώνευσης εισήχθη με επιτυχία, μπορείτε να περιηγηθείτε στο περιεχόμενο του εγγράφου και να αναζητήσετε παρουσίες πεδίων συγχώνευσης. Μπορείτε να χρησιμοποιήσετε τις μεθόδους και τις ιδιότητες του`Document` αντικείμενο πρόσβασης σε παραγράφους, πεδία και άλλα στοιχεία του εγγράφου.

#### Ε: Η εισαγωγή ενός πεδίου συγχώνευσης με χρήση DOM επηρεάζει τη δομή του εγγράφου του Word με το Aspose.Words για .NET;

Α: Η εισαγωγή ενός πεδίου συγχώνευσης χρησιμοποιώντας το DOM δεν επηρεάζει άμεσα τη δομή του εγγράφου του Word. Ωστόσο, προσθέτει ένα νέο στοιχείο πεδίου στο περιεχόμενο του εγγράφου. Μπορείτε να χειριστείτε τη δομή του εγγράφου προσθέτοντας, διαγράφοντας ή τροποποιώντας τα υπάρχοντα στοιχεία σύμφωνα με τις ανάγκες σας.