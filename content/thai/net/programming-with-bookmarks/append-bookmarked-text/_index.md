---
title: ผนวกข้อความที่คั่นหน้าไว้ในเอกสาร Word
linktitle: ผนวกข้อความที่คั่นหน้าไว้ในเอกสาร Word
second_title: Aspose.Words API การประมวลผลเอกสาร
description: เรียนรู้วิธีต่อท้ายข้อความที่บุ๊กมาร์กในเอกสาร Word โดยใช้ Aspose.Words สำหรับ .NET พร้อมคำแนะนำทีละขั้นตอนนี้ เหมาะสำหรับนักพัฒนา
type: docs
weight: 10
url: /th/net/programming-with-bookmarks/append-bookmarked-text/
---
## การแนะนำ

สวัสดี! เคยพยายามต่อท้ายข้อความจากส่วนที่บุ๊กมาร์กไว้ในเอกสาร Word แล้วพบว่ายุ่งยากหรือไม่? คุณโชคดี! บทช่วยสอนนี้จะแนะนำคุณตลอดกระบวนการโดยใช้ Aspose.Words สำหรับ .NET เราจะแบ่งออกเป็นขั้นตอนง่ายๆ เพื่อให้คุณสามารถปฏิบัติตามได้อย่างง่ายดาย มาดำดิ่งและรับข้อความที่คั่นหน้าไว้ต่อท้ายอย่างมืออาชีพ!

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเริ่ม ตรวจสอบให้แน่ใจว่าคุณมีทุกสิ่งที่คุณต้องการ:

-  Aspose.Words สำหรับ .NET: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้งไว้แล้ว ถ้าไม่คุณสามารถ[ดาวน์โหลดได้ที่นี่](https://releases.aspose.com/words/net/).
- สภาพแวดล้อมการพัฒนา: สภาพแวดล้อมการพัฒนา .NET เช่น Visual Studio
- ความรู้พื้นฐานของ C#: การทำความเข้าใจแนวคิดการเขียนโปรแกรม C# ขั้นพื้นฐานจะช่วยได้
- เอกสาร Word พร้อมบุ๊กมาร์ก: เอกสาร Word ที่มีการตั้งค่าบุ๊กมาร์ก ซึ่งเราจะใช้ในการต่อท้ายข้อความ

## นำเข้าเนมสเปซ

ก่อนอื่น มานำเข้าเนมสเปซที่จำเป็นกันก่อน สิ่งนี้จะช่วยให้มั่นใจได้ว่าเรามีเครื่องมือทั้งหมดที่เราต้องการเพียงปลายนิ้วสัมผัส

```csharp
using System;
using Aspose.Words;
using Aspose.Words.Importing;
```

เรามาแบ่งตัวอย่างออกเป็นขั้นตอนโดยละเอียด

## ขั้นตอนที่ 1: โหลดเอกสารและเริ่มต้นตัวแปร

เอาล่ะ มาเริ่มต้นด้วยการโหลดเอกสาร Word ของเราและเริ่มต้นตัวแปรที่เราต้องการ

```csharp
// โหลดเอกสารต้นทางและปลายทาง
Document srcDoc = new Document("source.docx");
Document dstDoc = new Document("destination.docx");

// เริ่มต้นผู้นำเข้าเอกสาร
NodeImporter importer = new NodeImporter(srcDoc, dstDoc, ImportFormatMode.KeepSourceFormatting);

// ค้นหาบุ๊กมาร์กในเอกสารต้นฉบับ
Bookmark srcBookmark = srcDoc.Range.Bookmarks["YourBookmarkName"];
```

## ขั้นตอนที่ 2: ระบุย่อหน้าเริ่มต้นและสิ้นสุด

ตอนนี้ มาดูตำแหน่งที่บุ๊กมาร์กเริ่มต้นและสิ้นสุดกัน นี่เป็นสิ่งสำคัญเนื่องจากเราจำเป็นต้องจัดการกับข้อความภายในขอบเขตเหล่านี้

```csharp
// นี่คือย่อหน้าที่มีจุดเริ่มต้นของบุ๊กมาร์ก
Paragraph startPara = (Paragraph)srcBookmark.BookmarkStart.ParentNode;

// นี่คือย่อหน้าที่มีส่วนท้ายของบุ๊กมาร์ก
Paragraph endPara = (Paragraph)srcBookmark.BookmarkEnd.ParentNode;

if (startPara == null || endPara == null)
    throw new InvalidOperationException("Parent of the bookmark start or end is not a paragraph, cannot handle this scenario yet.");
```

## ขั้นตอนที่ 3: ตรวจสอบผู้ปกครองของย่อหน้า

เราจำเป็นต้องตรวจสอบให้แน่ใจว่าย่อหน้าเริ่มต้นและสิ้นสุดมีพาเรนต์เดียวกัน นี่เป็นสถานการณ์ง่ายๆ ที่ทำให้ทุกอย่างตรงไปตรงมา

```csharp
// จำกัดตัวเราเองให้อยู่ในสถานการณ์ที่เรียบง่ายพอสมควร
if (startPara.ParentNode != endPara.ParentNode)
    throw new InvalidOperationException("Start and end paragraphs have different parents, cannot handle this scenario yet.");
```

## ขั้นตอนที่ 4: ระบุโหนดที่จะหยุด

ต่อไป เราต้องกำหนดโหนดที่เราจะหยุดคัดลอกข้อความ นี่จะเป็นโหนดทันทีหลังจากย่อหน้าสุดท้าย

```csharp
// เราต้องการคัดลอกย่อหน้าทั้งหมดตั้งแต่ย่อหน้าเริ่มต้นจนถึง (และรวมถึง) ย่อหน้าสุดท้าย
// ดังนั้นโหนดที่เราหยุดจะอยู่หลังย่อหน้าสุดท้าย
Node endNode = endPara.NextSibling;
```

## ขั้นตอนที่ 5: ผนวกข้อความที่คั่นหน้าเข้ากับเอกสารปลายทาง

สุดท้าย เรามาวนซ้ำโหนดต่างๆ จากย่อหน้าเริ่มต้นไปยังโหนดหลังย่อหน้าสุดท้าย และผนวกเข้ากับเอกสารปลายทาง

```csharp
for (Node curNode = startPara; curNode != endNode; curNode = curNode.NextSibling)
{
    // สิ่งนี้จะสร้างสำเนาของโหนดปัจจุบันและนำเข้า (ทำให้ถูกต้อง) ในบริบท
    // ของเอกสารปลายทาง การนำเข้าหมายถึงการปรับสไตล์และตัวระบุรายการอย่างถูกต้อง
    Node newNode = importer.ImportNode(curNode, true);

    // ผนวกโหนดที่นำเข้าเข้ากับเอกสารปลายทาง
    dstDoc.FirstSection.Body.AppendChild(newNode);
}

// บันทึกเอกสารปลายทางพร้อมข้อความต่อท้าย
dstDoc.Save("appended_document.docx");
```

## บทสรุป

และคุณก็ได้แล้ว! คุณต่อท้ายข้อความจากส่วนที่บุ๊กมาร์กในเอกสาร Word ได้สำเร็จโดยใช้ Aspose.Words for .NET เครื่องมืออันทรงพลังนี้ทำให้การจัดการเอกสารเป็นเรื่องง่าย และตอนนี้คุณก็มีเคล็ดลับอีกอย่างหนึ่งแล้ว ขอให้มีความสุขในการเขียนโค้ด!

## คำถามที่พบบ่อย

### ฉันสามารถต่อท้ายข้อความจากบุ๊กมาร์กหลายรายการในคราวเดียวได้หรือไม่
ได้ คุณสามารถทำซ้ำขั้นตอนนี้กับบุ๊กมาร์กแต่ละอันและเพิ่มข้อความต่อท้ายได้

### จะเกิดอะไรขึ้นถ้าย่อหน้าเริ่มต้นและสิ้นสุดมีผู้ปกครองต่างกัน
ตัวอย่างปัจจุบันถือว่าพวกเขามีพาเรนต์เดียวกัน สำหรับผู้ปกครองที่แตกต่างกัน จำเป็นต้องมีการจัดการที่ซับซ้อนมากขึ้น

### ฉันสามารถคงรูปแบบดั้งเดิมของข้อความต่อท้ายได้หรือไม่
 อย่างแน่นอน! ที่`ImportFormatMode.KeepSourceFormatting` ช่วยให้มั่นใจได้ว่าการจัดรูปแบบดั้งเดิมจะยังคงอยู่

### เป็นไปได้ไหมที่จะต่อท้ายข้อความในตำแหน่งเฉพาะในเอกสารปลายทาง
ใช่ คุณสามารถต่อท้ายข้อความในตำแหน่งใดก็ได้โดยการนำทางไปยังโหนดที่ต้องการในเอกสารปลายทาง

### จะทำอย่างไรหากฉันต้องการเพิ่มข้อความจากบุ๊กมาร์กไปยังส่วนใหม่
คุณสามารถสร้างส่วนใหม่ในเอกสารปลายทางและต่อท้ายข้อความที่นั่น