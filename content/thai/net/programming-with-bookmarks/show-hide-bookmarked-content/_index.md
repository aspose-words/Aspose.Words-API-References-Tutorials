---
title: แสดงซ่อนเนื้อหาที่คั่นหน้าในเอกสาร Word
linktitle: แสดงซ่อนเนื้อหาที่คั่นหน้าในเอกสาร Word
second_title: Aspose.Words API การประมวลผลเอกสาร
description: เรียนรู้วิธีแสดงหรือซ่อนเนื้อหาที่บุ๊กมาร์กในเอกสาร Word แบบไดนามิกโดยใช้ Aspose.Words สำหรับ .NET พร้อมคำแนะนำทีละขั้นตอนที่ครอบคลุมนี้
type: docs
weight: 10
url: /th/net/programming-with-bookmarks/show-hide-bookmarked-content/
---

## การแนะนำ

สวัสดี! คุณเคยต้องการควบคุมการเปิดเผยเนื้อหาเฉพาะภายในเอกสาร Word ตามเงื่อนไขบางประการหรือไม่? ด้วย Aspose.Words สำหรับ .NET คุณสามารถแสดงหรือซ่อนเนื้อหาที่คั่นหน้าแบบไดนามิกด้วยโค้ดเพียงไม่กี่บรรทัด ในบทช่วยสอนนี้ ฉันจะแนะนำคุณตลอดกระบวนการทีละขั้นตอน เพื่อให้แน่ใจว่าคุณจะเข้าใจโค้ดแต่ละส่วน ในตอนท้าย คุณจะเป็นมืออาชีพในการจัดการบุ๊กมาร์กในเอกสาร Word มาเริ่มกันเลย!

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเจาะลึกบทช่วยสอน เรามาตรวจสอบให้แน่ใจว่าคุณมีทุกสิ่งที่คุณต้องการ:

1. ความรู้พื้นฐานของ C#: คุณควรจะคุ้นเคยกับไวยากรณ์และแนวคิดของ C#
2.  Aspose.Words สำหรับ .NET: ดาวน์โหลด[ที่นี่](https://releases.aspose.com/words/net/) - หากคุณยังไม่พร้อมที่จะซื้อคุณสามารถเริ่มต้นด้วยก[ทดลองฟรี](https://releases.aspose.com/).
3. Visual Studio: เวอร์ชันล่าสุดจะใช้งานได้ แต่แนะนำให้ใช้เวอร์ชันล่าสุด
4. .NET Framework: ตรวจสอบให้แน่ใจว่าได้ติดตั้งไว้ในเครื่องของคุณแล้ว

พร้อมที่จะเริ่มต้นหรือยัง? ยอดเยี่ยม! เริ่มต้นด้วยการนำเข้าเนมสเปซที่จำเป็น

## นำเข้าเนมสเปซ

หากต้องการใช้ Aspose.Words สำหรับ .NET เราจำเป็นต้องนำเข้าเนมสเปซที่จำเป็น ขั้นตอนนี้ทำให้แน่ใจว่าเราสามารถเข้าถึงคลาสและวิธีการทั้งหมดที่เราจะใช้

```csharp
using System;
using Aspose.Words;
using Aspose.Words.Fields;
```

เนมสเปซเหล่านี้มีความสำคัญอย่างยิ่งต่อการทำงานกับเอกสาร Word และจัดการเนื้อหา

## ขั้นตอนที่ 1: การตั้งค่าเอกสาร

ขั้นแรก มาสร้างเอกสาร Word ใหม่และตัวสร้างเอกสารกัน เครื่องมือสร้างเอกสารช่วยให้เราเพิ่มและจัดการเนื้อหาภายในเอกสารได้อย่างง่ายดาย

```csharp
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

ในขั้นตอนนี้ เราจะเริ่มต้นเอกสารใหม่และตัวสร้างเอกสาร สิ่งนี้จะกำหนดสภาพแวดล้อมของเราสำหรับการดำเนินงานเพิ่มเติม

## ขั้นตอนที่ 2: การเพิ่มเนื้อหาที่คั่นหน้า

ต่อไป เราจะเพิ่มเนื้อหาบางส่วนลงในเอกสารและสร้างบุ๊กมาร์กรอบๆ เอกสาร บุ๊กมาร์กนี้จะช่วยให้เราระบุและจัดการเนื้อหาได้

```csharp
builder.Write("This is some text before the bookmark.");
builder.StartBookmark("MyBookmark");
builder.Write("This is the bookmarked content.");
builder.EndBookmark("MyBookmark");
builder.Write("This is some text after the bookmark.");
```

 ที่นี่ เราจะเพิ่มข้อความก่อนและหลังเนื้อหาที่บุ๊กมาร์กไว้ ที่`StartBookmark`และ`EndBookmark` วิธีการกำหนดขอบเขตของบุ๊กมาร์ก

## ขั้นตอนที่ 3: การแทรกฟิลด์แบบมีเงื่อนไข

เพื่อควบคุมการเปิดเผยเนื้อหาที่บุ๊กมาร์ก เราจะใช้ฟิลด์เงื่อนไข ช่องนี้จะตรวจสอบเงื่อนไขและแสดงหรือซ่อนเนื้อหาตามนั้น

```csharp
builder.MoveToDocumentEnd();
Field field = builder.InsertField("IF \"", null);
builder.MoveTo(field.Start.NextSibling);
builder.InsertField("MERGEFIELD MyBookmark", null);
builder.Write("\" = \"true\" \"Visible\" \"Hidden\"");
```

ในขั้นตอนนี้ เราจะแทรกฟิลด์ IF ที่จะตรวจสอบค่าของบุ๊กมาร์ก หากค่าเป็น "จริง" ก็จะแสดงเป็น "มองเห็นได้" มิฉะนั้นจะแสดงคำว่า "ซ่อน"

## ขั้นตอนที่ 4: การจัดเรียงโหนดใหม่

ต่อไป เราจำเป็นต้องจัดเรียงโหนดใหม่เพื่อให้แน่ใจว่าตรรกะแบบมีเงื่อนไขใช้กับเนื้อหาที่บุ๊กมาร์กไว้อย่างถูกต้อง

```csharp
Bookmark bm = doc.Range.Bookmarks["MyBookmark"];
Node currentNode = field.Start;
bool flag = true;

while (currentNode != null && flag)
{
    if (currentNode.NodeType == NodeType.Run && currentNode.ToString(SaveFormat.Text).Trim() == "\"")
        flag = false;

    Node nextNode = currentNode.NextSibling;
    bm.BookmarkStart.ParentNode.InsertBefore(currentNode, bm.BookmarkStart);
    currentNode = nextNode;
}

Node endNode = bm.BookmarkEnd;
flag = true;

while (currentNode != null && flag)
{
    if (currentNode.NodeType == NodeType.FieldEnd)
        flag = false;

    Node nextNode = currentNode.NextSibling;
    bm.BookmarkEnd.ParentNode.InsertAfter(currentNode, endNode);
    endNode = currentNode;
    currentNode = nextNode;
}
```

ที่นี่ เราย้ายโหนดไปรอบๆ เพื่อให้แน่ใจว่าเงื่อนไขครอบคลุมเนื้อหาที่บุ๊กมาร์กไว้อย่างเหมาะสม

## ขั้นตอนที่ 5: การดำเนินการจดหมายเวียน

สุดท้ายนี้ เราจะดำเนินการจดหมายเวียนเพื่อตั้งค่าของบุ๊กมาร์ก และพิจารณาว่าควรแสดงหรือซ่อนเนื้อหา

```csharp
doc.MailMerge.Execute(new[] { "MyBookmark" }, new object[] { "true" });
```

ขั้นตอนนี้ตั้งค่าบุ๊กมาร์กเป็น "จริง" ซึ่งจะทำให้เนื้อหามองเห็นได้ตามเงื่อนไขของเรา

## ขั้นตอนที่ 6: บันทึกเอกสาร

หลังจากดำเนินการทั้งหมดแล้ว ขั้นตอนสุดท้ายคือการบันทึกเอกสารที่แก้ไข

```csharp
doc.Save("ShowHideBookmarkedContent.docx");
```

ที่นี่ เราจะบันทึกเอกสารด้วยชื่อไฟล์ที่สื่อความหมายเพื่อระบุการเปลี่ยนแปลง

## บทสรุป

 แค่นั้นแหละ! คุณได้เรียนรู้วิธีแสดงหรือซ่อนเนื้อหาที่บุ๊กมาร์กในเอกสาร Word เรียบร้อยแล้วโดยใช้ Aspose.Words for .NET บทช่วยสอนนี้ครอบคลุมถึงการสร้างเอกสาร การเพิ่มบุ๊กมาร์ก การแทรกฟิลด์ตามเงื่อนไข การจัดเรียงโหนดใหม่ และการดำเนินการจดหมายเวียน Aspose.Words นำเสนอฟีเจอร์มากมาย ดังนั้นอย่าลังเลที่จะสำรวจ[เอกสารประกอบ API](https://reference.aspose.com/words/net/) เพื่อความสามารถขั้นสูงยิ่งขึ้น

## คำถามที่พบบ่อย

### 1. Aspose.Words สำหรับ .NET คืออะไร

Aspose.Words สำหรับ .NET เป็นไลบรารีที่มีประสิทธิภาพซึ่งช่วยให้นักพัฒนาสามารถสร้าง แก้ไข และแปลงเอกสาร Word โดยทางโปรแกรมได้ มีการใช้กันอย่างแพร่หลายสำหรับงานเอกสารอัตโนมัติ

### 2. ฉันสามารถใช้ Aspose.Words สำหรับ .NET ได้ฟรีหรือไม่

 คุณสามารถลองใช้ Aspose.Words สำหรับ .NET โดยใช้ไฟล์[ทดลองฟรี](https://releases.aspose.com/)- สำหรับการใช้งานระยะยาว คุณจะต้องซื้อใบอนุญาต

### 3. ฉันจะแก้ไขคุณสมบัติอื่นๆ ของบุ๊กมาร์กได้อย่างไร?

 Aspose.Words ช่วยให้คุณสามารถจัดการคุณสมบัติต่างๆ ของบุ๊กมาร์ก เช่น ข้อความและตำแหน่งของบุ๊กมาร์กได้ อ้างถึง[เอกสารประกอบ API](https://reference.aspose.com/words/net/) สำหรับคำแนะนำโดยละเอียด

### 4. ฉันจะรับการสนับสนุนสำหรับ Aspose.Words สำหรับ .NET ได้อย่างไร

คุณสามารถรับการสนับสนุนได้โดยไปที่[กำหนดฟอรั่มการสนับสนุน](https://forum.aspose.com/c/words/8).

### 5. ฉันสามารถจัดการเนื้อหาประเภทอื่นด้วย Aspose.Words สำหรับ .NET ได้หรือไม่

ใช่ Aspose.Words สำหรับ .NET รองรับการจัดการเนื้อหาหลายประเภท รวมถึงข้อความ รูปภาพ ตาราง และอื่นๆ