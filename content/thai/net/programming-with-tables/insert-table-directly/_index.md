---
title: แทรกตารางโดยตรง
linktitle: แทรกตารางโดยตรง
second_title: API การประมวลผลเอกสาร Aspose.Words
description: เรียนรู้วิธีการแทรกตารางโดยตรงลงในเอกสาร Word โดยใช้ Aspose.Words สำหรับ .NET ปฏิบัติตามคำแนะนำทีละขั้นตอนโดยละเอียดของเราเพื่อปรับปรุงการสร้างเอกสารของคุณให้มีประสิทธิภาพ
type: docs
weight: 10
url: /th/net/programming-with-tables/insert-table-directly/
---
## การแนะนำ
การสร้างตารางด้วยโปรแกรมอาจเป็นเรื่องท้าทาย โดยเฉพาะอย่างยิ่งเมื่อต้องจัดการกับโครงสร้างเอกสารที่ซับซ้อน แต่ไม่ต้องกังวล เราพร้อมอธิบายให้คุณทราบ! ในคู่มือนี้ เราจะแนะนำขั้นตอนต่างๆ ในการแทรกตารางโดยตรงในเอกสาร Word โดยใช้ Aspose.Words สำหรับ .NET ไม่ว่าคุณจะเป็นนักพัฒนาที่มีประสบการณ์หรือเพิ่งเริ่มต้น บทช่วยสอนนี้จะช่วยให้คุณเชี่ยวชาญกระบวนการนี้ได้อย่างง่ายดาย

## ข้อกำหนดเบื้องต้น

ก่อนจะเริ่มเขียนโค้ด เรามาตรวจสอบก่อนว่าคุณมีทุกอย่างที่จำเป็นในการเริ่มต้นแล้ว นี่คือรายการตรวจสอบโดยย่อ:

1.  ไลบรารี Aspose.Words สำหรับ .NET: ตรวจสอบให้แน่ใจว่าคุณได้ดาวน์โหลดและติดตั้งไลบรารี Aspose.Words สำหรับ .NET แล้ว คุณสามารถรับได้จาก[หน้าดาวน์โหลด](https://releases.aspose.com/words/net/).
2. สภาพแวดล้อมการพัฒนา: สภาพแวดล้อมการพัฒนาเช่น Visual Studio
3. ความรู้พื้นฐานเกี่ยวกับ C#: ทำความเข้าใจพื้นฐานการเขียนโปรแกรม C#
4. ไดเรกทอรีเอกสาร: เส้นทางไดเรกทอรีที่คุณจะบันทึกเอกสารของคุณ

เมื่อมีข้อกำหนดเบื้องต้นเหล่านี้แล้ว คุณก็พร้อมที่จะเริ่มเขียนโค้ดได้แล้ว!

## นำเข้าเนมสเปซ

ก่อนอื่นเรามาทำการนำเข้าเนมสเปซที่จำเป็นกันก่อน เนมสเปซเหล่านี้จะให้คลาสและเมธอดที่จำเป็นสำหรับการทำงานกับเอกสาร Word

```csharp
using System;
using System.Drawing;
using Aspose.Words;
using Aspose.Words.Tables;
```

ตอนนี้เรามีเนมสเปซแล้ว มาดูส่วนที่น่าตื่นเต้นกัน นั่นก็คือการสร้างและแทรกตารางโดยตรงในเอกสาร Word

## ขั้นตอนที่ 1: การตั้งค่าเอกสาร

เริ่มต้นด้วยการตั้งค่าเอกสาร Word ใหม่ นี่คือตำแหน่งที่จะแทรกตารางของเรา

```csharp
// เส้นทางไปยังไดเรกทอรีเอกสารของคุณ
string dataDir = "YOUR DOCUMENT DIRECTORY";

Document doc = new Document();
```

 รหัสนี้จะเริ่มต้นเอกสาร Word ใหม่ คุณจะต้องแทนที่`"YOUR DOCUMENT DIRECTORY"` พร้อมเส้นทางจริงไปยังไดเร็กทอรีเอกสารของคุณ

## ขั้นตอนที่ 2: การสร้างวัตถุตาราง

ขั้นต่อไป เราจะสร้างอ็อบเจ็กต์ตาราง นี่คือจุดที่เราจะกำหนดโครงสร้างของตารางของเรา

```csharp
// เราเริ่มต้นด้วยการสร้างวัตถุตาราง โปรดทราบว่าเราต้องส่งวัตถุเอกสาร
// ให้กับคอนสตรัคเตอร์ของแต่ละโหนด เนื่องจากโหนดทุกโหนดที่เราสร้างจะต้องเป็นของ
// ไปยังเอกสารบางอย่าง
Table table = new Table(doc);
doc.FirstSection.Body.AppendChild(table);
```

ที่นี่เราสร้างตารางใหม่และผนวกเข้ากับเนื้อหาของส่วนแรกของเอกสารของเรา

## ขั้นตอนที่ 3: การเพิ่มแถวและเซลล์

ตารางประกอบด้วยแถวและเซลล์ มาเพิ่มองค์ประกอบเหล่านี้ทีละขั้นตอนกัน

### การเพิ่มแถว

```csharp
// ที่นี่เราสามารถเรียกใช้ EnsureMinimum เพื่อสร้างแถวและเซลล์ให้เราได้ วิธีการนี้ใช้
// เพื่อให้แน่ใจว่าโหนดที่ระบุนั้นถูกต้อง ในกรณีนี้ ตารางที่ถูกต้องควรมีอย่างน้อยหนึ่งแถวและหนึ่งเซลล์
// แทนที่จะทำอย่างนั้น เราจะจัดการสร้างแถวและตารางเอง
// นี่อาจเป็นวิธีที่ดีที่สุดในการดำเนินการนี้ หากเรากำลังสร้างตารางภายในอัลกอริทึม
Row row = new Row(doc);
row.RowFormat.AllowBreakAcrossPages = true;
table.AppendChild(row);
```

โค้ดนี้จะสร้างแถวใหม่และผนวกเข้ากับตารางของเรา

### การเพิ่มเซลล์ลงในแถว

ทีนี้มาเพิ่มเซลล์ลงในแถวของเรากัน 

```csharp
Cell cell = new Cell(doc);
cell.CellFormat.Shading.BackgroundPatternColor = Color.LightBlue;
cell.CellFormat.Width = 80;
cell.AppendChild(new Paragraph(doc));
cell.FirstParagraph.AppendChild(new Run(doc, "Row 1, Cell 1 Text"));
row.AppendChild(cell);
```

ในสไนปเป็ตนี้ เราสร้างเซลล์ กำหนดสีพื้นหลังเป็นสีฟ้าอ่อน และกำหนดความกว้าง จากนั้น เพิ่มย่อหน้าและรันลงในเซลล์เพื่อเก็บข้อความของเรา

## ขั้นตอนที่ 4: การโคลนเซลล์

เพื่อเร่งกระบวนการเพิ่มเซลล์ เราสามารถโคลนเซลล์ที่มีอยู่ได้

```csharp
// จากนั้นเราจะทำซ้ำขั้นตอนเดียวกันสำหรับเซลล์และแถวอื่น ๆ ในตาราง
//เราสามารถเพิ่มความเร็วได้ด้วยการโคลนเซลล์และแถวที่มีอยู่
row.AppendChild(cell.Clone(false));
row.LastCell.AppendChild(new Paragraph(doc));
row.LastCell.FirstParagraph.AppendChild(new Run(doc, "Row 1, Cell 2 Text"));
```

โค้ดนี้จะโคลนเซลล์ที่มีอยู่แล้วและเพิ่มลงในแถว จากนั้นจึงเพิ่มย่อหน้าและรันลงในเซลล์ใหม่

## ขั้นตอนที่ 5: ใช้การตั้งค่าปรับพอดีอัตโนมัติ

สุดท้าย ให้ใช้การตั้งค่าปรับพอดีอัตโนมัติกับตารางของเราเพื่อให้แน่ใจว่าคอลัมน์มีความกว้างคงที่

```csharp
// ตอนนี้เราสามารถใช้การตั้งค่าปรับพอดีอัตโนมัติได้แล้ว
table.AutoFit(AutoFitBehavior.FixedColumnWidths);
```

## ขั้นตอนที่ 6: การบันทึกเอกสาร

เมื่อตารางของเราจัดเสร็จเรียบร้อยแล้ว ก็ถึงเวลาบันทึกเอกสาร

```csharp
doc.Save(dataDir + "WorkingWithTables.InsertTableDirectly.docx");
```

รหัสนี้จะบันทึกเอกสารที่มีการแทรกตารางเข้าไป

## บทสรุป

ขอแสดงความยินดี! คุณได้แทรกตารางโดยตรงลงในเอกสาร Word สำเร็จแล้วโดยใช้ Aspose.Words สำหรับ .NET กระบวนการนี้ใช้เพื่อสร้างตารางที่ซับซ้อนด้วยโปรแกรม ทำให้การทำงานอัตโนมัติของเอกสารของคุณง่ายขึ้นมาก ไม่ว่าคุณจะกำลังสร้างรายงาน ใบแจ้งหนี้ หรือเอกสารประเภทอื่น การเข้าใจวิธีการจัดการตารางถือเป็นทักษะที่สำคัญ

## คำถามที่พบบ่อย

### ฉันจะดาวน์โหลด Aspose.Words สำหรับ .NET ได้อย่างไร?
 คุณสามารถดาวน์โหลด Aspose.Words สำหรับ .NET ได้จาก[หน้าดาวน์โหลด](https://releases.aspose.com/words/net/).

### ฉันสามารถทดลองใช้ Aspose.Words สำหรับ .NET ก่อนซื้อได้หรือไม่
 ใช่ คุณสามารถร้องขอได้[ทดลองใช้งานฟรี](https://releases.aspose.com/) เพื่อประเมินห้องสมุดก่อนการซื้อ

### ฉันจะซื้อ Aspose.Words สำหรับ .NET ได้อย่างไร?
คุณสามารถซื้อ Aspose.Words สำหรับ .NET ได้จาก[หน้าการซื้อ](https://purchase.aspose.com/buy).

### ฉันสามารถค้นหาเอกสารสำหรับ Aspose.Words สำหรับ .NET ได้ที่ไหน
 เอกสารประกอบมีให้ใช้งาน[ที่นี่](https://reference.aspose.com/words/net/).

### จะเกิดอะไรขึ้นหากฉันต้องการการสนับสนุนในระหว่างที่ใช้ Aspose.Words สำหรับ .NET?
 หากต้องการความช่วยเหลือ สามารถเข้าไปเยี่ยมชมได้ที่[ฟอรั่ม Aspose.Words](https://forum.aspose.com/c/words/8).