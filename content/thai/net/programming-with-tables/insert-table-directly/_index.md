---
title: แทรกตารางโดยตรง
linktitle: แทรกตารางโดยตรง
second_title: Aspose.Words API การประมวลผลเอกสาร
description: เรียนรู้วิธีแทรกตารางลงในเอกสาร Word โดยตรงโดยใช้ Aspose.Words สำหรับ .NET ปฏิบัติตามคำแนะนำโดยละเอียดทีละขั้นตอนของเราเพื่อปรับปรุงการสร้างเอกสารของคุณ
type: docs
weight: 10
url: /th/net/programming-with-tables/insert-table-directly/
---
## การแนะนำ
การสร้างตารางโดยทางโปรแกรมอาจเป็นเรื่องท้าทาย โดยเฉพาะอย่างยิ่งเมื่อต้องจัดการกับโครงสร้างเอกสารที่ซับซ้อน แต่ไม่ต้องกังวล เราพร้อมจะทำลายมันให้คุณ! ในคู่มือนี้ เราจะอธิบายขั้นตอนการแทรกตารางลงในเอกสาร Word โดยตรงโดยใช้ Aspose.Words สำหรับ .NET ไม่ว่าคุณจะเป็นนักพัฒนาที่มีประสบการณ์หรือเพิ่งเริ่มต้น บทช่วยสอนนี้จะช่วยให้คุณเชี่ยวชาญกระบวนการได้อย่างง่ายดาย

## ข้อกำหนดเบื้องต้น

ก่อนที่จะเจาะลึกโค้ด เรามาตรวจสอบให้แน่ใจว่าคุณมีทุกสิ่งที่จำเป็นในการเริ่มต้นแล้ว นี่คือรายการตรวจสอบด่วน:

1.  Aspose.Words สำหรับ .NET Library: ตรวจสอบให้แน่ใจว่าคุณได้ดาวน์โหลดและติดตั้งไลบรารี Aspose.Words สำหรับ .NET แล้ว คุณสามารถรับได้จาก[หน้าดาวน์โหลด](https://releases.aspose.com/words/net/).
2. สภาพแวดล้อมการพัฒนา: สภาพแวดล้อมการพัฒนาเช่น Visual Studio
3. ความรู้พื้นฐานของ C#: ทำความเข้าใจพื้นฐานของการเขียนโปรแกรม C#
4. Document Directory: เส้นทางไดเรกทอรีที่คุณจะบันทึกเอกสารของคุณ

ด้วยข้อกำหนดเบื้องต้นเหล่านี้ คุณก็พร้อมที่จะเริ่มเขียนโค้ดแล้ว!

## นำเข้าเนมสเปซ

ขั้นแรก เรามานำเข้าเนมสเปซที่จำเป็นกันก่อน เนมสเปซเหล่านี้จะให้คลาสและวิธีการที่จำเป็นในการทำงานกับเอกสาร Word แก่เรา

```csharp
using System;
using System.Drawing;
using Aspose.Words;
using Aspose.Words.Tables;
```

ตอนนี้เรามีเนมสเปซพร้อมแล้ว มาดูส่วนที่น่าตื่นเต้นกันดีกว่า นั่นคือการสร้างและการแทรกตารางลงในเอกสาร Word โดยตรง

## ขั้นตอนที่ 1: การตั้งค่าเอกสาร

เริ่มต้นด้วยการตั้งค่าเอกสาร Word ใหม่ นี่คือที่ที่ตารางของเราจะถูกแทรก

```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสารของคุณ
string dataDir = "YOUR DOCUMENT DIRECTORY";

Document doc = new Document();
```

รหัสนี้เตรียมใช้งานเอกสาร Word ใหม่ คุณจะต้องเปลี่ยน`"YOUR DOCUMENT DIRECTORY"` ด้วยเส้นทางจริงไปยังไดเร็กทอรีเอกสารของคุณ

## ขั้นตอนที่ 2: การสร้างวัตถุตาราง

ต่อไปเราจะสร้างวัตถุตาราง นี่คือที่ที่เราจะกำหนดโครงสร้างของตารางของเรา

```csharp
// เราเริ่มต้นด้วยการสร้างวัตถุตาราง โปรดทราบว่าเราต้องส่งวัตถุเอกสาร
// ไปยังตัวสร้างของแต่ละโหนด เนื่องจากทุกโหนดที่เราสร้างจะต้องเป็นของตัวเอง
// ไปยังเอกสารบางอย่าง
Table table = new Table(doc);
doc.FirstSection.Body.AppendChild(table);
```

ที่นี่ เราสร้างตารางใหม่และผนวกเข้ากับเนื้อหาของส่วนแรกของเอกสารของเรา

## ขั้นตอนที่ 3: การเพิ่มแถวและเซลล์

ตารางประกอบด้วยแถวและเซลล์ มาเพิ่มองค์ประกอบเหล่านี้ทีละขั้นตอน

### การเพิ่มแถว

```csharp
// ที่นี่เราสามารถเรียก SureMinimum เพื่อสร้างแถวและเซลล์ให้เราได้ วิธีนี้ใช้
// เพื่อให้แน่ใจว่าโหนดที่ระบุนั้นถูกต้อง ในกรณีนี้ ตารางที่ถูกต้องควรมีอย่างน้อยหนึ่งแถวและหนึ่งเซลล์
// แต่เราจะจัดการสร้างแถวและตารางเองแทน
//นี่จะเป็นวิธีที่ดีที่สุดหากเราสร้างตารางภายในอัลกอริทึม
Row row = new Row(doc);
row.RowFormat.AllowBreakAcrossPages = true;
table.AppendChild(row);
```

รหัสนี้จะสร้างแถวใหม่และผนวกเข้ากับตารางของเรา

### การเพิ่มเซลล์ลงในแถว

ตอนนี้ เรามาเพิ่มเซลล์บางส่วนในแถวของเรา 

```csharp
Cell cell = new Cell(doc);
cell.CellFormat.Shading.BackgroundPatternColor = Color.LightBlue;
cell.CellFormat.Width = 80;
cell.AppendChild(new Paragraph(doc));
cell.FirstParagraph.AppendChild(new Run(doc, "Row 1, Cell 1 Text"));
row.AppendChild(cell);
```

ในตัวอย่างนี้ เราสร้างเซลล์ ตั้งค่าสีพื้นหลังเป็นสีฟ้าอ่อน และกำหนดความกว้าง จากนั้นเราเพิ่มย่อหน้าและวิ่งไปที่เซลล์เพื่อเก็บข้อความของเรา

## ขั้นตอนที่ 4: การโคลนเซลล์

เพื่อเร่งกระบวนการเพิ่มเซลล์ เราสามารถโคลนเซลล์ที่มีอยู่ได้

```csharp
// จากนั้นเราจะทำซ้ำขั้นตอนนี้กับเซลล์และแถวอื่นๆ ในตาราง
// นอกจากนี้เรายังสามารถเร่งความเร็วได้ด้วยการโคลนเซลล์และแถวที่มีอยู่
row.AppendChild(cell.Clone(false));
row.LastCell.AppendChild(new Paragraph(doc));
row.LastCell.FirstParagraph.AppendChild(new Run(doc, "Row 1, Cell 2 Text"));
```

โค้ดนี้จะโคลนเซลล์ที่มีอยู่และเพิ่มลงในแถว จากนั้นเราจะเพิ่มย่อหน้าและเรียกใช้ลงในเซลล์ใหม่

## ขั้นตอนที่ 5: การใช้การตั้งค่าพอดีอัตโนมัติ

สุดท้าย ลองใช้การตั้งค่าการปรับให้พอดีอัตโนมัติกับตารางของเราเพื่อให้แน่ใจว่าคอลัมน์มีความกว้างคงที่

```csharp
// ตอนนี้เราสามารถใช้การตั้งค่าการปรับให้พอดีอัตโนมัติได้แล้ว
table.AutoFit(AutoFitBehavior.FixedColumnWidths);
```

## ขั้นตอนที่ 6: บันทึกเอกสาร

เมื่อตารางของเราถูกจัดเตรียมเรียบร้อยแล้ว ก็ถึงเวลาบันทึกเอกสาร

```csharp
doc.Save(dataDir + "WorkingWithTables.InsertTableDirectly.docx");
```

รหัสนี้จะบันทึกเอกสารโดยแทรกตารางไว้

## บทสรุป

ยินดีด้วย! คุณได้แทรกตารางลงในเอกสาร Word โดยตรงโดยใช้ Aspose.Words for .NET สำเร็จแล้ว กระบวนการนี้สามารถใช้เพื่อสร้างตารางที่ซับซ้อนโดยทางโปรแกรม ทำให้งานเอกสารอัตโนมัติของคุณง่ายขึ้นมาก ไม่ว่าคุณจะสร้างรายงาน ใบแจ้งหนี้ หรือเอกสารประเภทอื่นๆ การทำความเข้าใจวิธีจัดการตารางถือเป็นทักษะที่สำคัญ

## คำถามที่พบบ่อย

### ฉันจะดาวน์โหลด Aspose.Words สำหรับ .NET ได้อย่างไร
 คุณสามารถดาวน์โหลด Aspose.Words สำหรับ .NET ได้จาก[หน้าดาวน์โหลด](https://releases.aspose.com/words/net/).

### ฉันสามารถลองใช้ Aspose.Words สำหรับ .NET ก่อนซื้อได้หรือไม่
 ใช่ คุณสามารถขอ[ทดลองฟรี](https://releases.aspose.com/) เพื่อประเมินห้องสมุดก่อนซื้อ

### ฉันจะซื้อ Aspose.Words สำหรับ .NET ได้อย่างไร
 คุณสามารถซื้อ Aspose.Words สำหรับ .NET ได้จาก[หน้าซื้อ](https://purchase.aspose.com/buy).

### ฉันจะหาเอกสารสำหรับ Aspose.Words สำหรับ .NET ได้ที่ไหน
 เอกสารก็มีให้[ที่นี่](https://reference.aspose.com/words/net/).

### จะเกิดอะไรขึ้นหากฉันต้องการความช่วยเหลือขณะใช้ Aspose.Words สำหรับ .NET
 สำหรับการสนับสนุนคุณสามารถเยี่ยมชมที่[ฟอรั่ม Aspose.Words](https://forum.aspose.com/c/words/8).