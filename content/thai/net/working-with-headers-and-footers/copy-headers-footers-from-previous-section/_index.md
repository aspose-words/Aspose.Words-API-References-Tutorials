---
title: คัดลอกส่วนหัวส่วนท้ายจากส่วนก่อนหน้า
linktitle: คัดลอกส่วนหัวส่วนท้ายจากส่วนก่อนหน้า
second_title: Aspose.Words API การประมวลผลเอกสาร
description: เรียนรู้วิธีคัดลอกส่วนหัวและส่วนท้ายจากส่วนก่อนหน้าในเอกสาร Word โดยใช้ Aspose.Words สำหรับ .NET
type: docs
weight: 10
url: /th/net/working-with-headers-and-footers/copy-headers-footers-from-previous-section/
---

ในบทช่วยสอนทีละขั้นตอนนี้ เราจะแนะนำคุณเกี่ยวกับวิธีการคัดลอกส่วนหัวและส่วนท้ายจากส่วนก่อนหน้าในเอกสาร Word โดยใช้ Aspose.Words สำหรับ .NET เราจะอธิบายซอร์สโค้ด C# ที่ให้มา และแสดงวิธีนำไปใช้ในโครงการของคุณเอง

 ในการเริ่มต้น ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง Aspose.Words สำหรับ .NET และตั้งค่าในสภาพแวดล้อมการพัฒนาของคุณ หากคุณยังไม่ได้ดำเนินการ ให้ดาวน์โหลดและติดตั้งไลบรารีจาก[Aspose.Releases]https://releases.aspose.com/words/net/

## ขั้นตอนที่ 1: การเข้าถึงส่วนก่อนหน้า

 ขั้นแรก ให้ดึงข้อมูลส่วนก่อนหน้าโดยเข้าไปที่`PreviousSibling` คุณสมบัติของส่วนปัจจุบัน:

```csharp
Section previousSection = (Section)section.PreviousSibling;
```

## ขั้นตอนที่ 2: ตรวจสอบส่วนก่อนหน้า

จากนั้นตรวจสอบว่ามีส่วนก่อนหน้าอยู่หรือไม่ หากไม่มีส่วนก่อนหน้า เราก็เพียงส่งคืน:

```csharp
if (previousSection == null)
    return;
```

## ขั้นตอนที่ 3: การล้างและการคัดลอกส่วนหัวและส่วนท้าย

หากต้องการคัดลอกส่วนหัวและส่วนท้ายจากส่วนก่อนหน้าไปยังส่วนปัจจุบัน เราจะล้างส่วนหัวและส่วนท้ายที่มีอยู่ในส่วนปัจจุบัน จากนั้นวนซ้ำส่วนหัวและส่วนท้ายของส่วนก่อนหน้าเพื่อเพิ่มสำเนาที่คัดลอกมาในส่วนปัจจุบัน:

```csharp
section.HeadersFooters.Clear();

foreach (HeaderFooter headerFooter in previousSection.HeadersFooters)
    section.HeadersFooters.Add(headerFooter.Clone(true));
```

## ขั้นตอนที่ 4: บันทึกเอกสาร

สุดท้าย ให้บันทึกเอกสารที่แก้ไข:

```csharp
doc.Save("OutputDocument.docx");
```

แค่นั้นแหละ! คุณได้คัดลอกส่วนหัวและส่วนท้ายจากส่วนก่อนหน้าไปยังส่วนปัจจุบันในเอกสาร Word ได้สำเร็จโดยใช้ Aspose.Words สำหรับ .NET

### ตัวอย่างซอร์สโค้ดสำหรับการคัดลอกส่วนหัวส่วนท้ายจากส่วนก่อนหน้าโดยใช้ Aspose.Words สำหรับ .NET

```csharp
Section previousSection = (Section)section.PreviousSibling;

if (previousSection == null)
    return;

section.HeadersFooters.Clear();

foreach (HeaderFooter headerFooter in previousSection.HeadersFooters)
    section.HeadersFooters.Add(headerFooter.Clone(true));

doc.Save("OutputDocument.docx");
```

คุณสามารถใช้โค้ดนี้ในโครงการของคุณเองและแก้ไขได้ตามความต้องการเฉพาะของคุณ

### คำถามที่พบบ่อย

#### ถาม: ฉันจะคัดลอกส่วนหัวและส่วนท้ายจากส่วนก่อนหน้าไปยัง Aspose.Words ได้อย่างไร

 ตอบ: หากต้องการคัดลอกส่วนหัวและส่วนท้ายจากส่วนก่อนหน้าไปยัง Aspose.Words คุณสามารถใช้`CopyHeadersFootersFromPreviousSection()` วิธีการในปัจจุบัน`Section`วัตถุ. การดำเนินการนี้จะคัดลอกส่วนหัวและส่วนท้ายจากส่วนก่อนหน้าไปยังส่วนปัจจุบัน

#### ถาม: เป็นไปได้ไหมที่จะคัดลอกเฉพาะส่วนหัวหรือส่วนท้ายจากส่วนก่อนหน้าใน Aspose.Words

 ตอบ: ได้ คุณสามารถคัดลอกเฉพาะส่วนหัวหรือส่วนท้ายจากส่วนก่อนหน้าใน Aspose.Words ได้ สำหรับสิ่งนี้ คุณสามารถใช้`CopyHeaderFromPreviousSection()` และ`CopyFooterFromPreviousSection()` วิธีการในปัจจุบัน`Section` วัตถุเพื่อคัดลอกส่วนหัวหรือส่วนท้ายจากส่วนก่อนหน้าไปยังส่วนปัจจุบันโดยเฉพาะ

#### ถาม: การคัดลอกส่วนหัวและส่วนท้ายจากส่วนก่อนหน้าจะแทนที่ส่วนหัวและส่วนท้ายที่มีอยู่ในส่วนปัจจุบันหรือไม่

ตอบ: ใช่ การคัดลอกส่วนหัวและส่วนท้ายจากส่วนก่อนหน้าจะแทนที่ส่วนหัวและส่วนท้ายที่มีอยู่ในส่วนปัจจุบัน หากคุณต้องการเก็บส่วนหัวและส่วนท้ายที่มีอยู่และเพิ่มลงในส่วนหัวและส่วนท้ายที่คัดลอก คุณจะต้องดำเนินการเพิ่มเติมเพื่อรวมเนื้อหา

#### ถาม: ฉันจะตรวจสอบได้อย่างไรว่าส่วนมีส่วนหัวหรือส่วนท้ายจากส่วนก่อนหน้าใน Aspose.Words

ตอบ: หากต้องการตรวจสอบว่าส่วนมีส่วนหัวหรือส่วนท้ายจากส่วนก่อนหน้าใน Aspose.Words หรือไม่ คุณสามารถใช้`HasHeader` และ`HasFooter` คุณสมบัติบน`Section` วัตถุเพื่อตรวจสอบว่าส่วนหัวหรือส่วนท้ายของส่วนหัวมีอยู่หรือไม่ ถ้า`HasHeader` หรือ`HasFooter` ผลตอบแทน`false`หมายความว่าไม่มีส่วนหัวหรือส่วนท้ายจากส่วนก่อนหน้าในส่วนนี้