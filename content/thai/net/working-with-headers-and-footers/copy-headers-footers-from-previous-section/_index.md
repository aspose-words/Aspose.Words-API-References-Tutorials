---
title: คัดลอกส่วนหัวส่วนท้ายจากส่วนก่อนหน้า
linktitle: คัดลอกส่วนหัวส่วนท้ายจากส่วนก่อนหน้า
second_title: Aspose.Words API การประมวลผลเอกสาร
description: เรียนรู้วิธีคัดลอกส่วนหัวและส่วนท้ายระหว่างส่วนต่างๆ ในเอกสาร Word โดยใช้ Aspose.Words สำหรับ .NET คู่มือโดยละเอียดนี้รับประกันความสม่ำเสมอและความเป็นมืออาชีพ
type: docs
weight: 10
url: /th/net/working-with-headers-and-footers/copy-headers-footers-from-previous-section/
---

การเพิ่มและการคัดลอกส่วนหัวและส่วนท้ายในเอกสารของคุณสามารถเพิ่มความเป็นมืออาชีพและความสม่ำเสมอของเอกสารได้อย่างมาก ด้วย Aspose.Words สำหรับ .NET งานนี้ตรงไปตรงมาและปรับแต่งได้สูง ในบทช่วยสอนที่ครอบคลุมนี้ เราจะแนะนำคุณตลอดขั้นตอนการคัดลอกส่วนหัวและส่วนท้ายจากส่วนหนึ่งไปยังอีกส่วนหนึ่งในเอกสาร Word ของคุณทีละขั้นตอน

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเจาะลึกบทช่วยสอน ตรวจสอบให้แน่ใจว่าคุณมีสิ่งต่อไปนี้:

-  Aspose.Words สำหรับ .NET: ดาวน์โหลดและติดตั้งจาก[ลิ้งค์ดาวน์โหลด](https://releases.aspose.com/words/net/).
- สภาพแวดล้อมการพัฒนา: เช่น Visual Studio เพื่อเขียนและรันโค้ด C# ของคุณ
- ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับการเขียนโปรแกรม C# และกรอบงาน .NET
- เอกสารตัวอย่าง: ใช้เอกสารที่มีอยู่หรือสร้างเอกสารใหม่ตามที่แสดงในบทช่วยสอนนี้

## นำเข้าเนมสเปซ

ในการเริ่มต้น คุณจะต้องนำเข้าเนมสเปซที่จำเป็นซึ่งจะทำให้คุณสามารถใช้ฟังก์ชัน Aspose.Words ได้

```csharp
using Aspose.Words;
using Aspose.Words.Tables;
using System;
```

## ขั้นตอนที่ 1: สร้างเอกสารใหม่

 ขั้นแรก สร้างเอกสารใหม่และก`DocumentBuilder` เพื่ออำนวยความสะดวกในการเพิ่มและจัดการเนื้อหา

```csharp
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## ขั้นตอนที่ 2: เข้าถึงส่วนปัจจุบัน

จากนั้น เข้าถึงส่วนปัจจุบันของเอกสารที่คุณต้องการคัดลอกส่วนหัวและส่วนท้าย

```csharp
Section currentSection = builder.CurrentSection;
```

## ขั้นตอนที่ 3: กำหนดส่วนก่อนหน้า

กำหนดส่วนก่อนหน้าที่คุณต้องการคัดลอกส่วนหัวและส่วนท้าย หากไม่มีส่วนก่อนหน้า คุณสามารถกลับมาได้โดยไม่ต้องดำเนินการใดๆ

```csharp
Section previousSection = (Section)currentSection.PreviousSibling;
if (previousSection == null)
    return;
```

## ขั้นตอนที่ 4: ล้างส่วนหัวและส่วนท้ายที่มีอยู่

ล้างส่วนหัวและส่วนท้ายที่มีอยู่ในส่วนปัจจุบันเพื่อหลีกเลี่ยงการทำซ้ำ

```csharp
currentSection.HeadersFooters.Clear();
```

## ขั้นตอนที่ 5: คัดลอกส่วนหัวและส่วนท้าย

คัดลอกส่วนหัวและส่วนท้ายจากส่วนก่อนหน้าไปยังส่วนปัจจุบัน เพื่อให้แน่ใจว่าการจัดรูปแบบและเนื้อหาสอดคล้องกันในทุกส่วน

```csharp
foreach (HeaderFooter headerFooter in previousSection.HeadersFooters)
    currentSection.HeadersFooters.Add(headerFooter.Clone(true));
```

## ขั้นตอนที่ 6: บันทึกเอกสาร

สุดท้าย ให้บันทึกเอกสารไปยังตำแหน่งที่ต้องการ ขั้นตอนนี้ช่วยให้แน่ใจว่าการเปลี่ยนแปลงทั้งหมดของคุณจะถูกเขียนลงในไฟล์เอกสาร

```csharp
doc.Save("OutputDocument.docx");
```

## คำอธิบายโดยละเอียดของแต่ละขั้นตอน

### ขั้นตอนที่ 1: สร้างเอกสารใหม่

 ในขั้นตอนนี้ เราจะเริ่มต้นอินสแตนซ์ใหม่ของ`Document` คลาสและก`DocumentBuilder` - ที่`DocumentBuilder` เป็นคลาสตัวช่วยที่ทำให้กระบวนการเพิ่มเนื้อหาลงในเอกสารง่ายขึ้น

### ขั้นตอนที่ 2: เข้าถึงส่วนปัจจุบัน

เราดึงข้อมูลส่วนปัจจุบันโดยใช้`builder.CurrentSection`- ส่วนนี้จะเป็นเป้าหมายที่เราจะคัดลอกส่วนหัวและส่วนท้ายจากส่วนก่อนหน้า

### ขั้นตอนที่ 3: กำหนดส่วนก่อนหน้า

 โดยการตรวจสอบ`currentSection.PreviousSibling`เราได้รับส่วนก่อนหน้า หากส่วนก่อนหน้าเป็นโมฆะ วิธีการจะส่งกลับโดยไม่ต้องดำเนินการใดๆ เพิ่มเติม การตรวจสอบนี้ป้องกันข้อผิดพลาดที่อาจเกิดขึ้นหากไม่มีส่วนก่อนหน้า

### ขั้นตอนที่ 4: ล้างส่วนหัวและส่วนท้ายที่มีอยู่

เราล้างส่วนหัวและส่วนท้ายที่มีอยู่ในส่วนปัจจุบันเพื่อให้แน่ใจว่าเราไม่ได้มีส่วนหัวและส่วนท้ายหลายชุด

### ขั้นตอนที่ 5: คัดลอกส่วนหัวและส่วนท้าย

 ใช้ foreach loop เราวนซ้ำแต่ละอัน`HeaderFooter` ในส่วนก่อนหน้า ที่`Clone(true)` วิธีการสร้างสำเนาส่วนหัวหรือส่วนท้ายแบบลึกเพื่อให้แน่ใจว่าเนื้อหาและการจัดรูปแบบทั้งหมดจะยังคงอยู่

### ขั้นตอนที่ 6: บันทึกเอกสาร

 ที่`doc.Save("OutputDocument.docx")` บรรทัดเขียนการเปลี่ยนแปลงทั้งหมดในเอกสาร บันทึกด้วยชื่อไฟล์ที่ระบุ

## บทสรุป

การคัดลอกส่วนหัวและส่วนท้ายจากส่วนหนึ่งไปยังอีกส่วนหนึ่งในเอกสาร Word โดยใช้ Aspose.Words สำหรับ .NET นั้นตรงไปตรงมาและมีประสิทธิภาพ ด้วยการทำตามคำแนะนำทีละขั้นตอนนี้ คุณสามารถมั่นใจได้ว่าเอกสารของคุณจะมีรูปลักษณ์ที่สม่ำเสมอและเป็นมืออาชีพในทุกส่วน

## คำถามที่พบบ่อย

### คำถามที่ 1: Aspose.Words สำหรับ .NET คืออะไร

Aspose.Words สำหรับ .NET เป็นไลบรารีที่มีประสิทธิภาพซึ่งช่วยให้นักพัฒนาสามารถสร้าง จัดการ และแปลงเอกสาร Word โดยทางโปรแกรมภายในแอปพลิเคชัน .NET

### คำถามที่ 2: ฉันสามารถคัดลอกส่วนหัวและส่วนท้ายจากส่วนใดส่วนหนึ่งไปยังส่วนอื่นได้หรือไม่

ได้ คุณสามารถคัดลอกส่วนหัวและส่วนท้ายระหว่างส่วนใดๆ ในเอกสาร Word ได้โดยใช้วิธีการที่อธิบายไว้ในบทช่วยสอนนี้

### คำถามที่ 3: ฉันจะจัดการส่วนหัวและส่วนท้ายที่แตกต่างกันสำหรับหน้าคี่และหน้าคู่ได้อย่างไร

 คุณสามารถตั้งค่าส่วนหัวและส่วนท้ายที่แตกต่างกันสำหรับหน้าคี่และหน้าคู่ได้โดยใช้`PageSetup.OddAndEvenPagesHeaderFooter` คุณสมบัติ.

### คำถามที่ 4: ฉันจะหาข้อมูลเพิ่มเติมเกี่ยวกับ Aspose.Words สำหรับ .NET ได้ที่ไหน

 คุณสามารถค้นหาเอกสารที่ครอบคลุมได้ที่[หน้าเอกสารประกอบ Aspose.Words API](https://reference.aspose.com/words/net/).

### คำถามที่ 5: Aspose.Words สำหรับ .NET มีรุ่นทดลองใช้ฟรีหรือไม่

ใช่ คุณสามารถดาวน์โหลดรุ่นทดลองใช้ฟรีได้จาก[หน้าดาวน์โหลด](https://releases.aspose.com/).