---
title: แก้ไขแมโคร Vba ของเอกสาร Word
linktitle: แก้ไขแมโคร Vba ของเอกสาร Word
second_title: Aspose.Words API การประมวลผลเอกสาร
description: ในบทช่วยสอนนี้ เรียนรู้วิธีแก้ไขมาโคร VBA ของเอกสาร Word ด้วย Aspose.Words สำหรับ .NET
type: docs
weight: 10
url: /th/net/working-with-vba-macros/modify-vba-macros/
---
ในบทช่วยสอนนี้ เราจะอธิบายวิธีแก้ไขมาโคร VBA ของเอกสาร Word โดยใช้ไลบรารี Aspose.Words สำหรับ .NET การแก้ไขมาโคร VBA ช่วยให้คุณสามารถอัปเดตโค้ด VBA ที่มีอยู่ในเอกสาร Word ของคุณได้ เราจะอธิบายทีละขั้นตอนเพื่อช่วยให้คุณเข้าใจและนำโค้ดไปใช้ในโครงการ .NET ของคุณ

## ข้อกำหนดเบื้องต้น
ก่อนที่คุณจะเริ่มต้น ตรวจสอบให้แน่ใจว่าคุณมีรายการต่อไปนี้:
- ความรู้การทำงานของภาษาการเขียนโปรแกรม C #
- ไลบรารี Aspose.Words สำหรับ .NET ที่ติดตั้งในโครงการของคุณ
- เอกสาร Word ที่มีแมโคร VBA ที่คุณต้องการแก้ไข

## ขั้นตอนที่ 1: กำหนดไดเร็กทอรีเอกสาร
 ขั้นแรก คุณต้องตั้งค่าเส้นทางไดเรกทอรีไปยังตำแหน่งของเอกสาร Word ของคุณ แทนที่`"YOUR DOCUMENT DIRECTORY"` ในโค้ดด้วยเส้นทางที่เหมาะสม

```csharp
// พาธไปยังไดเร็กทอรีเอกสารของคุณ
string dataDir = "YOUR DOCUMENTS DIRECTORY";
```

## ขั้นตอนที่ 2: โหลดเอกสารที่มีแมโคร VBA
ต่อไปเราจะโหลดเอกสาร Word ที่มีมาโคร VBA ที่เราต้องการแก้ไข

```csharp
// โหลดเอกสารที่มีแมโคร VBA
Document doc = new Document(dataDir + "VBA project.docm");
VbaProject project = doc.VbaProject;
```

## ขั้นตอนที่ 3: แก้ไขซอร์สโค้ดมาโคร
 ตอนนี้เรากำลังจะแก้ไขซอร์สโค้ดของมาโครแรกของโครงการ VBA แทนที่`newSourceCode` ตัวแปรด้วยซอร์สโค้ดใหม่ที่คุณต้องการใช้

```csharp
const string newSourceCode = "Test change source code";
project.Modules[0].SourceCode = newSourceCode;
```

## ขั้นตอนที่ 4: บันทึกเอกสารที่แก้ไข
สุดท้ายนี้ เราจะบันทึกเอกสารที่แก้ไขด้วยมาโคร VBA ที่อัปเดตแล้วลงในไฟล์

```csharp
doc.Save(dataDir + "WorkingWithVba.ModifyVbaMacros.docm");
```

### ตัวอย่างซอร์สโค้ดสำหรับ Modify Vba Macros โดยใช้ Aspose.Words สำหรับ .NET
 
```csharp

// เส้นทางไปยังไดเร็กทอรีเอกสารของคุณ
string dataDir = "YOUR DOCUMENT DIRECTORY";

Document doc = new Document(dataDir + "VBA project.docm");
VbaProject project = doc.VbaProject;
const string newSourceCode = "Test change source code";
project.Modules[0].SourceCode = newSourceCode;
doc.Save(dataDir + "WorkingWithVba.ModifyVbaMacros.docm");

```

## บทสรุป
ในบทช่วยสอนนี้ เราเห็นวิธีแก้ไขมาโคร VBA ในเอกสาร Word โดยใช้ Aspose.Words สำหรับ .NET การแก้ไขแมโคร VBA ช่วยให้คุณสามารถอัปเดตโค้ด VBA ที่มีอยู่ในเอกสารของคุณเพื่อทำการเปลี่ยนแปลงหรือปรับปรุงได้ คุณสามารถใช้คุณสมบัตินี้เพื่อปรับแต่งเพิ่มเติมและทำให้เอกสาร Word ของคุณเป็นแบบอัตโนมัติได้

### คำถามที่พบบ่อย

#### ถาม: แมโคร VBA ในเอกสาร Word คืออะไร

ตอบ: แมโคร VBA ในเอกสาร Word คือโค้ดชิ้นหนึ่งที่สามารถเรียกใช้เพื่อดำเนินการบางอย่างในเอกสารได้ แมโคร VBA ช่วยให้คุณทำงานอัตโนมัติ เพิ่มฟังก์ชันการทำงานแบบกำหนดเอง และโต้ตอบกับเนื้อหาเอกสารได้

#### ถาม: ข้อกำหนดเบื้องต้นสำหรับการแก้ไขแมโคร VBA ในเอกสาร Word คืออะไร

ตอบ: ก่อนที่คุณจะสามารถแก้ไขแมโคร VBA ในเอกสาร Word ได้ คุณต้องมีความรู้ในการทำงานของภาษาการเขียนโปรแกรม C# คุณต้องติดตั้งไลบรารี Aspose.Words สำหรับ .NET ในโปรเจ็กต์ของคุณด้วย นอกจากนี้ คุณต้องมีเอกสาร Word ที่มีแมโคร VBA ที่คุณต้องการแก้ไข

#### ถาม: จะตั้งค่าไดเร็กทอรีเอกสารในโค้ดได้อย่างไร?

 ตอบ: ในโค้ดที่ให้มา คุณต้องแทนที่`"YOUR DOCUMENTS DIRECTORY"` ด้วยเส้นทางที่เหมาะสมไปยังไดเร็กทอรีที่เอกสาร Word ของคุณมีแมโคร VBA ตั้งอยู่

#### ถาม: จะระบุซอร์สโค้ดใหม่ของมาโครเพื่อแก้ไขได้อย่างไร

 ตอบ: หากต้องการระบุซอร์สโค้ดใหม่ของมาโครที่คุณต้องการแก้ไข คุณสามารถใช้`SourceCode` ทรัพย์สินที่เกี่ยวข้อง`VbaModule` วัตถุโดยกำหนดสตริงอักขระที่มีรหัส VBA ใหม่

#### ถาม: ฉันสามารถแก้ไขมาโคร VBA หลายรายการในเอกสาร Word พร้อมกันได้หรือไม่

 ตอบ: ได้ คุณสามารถแก้ไขมาโคร VBA หลายรายการในเอกสาร Word ได้โดยใช้การวนซ้ำหรือเข้าถึงแมโครที่เกี่ยวข้องโดยตรง`VbaModule` วัตถุใน`Modules` คอลเลกชันของ`VbaProject` วัตถุ วัตถุ ซึ่งช่วยให้คุณสามารถอัปเดตมาโคร VBA หลายรายการพร้อมกันในการดำเนินการครั้งเดียว