---
title: แทรกฟิลด์ที่ซ้อนกัน
linktitle: แทรกฟิลด์ที่ซ้อนกัน
second_title: API การประมวลผลเอกสาร Aspose.Words
description: เรียนรู้วิธีการแทรกฟิลด์แบบซ้อนกันในเอกสาร Word โดยใช้ Aspose.Words สำหรับ .NET พร้อมคำแนะนำทีละขั้นตอนของเรา เหมาะสำหรับนักพัฒนาที่ต้องการสร้างเอกสารโดยอัตโนมัติ
type: docs
weight: 10
url: /th/net/working-with-fields/insert-nested-fields/
---
## การแนะนำ

คุณเคยพบว่าคุณต้องแทรกฟิลด์แบบซ้อนในเอกสาร Word ของคุณโดยใช้โปรแกรมหรือไม่ บางทีคุณอาจต้องการแสดงข้อความที่แตกต่างกันตามเงื่อนไขโดยอิงตามหมายเลขหน้าหรือไม่ คุณโชคดีแล้ว! บทช่วยสอนนี้จะแนะนำคุณตลอดกระบวนการแทรกฟิลด์แบบซ้อนโดยใช้ Aspose.Words สำหรับ .NET มาเริ่มกันเลย!

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเริ่มต้น มีบางสิ่งที่คุณจะต้องมี:

1.  Aspose.Words สำหรับ .NET: ตรวจสอบว่าคุณมีไลบรารี Aspose.Words สำหรับ .NET คุณสามารถดาวน์โหลดได้จาก[ที่นี่](https://releases.aspose.com/words/net/).
2. สภาพแวดล้อมการพัฒนา: IDE เช่น Visual Studio
3. ความรู้พื้นฐานเกี่ยวกับ C#: ความเข้าใจเกี่ยวกับภาษาการเขียนโปรแกรม C#

## นำเข้าเนมสเปซ

ก่อนอื่น ตรวจสอบให้แน่ใจว่าคุณได้นำเข้าเนมสเปซที่จำเป็นในโปรเจ็กต์ของคุณแล้ว เนมสเปซเหล่านี้ประกอบด้วยคลาสที่คุณจำเป็นต้องโต้ตอบกับ Aspose.Words

```csharp
using Aspose.Words;
using Aspose.Words.Fields;
using Aspose.Words.HeaderFooter;
```

## ขั้นตอนที่ 1: เริ่มต้นเอกสาร

ขั้นตอนแรกคือการสร้างเอกสารใหม่และอ็อบเจ็กต์ DocumentBuilder คลาส DocumentBuilder ช่วยในการสร้างและปรับเปลี่ยนเอกสาร Word

```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENTS DIRECTORY";

// สร้างเอกสารและ DocumentBuilder
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## ขั้นตอนที่ 2: แทรกตัวแบ่งหน้า

ต่อไปเราจะแทรกตัวแบ่งหน้าสองสามตัวลงในเอกสาร วิธีนี้จะช่วยให้เราสามารถแสดงฟิลด์ที่ซ้อนกันได้อย่างมีประสิทธิภาพ

```csharp
// แทรกตัวแบ่งหน้า
for (int i = 0; i < 5; i++)
{
    builder.InsertBreak(BreakType.PageBreak);
}
```

## ขั้นตอนที่ 3: ย้ายไปที่ส่วนท้าย

หลังจากแทรกตัวแบ่งหน้าแล้ว เราต้องย้ายไปที่ส่วนท้ายของเอกสาร นี่คือจุดที่เราจะแทรกฟิลด์ที่ซ้อนกัน

```csharp
// ย้ายไปที่ส่วนท้าย
builder.MoveToHeaderFooter(HeaderFooterType.FooterPrimary);
```

## ขั้นตอนที่ 4: แทรกฟิลด์แบบซ้อนกัน

ต่อไปเรามาแทรกฟิลด์ที่ซ้อนกันกัน เราจะใช้ฟิลด์ IF เพื่อแสดงข้อความตามเงื่อนไขโดยอิงตามหมายเลขหน้าปัจจุบัน

```csharp
// แทรกฟิลด์ที่ซ้อนกัน
Field field = builder.InsertField(@"IF ");
builder.MoveTo(field.Separator);
builder.InsertField("PAGE");
builder.Write(" <> ");
builder.InsertField("NUMPAGES");
builder.Write(" \"See next page\" \"Last page\" ");
```

ในขั้นตอนนี้ เราจะแทรกฟิลด์ IF ก่อน จากนั้นจึงเลื่อนไปที่ตัวคั่น แล้วจึงแทรกฟิลด์ PAGE และ NUMPAGES ฟิลด์ IF จะตรวจสอบว่าหมายเลขหน้าปัจจุบัน (PAGE) ไม่เท่ากับจำนวนหน้าทั้งหมด (NUMPAGES) หรือไม่ หากเป็นจริง จะแสดง "See next page" แต่ถ้าไม่เป็นเช่นนั้น จะแสดง "Last page"

## ขั้นตอนที่ 5: อัปเดตฟิลด์

สุดท้ายเราอัปเดตฟิลด์เพื่อให้แน่ใจว่าจะแสดงข้อความที่ถูกต้อง

```csharp
// อัพเดทข้อมูลสนาม
field.Update();
```

## ขั้นตอนที่ 6: บันทึกเอกสาร

ขั้นตอนสุดท้ายคือบันทึกเอกสารไปยังไดเร็กทอรีที่คุณระบุ

```csharp
doc.Save(dataDir + "InsertNestedFields.docx");
```

## บทสรุป

และแล้วคุณก็ทำได้! คุณได้แทรกฟิลด์ที่ซ้อนกันลงในเอกสาร Word สำเร็จแล้วโดยใช้ Aspose.Words สำหรับ .NET ไลบรารีอันทรงพลังนี้ทำให้การจัดการเอกสาร Word ด้วยโปรแกรมเป็นเรื่องง่ายอย่างเหลือเชื่อ ไม่ว่าคุณจะกำลังสร้างรายงาน สร้างเทมเพลต หรือทำให้เวิร์กโฟลว์เอกสารเป็นแบบอัตโนมัติ Aspose.Words ก็ช่วยคุณได้

## คำถามที่พบบ่อย

### ฟิลด์ซ้อนกันในเอกสาร Word คืออะไร?
ฟิลด์แบบซ้อนคือฟิลด์ที่ประกอบด้วยฟิลด์อื่นๆ อยู่ภายใน ฟิลด์เหล่านี้ช่วยให้เนื้อหาในเอกสารมีความซับซ้อนและมีเงื่อนไขมากขึ้น

### ฉันสามารถใช้ฟิลด์อื่นภายในฟิลด์ IF ได้หรือไม่
ใช่ คุณสามารถซ้อนฟิลด์ต่างๆ เช่น DATE, TIME และ AUTHOR ไว้ภายในฟิลด์ IF เพื่อสร้างเนื้อหาแบบไดนามิก

### Aspose.Words สำหรับ .NET ฟรีหรือเปล่า?
 Aspose.Words สำหรับ .NET เป็นไลบรารีเชิงพาณิชย์ แต่คุณสามารถรับได้[ทดลองใช้งานฟรี](https://releases.aspose.com/) เพื่อลองดูมันดู

### ฉันสามารถใช้ Aspose.Words กับภาษา .NET อื่นๆ ได้หรือไม่
ใช่ Aspose.Words รองรับภาษา .NET ทั้งหมด รวมถึง VB.NET และ F#

### ฉันสามารถหาเอกสารเพิ่มเติมเกี่ยวกับ Aspose.Words สำหรับ .NET ได้จากที่ใด
 คุณสามารถค้นหาเอกสารรายละเอียดได้[ที่นี่](https://reference.aspose.com/words/net/).