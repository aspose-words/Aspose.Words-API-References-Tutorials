---
title: แทรกฟิลด์ที่ซ้อนกัน
linktitle: แทรกฟิลด์ที่ซ้อนกัน
second_title: Aspose.Words API การประมวลผลเอกสาร
description: เรียนรู้วิธีแทรกฟิลด์ที่ซ้อนกันในเอกสาร Word โดยใช้ Aspose.Words สำหรับ .NET พร้อมคำแนะนำทีละขั้นตอนของเรา เหมาะสำหรับนักพัฒนาที่ต้องการสร้างเอกสารอัตโนมัติ
type: docs
weight: 10
url: /th/net/working-with-fields/insert-nested-fields/
---
## การแนะนำ

คุณเคยพบว่าตัวเองจำเป็นต้องแทรกฟิลด์ที่ซ้อนกันในเอกสาร Word ของคุณโดยทางโปรแกรมหรือไม่? บางทีคุณอาจต้องการแสดงข้อความที่แตกต่างกันตามเงื่อนไขตามหมายเลขหน้า คุณโชคดี! บทช่วยสอนนี้จะแนะนำคุณตลอดขั้นตอนการแทรกฟิลด์ที่ซ้อนกันโดยใช้ Aspose.Words สำหรับ .NET มาดำน้ำกันเถอะ!

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเริ่ม มีบางสิ่งที่คุณต้องการ:

1.  Aspose.Words สำหรับ .NET: ตรวจสอบให้แน่ใจว่าคุณมีไลบรารี Aspose.Words สำหรับ .NET คุณสามารถดาวน์โหลดได้จาก[ที่นี่](https://releases.aspose.com/words/net/).
2. สภาพแวดล้อมการพัฒนา: IDE เช่น Visual Studio
3. ความรู้พื้นฐานของ C#: ความเข้าใจในภาษาการเขียนโปรแกรม C#

## นำเข้าเนมสเปซ

ขั้นแรก ตรวจสอบให้แน่ใจว่าได้นำเข้าเนมสเปซที่จำเป็นในโปรเจ็กต์ของคุณ เนมสเปซเหล่านี้มีคลาสที่คุณจะต้องโต้ตอบกับ Aspose.Words

```csharp
using Aspose.Words;
using Aspose.Words.Fields;
using Aspose.Words.HeaderFooter;
```

## ขั้นตอนที่ 1: เริ่มต้นเอกสาร

ขั้นตอนแรกคือการสร้างเอกสารใหม่และออบเจ็กต์ DocumentBuilder คลาส DocumentBuilder ช่วยในการสร้างและแก้ไขเอกสาร Word

```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENTS DIRECTORY";

// สร้างเอกสารและ DocumentBuilder
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## ขั้นตอนที่ 2: แทรกตัวแบ่งหน้า

ต่อไป เราจะแทรกตัวแบ่งหน้าสองสามหน้าลงในเอกสาร สิ่งนี้จะช่วยให้เราสามารถสาธิตฟิลด์ที่ซ้อนกันได้อย่างมีประสิทธิภาพ

```csharp
// แทรกตัวแบ่งหน้า
for (int i = 0; i < 5; i++)
{
    builder.InsertBreak(BreakType.PageBreak);
}
```

## ขั้นตอนที่ 3: ย้ายไปที่ส่วนท้าย

หลังจากใส่ตัวแบ่งหน้าแล้ว เราต้องย้ายไปที่ส่วนท้ายของเอกสาร นี่คือที่ที่เราจะแทรกฟิลด์ที่ซ้อนกันของเรา

```csharp
// ย้ายไปที่ส่วนท้าย
builder.MoveToHeaderFooter(HeaderFooterType.FooterPrimary);
```

## ขั้นตอนที่ 4: แทรกฟิลด์ที่ซ้อนกัน

ตอนนี้ เรามาแทรกฟิลด์ที่ซ้อนกัน เราจะใช้ฟิลด์ IF เพื่อแสดงข้อความตามเงื่อนไขตามหมายเลขหน้าปัจจุบัน

```csharp
// แทรกฟิลด์ที่ซ้อนกัน
Field field = builder.InsertField(@"IF ");
builder.MoveTo(field.Separator);
builder.InsertField("PAGE");
builder.Write(" <> ");
builder.InsertField("NUMPAGES");
builder.Write(" \"See next page\" \"Last page\" ");
```

ในขั้นตอนนี้ ขั้นแรกเราจะแทรกฟิลด์ IF จากนั้นย้ายไปยังตัวคั่น จากนั้นจึงแทรกฟิลด์ PAGE และ NUMPAGES ช่อง IF ตรวจสอบว่าหมายเลขหน้าปัจจุบัน (PAGE) ไม่เท่ากับจำนวนหน้าทั้งหมด (NUMPAGES) หากเป็นจริงจะแสดง “ดูหน้าถัดไป” ไม่เช่นนั้นจะแสดง “หน้าสุดท้าย”

## ขั้นตอนที่ 5: อัปเดตฟิลด์

สุดท้ายนี้ เราจะอัปเดตฟิลด์เพื่อให้แน่ใจว่าฟิลด์จะแสดงข้อความที่ถูกต้อง

```csharp
// อัพเดทสนามครับ.
field.Update();
```

## ขั้นตอนที่ 6: บันทึกเอกสาร

ขั้นตอนสุดท้ายคือการบันทึกเอกสารลงในไดเร็กทอรีที่คุณระบุ

```csharp
doc.Save(dataDir + "InsertNestedFields.docx");
```

## บทสรุป

และคุณก็ได้แล้ว! คุณได้แทรกฟิลด์ที่ซ้อนกันลงในเอกสาร Word สำเร็จโดยใช้ Aspose.Words สำหรับ .NET ไลบรารีอันทรงพลังนี้ทำให้การจัดการเอกสาร Word โดยทางโปรแกรมเป็นเรื่องง่ายอย่างเหลือเชื่อ ไม่ว่าคุณจะสร้างรายงาน สร้างเทมเพลต หรือทำให้เวิร์กโฟลว์เอกสารเป็นอัตโนมัติ Aspose.Words ก็พร้อมช่วยคุณ

## คำถามที่พบบ่อย

### ฟิลด์ที่ซ้อนกันในเอกสาร Word คืออะไร?
ฟิลด์ที่ซ้อนกันคือฟิลด์ที่มีฟิลด์อื่นอยู่ภายใน ช่วยให้เนื้อหาที่ซับซ้อนและมีเงื่อนไขในเอกสารมากขึ้น

### ฉันสามารถใช้ฟิลด์อื่นภายในฟิลด์ IF ได้หรือไม่
ได้ คุณสามารถซ้อนฟิลด์ต่างๆ เช่น DATE, TIME และ AUTHOR ภายในฟิลด์ IF เพื่อสร้างเนื้อหาแบบไดนามิกได้

### Aspose.Words สำหรับ .NET ฟรีหรือไม่
 Aspose.Words สำหรับ .NET เป็นไลบรารีเชิงพาณิชย์ แต่คุณสามารถรับ[ทดลองฟรี](https://releases.aspose.com/) เพื่อลองดู

### ฉันสามารถใช้ Aspose.Words กับภาษา .NET อื่นได้หรือไม่
ใช่ Aspose.Words รองรับภาษา .NET ทั้งหมด รวมถึง VB.NET และ F#

### ฉันจะหาเอกสารเพิ่มเติมเกี่ยวกับ Aspose.Words สำหรับ .NET ได้ที่ไหน
 คุณสามารถค้นหาเอกสารรายละเอียดได้[ที่นี่](https://reference.aspose.com/words/net/).