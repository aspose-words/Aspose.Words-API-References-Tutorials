---
title: แทรกฟิลด์ TOA โดยไม่ต้องใช้ตัวสร้างเอกสาร
linktitle: แทรกฟิลด์ TOA โดยไม่ต้องใช้ตัวสร้างเอกสาร
second_title: API การประมวลผลเอกสาร Aspose.Words
description: เรียนรู้วิธีแทรกฟิลด์ TOA โดยไม่ใช้ตัวสร้างเอกสารใน Aspose.Words สำหรับ .NET ปฏิบัติตามคำแนะนำทีละขั้นตอนของเราเพื่อจัดการการอ้างอิงทางกฎหมายอย่างมีประสิทธิภาพ
type: docs
weight: 10
url: /th/net/working-with-fields/insert-toafield-without-document-builder/
---
## การแนะนำ

การสร้างฟิลด์สารบัญ (Table of Authorities หรือ TOA) ในเอกสาร Word อาจดูเหมือนการต่อจิ๊กซอว์ที่ซับซ้อนเข้าด้วยกัน อย่างไรก็ตาม ด้วยความช่วยเหลือของ Aspose.Words สำหรับ .NET กระบวนการนี้จะราบรื่นและตรงไปตรงมามากขึ้น ในบทความนี้ เราจะแนะนำคุณเกี่ยวกับขั้นตอนต่างๆ ในการแทรกฟิลด์ TOA โดยไม่ต้องใช้ตัวสร้างเอกสาร ทำให้คุณจัดการการอ้างอิงและเอกสารอ้างอิงทางกฎหมายภายในเอกสาร Word ได้อย่างง่ายดาย

## ข้อกำหนดเบื้องต้น

ก่อนที่จะเริ่มบทช่วยสอน เรามาทำความเข้าใจสิ่งสำคัญที่คุณจำเป็นต้องมีกันก่อน:

-  Aspose.Words สำหรับ .NET: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้งเวอร์ชันล่าสุดแล้ว คุณสามารถดาวน์โหลดได้จาก[เว็บไซต์อาโพส](https://releases.aspose.com/words/net/).
- สภาพแวดล้อมการพัฒนา: IDE ที่เข้ากันได้กับ .NET เช่น Visual Studio
- ความรู้พื้นฐานเกี่ยวกับ C#: การทำความเข้าใจโครงสร้างและแนวคิดพื้นฐานของ C# จะเป็นประโยชน์
- ตัวอย่างเอกสาร Word: สร้างหรือเตรียมเอกสารตัวอย่างไว้ที่คุณต้องการแทรกฟิลด์ TOA

## นำเข้าเนมสเปซ

ในการเริ่มต้น คุณจะต้องนำเข้าเนมสเปซที่จำเป็นจากไลบรารี Aspose.Words การตั้งค่านี้ช่วยให้คุณเข้าถึงคลาสและวิธีการทั้งหมดที่จำเป็นสำหรับการจัดการเอกสารได้

```csharp
using System;
using Aspose.Words;
using Aspose.Words.Fields;
```

มาแบ่งกระบวนการออกเป็นขั้นตอนง่ายๆ ที่ทำตามได้ง่าย เราจะแนะนำคุณในแต่ละขั้นตอน โดยอธิบายว่าโค้ดแต่ละชิ้นทำหน้าที่อะไรและมีส่วนช่วยในการสร้างฟิลด์ TOA อย่างไร

## ขั้นตอนที่ 1: เริ่มต้นเอกสาร

 ขั้นแรกคุณต้องสร้างอินสแตนซ์ของ`Document` คลาส วัตถุนี้แสดงถึงเอกสาร Word ที่คุณกำลังทำงานอยู่

```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENT DIRECTORY";

Document doc = new Document();
```

โค้ดนี้ใช้สำหรับเริ่มต้นเอกสาร Word ใหม่ คุณอาจคิดว่าโค้ดนี้เป็นการสร้างพื้นที่ว่างสำหรับเพิ่มเนื้อหาลงไป

## ขั้นตอนที่ 2: สร้างและกำหนดค่าฟิลด์ TA

ต่อไปเราจะเพิ่มฟิลด์ TA (Table of Authorities) ฟิลด์นี้จะระบุรายการที่จะปรากฏใน TOA

```csharp
Paragraph para = new Paragraph(doc);

// เราต้องการแทรกฟิลด์ TA และ TOA ดังนี้:
// { TA \c 1 \l "ค่า 0" }
FieldTA fieldTA = (FieldTA) para.AppendField(FieldType.FieldTOAEntry, false);
fieldTA.EntryCategory = "1";
fieldTA.LongCitation = "Value 0";

doc.FirstSection.Body.AppendChild(para);
```

นี่คือรายละเอียด:
- Paragraph para = new Paragraph(doc);: สร้างย่อหน้าใหม่ภายในเอกสาร
-  FieldTA fieldTA = (FieldTA) para.AppendField(FieldType.FieldTOAEntry, false);: เพิ่มฟิลด์ TA ให้กับย่อหน้า ที่`FieldType.FieldTOAEntry` ระบุว่านี่คือฟิลด์รายการ TOA
- fieldTA.EntryCategory = "1";: กำหนดหมวดหมู่ของรายการ ซึ่งมีประโยชน์ในการจัดหมวดหมู่รายการประเภทต่างๆ
- fieldTA.LongCitation = "Value 0";: ระบุข้อความอ้างอิงแบบยาว นี่คือข้อความที่จะปรากฏใน TOA
- doc.FirstSection.Body.AppendChild(para);: ผนวกย่อหน้าที่มีฟิลด์ TA ลงในเนื้อหาของเอกสาร

## ขั้นตอนที่ 3: เพิ่มฟิลด์ TOA

ตอนนี้เราจะแทรกฟิลด์ TOA จริงที่คอมไพล์รายการ TA ทั้งหมดลงในตาราง

```csharp
para = new Paragraph(doc);

FieldToa fieldToa = (FieldToa) para.AppendField(FieldType.FieldTOA, false);
fieldToa.EntryCategory = "1";
doc.FirstSection.Body.AppendChild(para);
```

ในขั้นตอนนี้:
- FieldToa fieldToa = (FieldToa) para.AppendField(FieldType.FieldTOA, false);: เพิ่มเขตข้อมูล TOA ลงในย่อหน้า
- fieldToa.EntryCategory = "1";: กรองรายการเพื่อรวมเฉพาะรายการที่ถูกทำเครื่องหมายด้วยหมวดหมู่ "1" เท่านั้น

## ขั้นตอนที่ 4: อัปเดต TOA Field

หลังจากแทรกฟิลด์ TOA แล้ว คุณต้องอัปเดตเพื่อให้แน่ใจว่าแสดงรายการล่าสุด

```csharp
fieldToa.Update();
```

คำสั่งนี้จะรีเฟรชฟิลด์ TOA เพื่อให้แน่ใจว่ารายการที่ทำเครื่องหมายทั้งหมดจะแสดงในตารางอย่างถูกต้อง

## ขั้นตอนที่ 5: บันทึกเอกสาร

สุดท้าย ให้บันทึกเอกสารของคุณด้วยฟิลด์ TOA ที่เพิ่มเข้ามาใหม่

```csharp
doc.Save(dataDir + "WorkingWithFields.InsertTOAFieldWithoutDocumentBuilder.docx");
```

 บรรทัดโค้ดนี้จะบันทึกเอกสารไปยังไดเร็กทอรีที่ระบุ อย่าลืมแทนที่`"YOUR DOCUMENT DIRECTORY"` ด้วยเส้นทางจริงที่คุณต้องการบันทึกไฟล์ของคุณ

## บทสรุป

และแล้วคุณก็ทำได้! คุณได้เพิ่มฟิลด์ TOA ลงในเอกสาร Word สำเร็จแล้วโดยไม่ต้องใช้โปรแกรมสร้างเอกสาร เมื่อทำตามขั้นตอนเหล่านี้แล้ว คุณจะสามารถจัดการการอ้างอิงและสร้างตารางผู้มีอำนาจที่ครอบคลุมในเอกสารกฎหมายของคุณได้อย่างมีประสิทธิภาพ Aspose.Words สำหรับ .NET ช่วยให้กระบวนการนี้ราบรื่นและมีประสิทธิภาพ ช่วยให้คุณมีเครื่องมือในการจัดการงานเอกสารที่ซับซ้อนได้อย่างง่ายดาย

## คำถามที่พบบ่อย

### ฉันสามารถเพิ่มฟิลด์ TA หลายฟิลด์ที่มีหมวดหมู่ที่แตกต่างกันได้หรือไม่
 ใช่ คุณสามารถเพิ่มฟิลด์ TA หลายฟิลด์ที่มีหมวดหมู่ที่แตกต่างกันได้โดยการตั้งค่า`EntryCategory`ทรัพย์สินตามนั้น

### ฉันจะปรับแต่งรูปลักษณ์ของ TOA ได้อย่างไร?
คุณสามารถปรับแต่งลักษณะที่ปรากฏของ TOA ได้โดยการแก้ไขคุณสมบัติของฟิลด์ TOA เช่น การจัดรูปแบบรายการและป้ายหมวดหมู่

### สามารถอัพเดตฟิลด์ TOA โดยอัตโนมัติได้หรือไม่?
 ในขณะที่คุณสามารถอัปเดตฟิลด์ TOA ด้วยตนเองโดยใช้`Update` วิธีการ Aspose.Words ปัจจุบันไม่รองรับการอัปเดตอัตโนมัติในการเปลี่ยนแปลงเอกสาร

### ฉันสามารถเพิ่มฟิลด์ TA โดยโปรแกรมในส่วนเฉพาะของเอกสารได้หรือไม่
ใช่ คุณสามารถเพิ่มฟิลด์ TA ในตำแหน่งที่เจาะจงได้ โดยการแทรกเข้าไปในย่อหน้าหรือส่วนที่ต้องการ

### ฉันจะจัดการฟิลด์ TOA หลายฟิลด์ในเอกสารเดียวได้อย่างไร
 คุณสามารถจัดการฟิลด์ TOA หลายฟิลด์ได้โดยการกำหนดฟิลด์ที่แตกต่างกัน`EntryCategory` ค่าต่างๆ และทำให้แน่ใจว่าแต่ละฟิลด์ TOA กรองรายการตามหมวดหมู่ของมัน