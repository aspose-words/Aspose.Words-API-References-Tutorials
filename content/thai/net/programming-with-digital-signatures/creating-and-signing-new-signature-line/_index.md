---
title: การสร้างและการลงนามบรรทัดลายเซ็นใหม่
linktitle: การสร้างและการลงนามบรรทัดลายเซ็นใหม่
second_title: Aspose.Words API การประมวลผลเอกสาร
description: เรียนรู้วิธีสร้างและเซ็นลายเซ็นแบบดิจิทัลในเอกสาร Word โดยใช้ Aspose.Words สำหรับ .NET ด้วยบทช่วยสอนทีละขั้นตอนนี้ เหมาะสำหรับระบบอัตโนมัติด้านเอกสาร
type: docs
weight: 10
url: /th/net/programming-with-digital-signatures/creating-and-signing-new-signature-line/
---
## การแนะนำ

เฮ้! ดังนั้น คุณมีเอกสาร Word และคุณต้องเพิ่มบรรทัดลายเซ็นแล้วเซ็นชื่อแบบดิจิทัล ฟังดูยุ่งยากใช่ไหม? ไม่เลย! ขอบคุณ Aspose.Words สำหรับ .NET คุณสามารถบรรลุเป้าหมายนี้ได้อย่างราบรื่นโดยใช้โค้ดเพียงไม่กี่บรรทัด ในบทช่วยสอนนี้ เราจะแนะนำคุณตลอดกระบวนการทั้งหมดตั้งแต่การตั้งค่าสภาพแวดล้อมไปจนถึงการบันทึกเอกสารของคุณด้วยลายเซ็นใหม่ที่เอี่ยม พร้อม? มาดำน้ำกันเถอะ!

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะพูดถึงโค้ด โปรดตรวจสอบให้แน่ใจว่าคุณมีทุกสิ่งที่คุณต้องการ:
1.  Aspose.Words สำหรับ .NET - คุณทำได้[ดาวน์โหลดได้ที่นี่](https://releases.aspose.com/words/net/).
2. แนะนำให้ใช้สภาพแวดล้อมการพัฒนา .NET - Visual Studio
3. เอกสารที่ต้องเซ็น - สร้างเอกสาร Word แบบธรรมดาหรือใช้เอกสารที่มีอยู่
4.  ไฟล์ใบรับรอง - จำเป็นสำหรับลายเซ็นดิจิทัล คุณสามารถใช้ก`.pfx` ไฟล์.
5. รูปภาพสำหรับบรรทัดลายเซ็น - หรืออาจเป็นไฟล์รูปภาพสำหรับลายเซ็น

## นำเข้าเนมสเปซ

ขั้นแรก เราต้องนำเข้าเนมสเปซที่จำเป็น ขั้นตอนนี้มีความสำคัญเนื่องจากเป็นการตั้งค่าสภาพแวดล้อมสำหรับการใช้ฟังก์ชัน Aspose.Words

```csharp
using System;
using System.IO;
using Aspose.Words;
using Aspose.Words.Drawing;
using Aspose.Words.Saving;
using Aspose.Words.Signing;
```

## ขั้นตอนที่ 1: การตั้งค่าไดเร็กทอรีเอกสาร

ทุกโครงการต้องมีการเริ่มต้นที่ดี มาตั้งค่าเส้นทางไปยังไดเร็กทอรีเอกสารของคุณกัน นี่คือที่ที่เอกสารของคุณจะถูกบันทึกและเรียกค้น

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## ขั้นตอนที่ 2: การสร้างเอกสารใหม่

ตอนนี้เรามาสร้างเอกสาร Word ใหม่โดยใช้ Aspose.Words นี่จะเป็นผืนผ้าใบของเราที่เราเพิ่มบรรทัดลายเซ็น

```csharp
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## ขั้นตอนที่ 3: การแทรกบรรทัดลายเซ็น

 นี่คือจุดที่ความมหัศจรรย์เกิดขึ้น เราแทรกบรรทัดลายเซ็นลงในเอกสารของเราโดยใช้`DocumentBuilder` ระดับ.

```csharp
SignatureLine signatureLine = builder.InsertSignatureLine(new SignatureLineOptions()).SignatureLine;
```

## ขั้นตอนที่ 4: บันทึกเอกสารด้วยบรรทัดลายเซ็น

เมื่อบรรทัดลายเซ็นเข้าที่แล้ว เราจำเป็นต้องบันทึกเอกสาร นี่เป็นขั้นตอนกลางก่อนที่เราจะดำเนินการลงนามต่อไป

```csharp
doc.Save(dataDir + "SignDocuments.SignatureLine.docx");
```

## ขั้นตอนที่ 5: การตั้งค่าตัวเลือกการลงชื่อ

ตอนนี้ เรามาตั้งค่าตัวเลือกสำหรับการลงนามในเอกสารกันดีกว่า รวมถึงการระบุ ID บรรทัดลายเซ็นและรูปภาพที่จะใช้

```csharp
SignOptions signOptions = new SignOptions
{
    SignatureLineId = signatureLine.Id,
    SignatureLineImage = File.ReadAllBytes(dataDir + "Enhanced Windows MetaFile.emf")
};
```

## ขั้นตอนที่ 6: กำลังโหลดใบรับรอง

ลายเซ็นดิจิทัลจำเป็นต้องมีใบรับรอง ที่นี่เราโหลดไฟล์ใบรับรองที่จะใช้ในการลงนามในเอกสาร

```csharp
CertificateHolder certHolder = CertificateHolder.Create(dataDir + "morzal.pfx", "aw");
```

## ขั้นตอนที่ 7: การลงนามในเอกสาร

 นี่เป็นขั้นตอนสุดท้าย เราใช้`DigitalSignatureUtil`ชั้นเรียนเพื่อลงนามในเอกสาร เอกสารที่ลงนามแล้วจะถูกบันทึกด้วยชื่อใหม่

```csharp
DigitalSignatureUtil.Sign(dataDir + "SignDocuments.SignatureLine.docx",
    dataDir + "SignDocuments.NewSignatureLine.docx", certHolder, signOptions);
```

## บทสรุป

และคุณก็ได้แล้ว! ด้วยขั้นตอนเหล่านี้ คุณได้สร้างเอกสาร Word ใหม่ เพิ่มบรรทัดลายเซ็น และเซ็นชื่อแบบดิจิทัลโดยใช้ Aspose.Words สำหรับ .NET ได้สำเร็จ เป็นเครื่องมืออันทรงพลังที่ทำให้เอกสารอัตโนมัติเป็นเรื่องง่าย ไม่ว่าคุณจะจัดการกับสัญญา ข้อตกลง หรือเอกสารที่เป็นทางการใดๆ วิธีการนี้ช่วยให้มั่นใจได้ว่าเอกสารเหล่านั้นได้รับการลงนามและรับรองความถูกต้องอย่างปลอดภัย

## คำถามที่พบบ่อย

### ฉันสามารถใช้รูปแบบรูปภาพอื่นสำหรับบรรทัดลายเซ็นได้หรือไม่
ใช่ คุณสามารถใช้รูปแบบภาพต่างๆ เช่น PNG, JPG, BMP ฯลฯ

###  จำเป็นต้องใช้ก`.pfx` file for the certificate?
 ใช่ ก`.pfx` ไฟล์เป็นรูปแบบทั่วไปสำหรับการจัดเก็บข้อมูลการเข้ารหัสรวมถึงใบรับรองและคีย์ส่วนตัว

### ฉันสามารถเพิ่มบรรทัดลายเซ็นหลายบรรทัดในเอกสารเดียวได้หรือไม่
อย่างแน่นอน! คุณสามารถแทรกบรรทัดลายเซ็นได้หลายบรรทัดโดยทำซ้ำขั้นตอนการแทรกสำหรับแต่ละลายเซ็น

### จะทำอย่างไรถ้าฉันไม่มีใบรับรองดิจิทัล
คุณจะต้องได้รับใบรับรองดิจิทัลจากผู้ออกใบรับรองที่เชื่อถือได้ หรือสร้างใบรับรองโดยใช้เครื่องมือ เช่น OpenSSL

### ฉันจะตรวจสอบลายเซ็นดิจิทัลในเอกสารได้อย่างไร
คุณสามารถเปิดเอกสารที่ลงนามใน Word และไปที่รายละเอียดลายเซ็นเพื่อตรวจสอบความถูกต้องและความสมบูรณ์ของลายเซ็น