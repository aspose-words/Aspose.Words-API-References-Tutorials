---
title: การสร้างและการลงนามบรรทัดลายเซ็นใหม่
linktitle: การสร้างและการลงนามบรรทัดลายเซ็นใหม่
second_title: API การประมวลผลเอกสาร Aspose.Words
description: เรียนรู้วิธีการสร้างและลงนามดิจิทัลในบรรทัดลายเซ็นในเอกสาร Word โดยใช้ Aspose.Words สำหรับ .NET ด้วยบทช่วยสอนแบบทีละขั้นตอนนี้ เหมาะอย่างยิ่งสำหรับการสร้างเอกสารอัตโนมัติ
type: docs
weight: 10
url: /th/net/programming-with-digital-signatures/creating-and-signing-new-signature-line/
---
## การแนะนำ

สวัสดี! คุณมีเอกสาร Word แล้ว และคุณจำเป็นต้องเพิ่มบรรทัดลายเซ็นและลงนามในรูปแบบดิจิทัล ฟังดูยุ่งยากใช่ไหม? ไม่ใช่เรื่องยากเลย! ด้วย Aspose.Words สำหรับ .NET คุณสามารถทำได้อย่างราบรื่นด้วยโค้ดเพียงไม่กี่บรรทัด ในบทช่วยสอนนี้ เราจะพาคุณผ่านกระบวนการทั้งหมดตั้งแต่การตั้งค่าสภาพแวดล้อมไปจนถึงการบันทึกเอกสารด้วยลายเซ็นใหม่เอี่ยม พร้อมหรือยัง? มาเริ่มกันเลย!

## ข้อกำหนดเบื้องต้น

ก่อนที่จะเริ่มเขียนโค้ด เรามาตรวจสอบกันก่อนว่าคุณมีทุกสิ่งที่คุณต้องการแล้ว:
1.  Aspose.Words สำหรับ .NET - คุณสามารถ[ดาวน์โหลดได้ที่นี่](https://releases.aspose.com/words/net/).
2. สภาพแวดล้อมการพัฒนา .NET - Visual Studio ได้รับการแนะนำอย่างยิ่ง
3. เอกสารที่ต้องลงนาม - สร้างเอกสาร Word ง่ายๆ หรือใช้เอกสารที่มีอยู่แล้ว
4.  ไฟล์ใบรับรอง - จำเป็นสำหรับลายเซ็นดิจิทัล คุณสามารถใช้ไฟล์`.pfx` ไฟล์.
5. รูปภาพสำหรับบรรทัดลายเซ็น - ทางเลือกคือไฟล์รูปภาพสำหรับลายเซ็น

## นำเข้าเนมสเปซ

ขั้นแรก เราต้องนำเข้าเนมสเปซที่จำเป็น ขั้นตอนนี้มีความสำคัญมาก เนื่องจากเป็นการกำหนดสภาพแวดล้อมสำหรับการใช้ฟังก์ชัน Aspose.Words

```csharp
using System;
using System.IO;
using Aspose.Words;
using Aspose.Words.Drawing;
using Aspose.Words.Saving;
using Aspose.Words.Signing;
```

## ขั้นตอนที่ 1: การตั้งค่าไดเรกทอรีเอกสาร

ทุกโครงการต้องมีจุดเริ่มต้นที่ดี มาตั้งค่าเส้นทางไปยังไดเร็กทอรีเอกสารของคุณกัน นี่คือที่ที่เอกสารของคุณจะถูกบันทึกและเรียกค้น

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## ขั้นตอนที่ 2: การสร้างเอกสารใหม่

ตอนนี้เรามาสร้างเอกสาร Word ใหม่โดยใช้ Aspose.Words กัน ซึ่งจะเป็นพื้นที่สำหรับเพิ่มบรรทัดลายเซ็น

```csharp
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## ขั้นตอนที่ 3: การแทรกบรรทัดลายเซ็น

 นี่คือจุดที่เวทมนตร์เกิดขึ้น เราแทรกบรรทัดลายเซ็นลงในเอกสารของเราโดยใช้`DocumentBuilder` ระดับ.

```csharp
SignatureLine signatureLine = builder.InsertSignatureLine(new SignatureLineOptions()).SignatureLine;
```

## ขั้นตอนที่ 4: บันทึกเอกสารด้วยบรรทัดลายเซ็น

เมื่อบรรทัดลายเซ็นอยู่ในตำแหน่งแล้ว เราจะต้องบันทึกเอกสาร นี่เป็นขั้นตอนกลางก่อนที่จะดำเนินการลงนาม

```csharp
doc.Save(dataDir + "SignDocuments.SignatureLine.docx");
```

## ขั้นตอนที่ 5: การตั้งค่าตัวเลือกการลงนาม

ต่อไปเรามาตั้งค่าตัวเลือกในการลงนามในเอกสารกัน ซึ่งรวมถึงการระบุ ID บรรทัดลายเซ็นและรูปภาพที่จะใช้

```csharp
SignOptions signOptions = new SignOptions
{
    SignatureLineId = signatureLine.Id,
    SignatureLineImage = File.ReadAllBytes(dataDir + "Enhanced Windows MetaFile.emf")
};
```

## ขั้นตอนที่ 6: การโหลดใบรับรอง

ลายเซ็นดิจิทัลต้องมีใบรับรอง ที่นี่ เราจะโหลดไฟล์ใบรับรองที่จะใช้ในการลงนามในเอกสาร

```csharp
CertificateHolder certHolder = CertificateHolder.Create(dataDir + "morzal.pfx", "aw");
```

## ขั้นตอนที่ 7: การลงนามในเอกสาร

 นี่คือขั้นตอนสุดท้าย เราใช้`DigitalSignatureUtil`ชั้นเรียนที่จะลงนามในเอกสาร เอกสารที่ลงนามแล้วจะถูกบันทึกด้วยชื่อใหม่

```csharp
DigitalSignatureUtil.Sign(dataDir + "SignDocuments.SignatureLine.docx",
    dataDir + "SignDocuments.NewSignatureLine.docx", certHolder, signOptions);
```

## บทสรุป

และแล้วคุณก็ทำได้! ด้วยขั้นตอนเหล่านี้ คุณจะสามารถสร้างเอกสาร Word ใหม่ เพิ่มบรรทัดลายเซ็น และเซ็นชื่อแบบดิจิทัลโดยใช้ Aspose.Words สำหรับ .NET ได้สำเร็จ นับเป็นเครื่องมืออันทรงพลังที่ทำให้การจัดการเอกสารอัตโนมัติเป็นเรื่องง่าย ไม่ว่าคุณจะกำลังจัดการกับสัญญา ข้อตกลง หรือเอกสารทางการใดๆ ก็ตาม วิธีนี้จะช่วยให้มั่นใจได้ว่าเอกสารเหล่านั้นได้รับการเซ็นชื่อและรับรองอย่างปลอดภัย

## คำถามที่พบบ่อย

### ฉันสามารถใช้รูปแบบภาพอื่นสำหรับบรรทัดลายเซ็นได้หรือไม่
ใช่ คุณสามารถใช้รูปแบบภาพต่างๆ เช่น PNG, JPG, BMP เป็นต้น

###  จำเป็นต้องใช้หรือไม่`.pfx` file for the certificate?
 ใช่ครับ`.pfx` ไฟล์เป็นรูปแบบทั่วไปในการจัดเก็บข้อมูลการเข้ารหัสรวมทั้งใบรับรองและคีย์ส่วนตัว

### ฉันสามารถเพิ่มบรรทัดลายเซ็นหลายบรรทัดในเอกสารเดียวได้หรือไม่
แน่นอน! คุณสามารถแทรกบรรทัดลายเซ็นหลายบรรทัดได้โดยทำซ้ำขั้นตอนการแทรกสำหรับลายเซ็นแต่ละรายการ

### จะเกิดอะไรขึ้นหากฉันไม่มีใบรับรองดิจิทัล?
คุณจะต้องได้รับใบรับรองดิจิทัลจากผู้มีอำนาจออกใบรับรองที่เชื่อถือได้ หรือสร้างใบรับรองขึ้นมาโดยใช้เครื่องมือเช่น OpenSSL

### ฉันจะตรวจสอบลายเซ็นดิจิทัลในเอกสารได้อย่างไร
คุณสามารถเปิดเอกสารที่ลงนามใน Word และไปที่รายละเอียดลายเซ็นเพื่อตรวจสอบความถูกต้องและความสมบูรณ์ของลายเซ็น