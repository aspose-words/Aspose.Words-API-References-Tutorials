---
title: การลงนามในเอกสาร Word ที่เข้ารหัส
linktitle: การลงนามในเอกสาร Word ที่เข้ารหัส
second_title: API การประมวลผลเอกสาร Aspose.Words
description: เรียนรู้วิธีการลงนามในเอกสาร Word ที่เข้ารหัสโดยใช้ Aspose.Words สำหรับ .NET ด้วยคู่มือทีละขั้นตอนโดยละเอียดนี้ เหมาะสำหรับนักพัฒนา
type: docs
weight: 10
url: /th/net/programming-with-digital-signatures/signing-encrypted-document/
---
## การแนะนำ

เคยสงสัยไหมว่าจะลงนามในเอกสาร Word ที่เข้ารหัสได้อย่างไร วันนี้เราจะมาดูขั้นตอนนี้โดยใช้ Aspose.Words สำหรับ .NET เตรียมตัวให้พร้อมสำหรับบทช่วยสอนที่มีรายละเอียด น่าสนใจ และสนุกสนาน!

## ข้อกำหนดเบื้องต้น

ก่อนจะเจาะลึกโค้ด เรามาตรวจสอบก่อนว่าคุณมีทุกสิ่งที่คุณต้องการ:

1.  Aspose.Words สำหรับ .NET: ดาวน์โหลดและติดตั้งจาก[ที่นี่](https://releases.aspose.com/words/net/).
2. Visual Studio: ให้แน่ใจว่าคุณได้ติดตั้งแล้ว
3. ใบรับรองที่ถูกต้อง: คุณจะต้องมีไฟล์ใบรับรอง .pfx
4. ความรู้พื้นฐานเกี่ยวกับ C#: การทำความเข้าใจพื้นฐานจะทำให้บทช่วยสอนนี้ราบรื่นยิ่งขึ้น

## นำเข้าเนมสเปซ

ก่อนอื่นให้นำเข้าเนมสเปซที่จำเป็น ซึ่งมีความสำคัญต่อการเข้าถึงฟังก์ชันการทำงานของ Aspose.Words

```csharp
using System;
using Aspose.Words;
using Aspose.Words.Saving;
using Aspose.Words.DigitalSignatures;
```

ตอนนี้มาแบ่งกระบวนการออกเป็นขั้นตอนง่าย ๆ ที่จัดการได้

## ขั้นตอนที่ 1: การตั้งค่าโครงการของคุณ

ขั้นแรก ให้ตั้งค่าโปรเจ็กต์ Visual Studio ของคุณ เปิด Visual Studio และสร้างแอปพลิเคชันคอนโซล C# ใหม่ ตั้งชื่อให้สื่อความหมาย เช่น "SignEncryptedWordDoc"

## ขั้นตอนที่ 2: การเพิ่ม Aspose.Words ลงในโปรเจ็กต์ของคุณ

ขั้นตอนต่อไปคือการเพิ่ม Aspose.Words ลงในโปรเจ็กต์ของคุณ สามารถทำได้หลายวิธี แต่การใช้ NuGet ถือเป็นวิธีที่ง่ายที่สุด 

1. เปิดคอนโซลตัวจัดการแพ็กเกจ NuGet จากเครื่องมือ > ตัวจัดการแพ็กเกจ NuGet > คอนโซลตัวจัดการแพ็กเกจ
2. รันคำสั่งต่อไปนี้:

```powershell
Install-Package Aspose.Words
```

## ขั้นตอนที่ 3: การเตรียมไดเรกทอรีเอกสาร

คุณจะต้องมีไดเรกทอรีสำหรับจัดเก็บเอกสาร Word และใบรับรอง มาสร้างไดเรกทอรีกันเลย

1. สร้างไดเรกทอรีบนคอมพิวเตอร์ของคุณ เพื่อความเรียบง่าย เรียกว่า "DocumentDirectory"
2. วางเอกสาร Word ของคุณ (เช่น "Document.docx") และใบรับรอง .pfx ของคุณ (เช่น "morzal.pfx") ไว้ในไดเร็กทอรีนี้

## ขั้นตอนที่ 4: การเขียนโค้ด

 ตอนนี้มาเจาะลึกโค้ดกัน เปิด`Program.cs` ไฟล์และเริ่มต้นด้วยการตั้งค่าเส้นทางไปยังไดเร็กทอรีเอกสารของคุณและเริ่มต้นใช้งาน`SignOptions` พร้อมรหัสผ่านในการถอดรหัส

```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENTS DIRECTORY";
SignOptions signOptions = new SignOptions { DecryptionPassword = "decryptionPassword" };
```

## ขั้นตอนที่ 5: การโหลดใบรับรอง

 ขั้นตอนต่อไป โหลดใบรับรองของคุณโดยใช้`CertificateHolder`คลาสนี้จะต้องมีเส้นทางไปยังไฟล์ .pfx ของคุณและรหัสผ่านของใบรับรอง

```csharp
CertificateHolder certHolder = CertificateHolder.Create(dataDir + "morzal.pfx", "aw");
```

## ขั้นตอนที่ 6: การลงนามในเอกสาร

 สุดท้ายใช้`DigitalSignatureUtil.Sign` วิธีการลงนามในเอกสาร Word ที่เข้ารหัสของคุณ วิธีนี้ต้องใช้ไฟล์อินพุต ไฟล์เอาท์พุต ผู้ถือใบรับรอง และตัวเลือกการลงนาม

```csharp
DigitalSignatureUtil.Sign(
    dataDir + "Document.docx",
    dataDir + "DigitallySignedDocument.docx",
    certHolder,
    signOptions);
```

## ขั้นตอนที่ 7: การรันโค้ด

บันทึกไฟล์ของคุณและรันโครงการ หากทุกอย่างตั้งค่าอย่างถูกต้อง คุณควรเห็นเอกสารที่ลงนามของคุณในไดเร็กทอรีที่ระบุ

## บทสรุป

และแล้วคุณก็ทำได้สำเร็จ! คุณได้ลงนามในเอกสาร Word ที่เข้ารหัสสำเร็จแล้วโดยใช้ Aspose.Words สำหรับ .NET ด้วยไลบรารีอันทรงพลังนี้ การลงนามแบบดิจิทัลจึงกลายเป็นเรื่องง่าย แม้แต่สำหรับไฟล์ที่เข้ารหัส ขอให้สนุกกับการเขียนโค้ด!

## คำถามที่พบบ่อย

### ฉันสามารถใช้ใบรับรองประเภทอื่นได้หรือไม่
ใช่ Aspose.Words รองรับใบรับรองประเภทต่างๆ ตราบใดที่อยู่ในรูปแบบที่ถูกต้อง

### สามารถลงนามเอกสารหลายฉบับพร้อมกันได้หรือไม่?
แน่นอน! คุณสามารถวนซ้ำเอกสารต่างๆ และลงนามในแต่ละเอกสารได้ด้วยโปรแกรม

### จะเกิดอะไรขึ้นหากฉันลืมรหัสผ่านการถอดรหัส?
น่าเสียดาย หากไม่มีรหัสผ่านสำหรับการถอดรหัส คุณจะไม่สามารถลงนามในเอกสารได้

### ฉันสามารถเพิ่มลายเซ็นที่มองเห็นได้ลงในเอกสารได้หรือไม่
ใช่ Aspose.Words ช่วยให้คุณสามารถเพิ่มลายเซ็นดิจิทัลที่มองเห็นได้ด้วยเช่นกัน

### มีวิธีตรวจสอบลายเซ็นหรือไม่?
 ใช่คุณสามารถใช้`DigitalSignatureUtil.Verify` วิธีการตรวจสอบลายเซ็น