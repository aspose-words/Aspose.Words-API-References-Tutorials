---
title: การบันทึกหน้าการโทรกลับ
linktitle: การบันทึกหน้าการโทรกลับ
second_title: API การประมวลผลเอกสาร Aspose.Words
description: เรียนรู้การบันทึกแต่ละหน้าของเอกสาร Word เป็นรูปภาพ PNG แยกกันโดยใช้ Aspose.Words สำหรับ .NET ด้วยคำแนะนำทีละขั้นตอนโดยละเอียดของเรา
type: docs
weight: 10
url: /th/net/programming-with-imagesaveoptions/page-saving-callback/
---
## การแนะนำ

สวัสดี! คุณเคยรู้สึกจำเป็นต้องบันทึกแต่ละหน้าของเอกสาร Word เป็นรูปภาพแยกกันหรือไม่ บางทีคุณอาจต้องการแบ่งรายงานขนาดใหญ่เป็นภาพที่เข้าใจง่าย หรือบางทีคุณอาจต้องการสร้างภาพขนาดย่อเพื่อดูตัวอย่าง ไม่ว่าเหตุผลของคุณจะเป็นอย่างไร การใช้ Aspose.Words สำหรับ .NET จะทำให้ภารกิจนี้เป็นเรื่องง่าย ในคู่มือนี้ เราจะแนะนำคุณเกี่ยวกับขั้นตอนการตั้งค่าคอลแบ็กการบันทึกหน้าเพื่อบันทึกแต่ละหน้าของเอกสารเป็นรูปภาพ PNG แยกกัน มาเริ่มกันเลย!

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเริ่ม โปรดตรวจสอบให้แน่ใจว่าคุณมีสิ่งต่อไปนี้:

1.  Aspose.Words สำหรับ .NET: หากคุณยังไม่ได้ดาวน์โหลดและติดตั้งจาก[ที่นี่](https://releases.aspose.com/words/net/).
2. Visual Studio: เวอร์ชันใดก็ได้ แต่ฉันจะใช้ Visual Studio 2019 สำหรับคู่มือนี้
3. ความรู้พื้นฐานเกี่ยวกับ C#: คุณต้องมีความเข้าใจพื้นฐานเกี่ยวกับ C# จึงจะปฏิบัติตามได้

## นำเข้าเนมสเปซ

ขั้นแรก เราต้องนำเข้าเนมสเปซที่จำเป็น ซึ่งจะช่วยให้เราเข้าถึงคลาสและวิธีการที่จำเป็นได้โดยไม่ต้องพิมพ์เนมสเปซทั้งหมดทุกครั้ง

```csharp
using System;
using Aspose.Words;
using Aspose.Words.Saving;
```

## ขั้นตอนที่ 1: ตั้งค่าไดเรกทอรีเอกสารของคุณ

โอเค เริ่มต้นด้วยการกำหนดเส้นทางไปยังไดเร็กทอรีเอกสารของคุณ นี่คือที่ที่เอกสาร Word ที่คุณป้อนเข้าไปอยู่และที่ที่รูปภาพเอาต์พุตจะถูกบันทึก

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## ขั้นตอนที่ 2: โหลดเอกสารของคุณ

ต่อไปเราจะโหลดเอกสารที่คุณต้องการประมวลผล ตรวจสอบให้แน่ใจว่าเอกสารของคุณ ("Rendering.docx") อยู่ในไดเรกทอรีที่ระบุ

```csharp
Document doc = new Document(dataDir + "Rendering.docx");
```

## ขั้นตอนที่ 3: กำหนดค่าตัวเลือกการบันทึกภาพ

เราจำเป็นต้องกำหนดค่าตัวเลือกสำหรับการบันทึกรูปภาพ ในกรณีนี้ เราจะบันทึกหน้าเป็นไฟล์ PNG

```csharp
ImageSaveOptions imageSaveOptions = new ImageSaveOptions(SaveFormat.Png)
{
    PageSet = new PageSet(new PageRange(0, doc.PageCount - 1)),
    PageSavingCallback = new HandlePageSavingCallback()
};
```

 ที่นี่,`PageSet` ระบุช่วงของหน้าที่จะบันทึกและ`PageSavingCallback` ชี้ไปยังคลาสการโทรกลับแบบกำหนดเองของเรา

## ขั้นตอนที่ 4: นำการบันทึกหน้ากลับมาใช้งาน

ตอนนี้ เรามาใช้งานคลาสการโทรกลับที่จัดการวิธีการบันทึกแต่ละหน้ากัน

```csharp
private class HandlePageSavingCallback : IPageSavingCallback
{
    public void PageSaving(PageSavingArgs args)
    {
        args.PageFileName = string.Format(dataDir + "Page_{0}.png", args.PageIndex);
    }
}
```

 คลาสนี้ใช้การ`IPageSavingCallback` อินเทอร์เฟซและภายใน`PageSaving` วิธีการนี้เราจะกำหนดรูปแบบการตั้งชื่อให้กับแต่ละหน้าที่บันทึก

## ขั้นตอนที่ 5: บันทึกเอกสารเป็นรูปภาพ

สุดท้ายเราบันทึกเอกสารโดยใช้ตัวเลือกที่กำหนดค่าไว้

```csharp
doc.Save(dataDir + "WorkingWithImageSaveOptions.PageSavingCallback.png", imageSaveOptions);
```

## บทสรุป

และแล้วคุณก็ทำได้! คุณได้ตั้งค่าฟังก์ชันการบันทึกหน้าเพื่อบันทึกแต่ละหน้าของเอกสาร Word เป็นรูปภาพ PNG แยกกันโดยใช้ Aspose.Words สำหรับ .NET สำเร็จแล้ว เทคนิคนี้มีประโยชน์อย่างยิ่งสำหรับแอปพลิเคชันต่างๆ ตั้งแต่การสร้างตัวอย่างหน้าไปจนถึงการสร้างรูปภาพหน้าแต่ละหน้าสำหรับรายงาน 

สนุกกับการเขียนโค้ด!

## คำถามที่พบบ่อย

### ฉันสามารถบันทึกหน้าในรูปแบบอื่นนอกจาก PNG ได้หรือไม่  
 ใช่ คุณสามารถบันทึกหน้าเพจในรูปแบบต่างๆ เช่น JPEG, BMP และ TIFF โดยการเปลี่ยนแปลง`SaveFormat` ใน`ImageSaveOptions`.

### หากฉันต้องการบันทึกเฉพาะหน้าเฉพาะจะทำอย่างไร?  
 คุณสามารถระบุหน้าที่คุณต้องการบันทึกได้โดยการปรับ`PageSet` พารามิเตอร์ใน`ImageSaveOptions`.

### สามารถปรับแต่งคุณภาพของภาพได้หรือไม่?  
 แน่นอน! คุณสามารถตั้งค่าคุณสมบัติได้ เช่น`ImageSaveOptions.JpegQuality` เพื่อควบคุมคุณภาพของภาพผลลัพธ์

### ฉันจะจัดการเอกสารขนาดใหญ่ได้อย่างมีประสิทธิภาพได้อย่างไร  
สำหรับเอกสารขนาดใหญ่ ควรพิจารณาประมวลผลหน้าเป็นชุดเพื่อจัดการการใช้หน่วยความจำอย่างมีประสิทธิภาพ

### ฉันสามารถหาข้อมูลเพิ่มเติมเกี่ยวกับ Aspose.Words สำหรับ .NET ได้จากที่ใด  
 ตรวจสอบออก[เอกสารประกอบ](https://reference.aspose.com/words/net/) สำหรับคำแนะนำและตัวอย่างที่ครอบคลุม