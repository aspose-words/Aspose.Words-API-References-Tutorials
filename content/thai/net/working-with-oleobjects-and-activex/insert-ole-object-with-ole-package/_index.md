---
title: แทรกวัตถุ Ole ใน Word ด้วยแพ็คเกจ Ole
linktitle: แทรกวัตถุ Ole ใน Word ด้วยแพ็คเกจ Ole
second_title: Aspose.Words API การประมวลผลเอกสาร
description: เรียนรู้วิธีแทรกวัตถุ OLE ในเอกสาร Word โดยใช้ Aspose.Words สำหรับ .NET ปฏิบัติตามคำแนะนำทีละขั้นตอนโดยละเอียดของเราเพื่อฝังไฟล์ได้อย่างราบรื่น
type: docs
weight: 10
url: /th/net/working-with-oleobjects-and-activex/insert-ole-object-with-ole-package/
---
## การแนะนำ

หากคุณเคยต้องการฝังไฟล์ลงในเอกสาร Word แสดงว่าคุณมาถูกที่แล้ว ไม่ว่าจะเป็นไฟล์ ZIP, แผ่นงาน Excel หรือไฟล์ประเภทอื่นๆ การฝังลงในเอกสาร Word โดยตรงจะมีประโยชน์อย่างเหลือเชื่อ คิดว่ามันเหมือนกับการมีช่องลับในเอกสารของคุณที่คุณสามารถซ่อนสมบัติได้ทุกประเภท และวันนี้ เราจะมาอธิบายวิธีการดำเนินการนี้โดยใช้ Aspose.Words สำหรับ .NET พร้อมที่จะเป็นพ่อมด Word แล้วหรือยัง? มาดำน้ำกันเถอะ!

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเริ่ม ตรวจสอบให้แน่ใจว่าคุณมีสิ่งต่อไปนี้:

1. Aspose.Words for .NET: หากคุณยังไม่ได้ดาวน์โหลด ให้ดาวน์โหลดจาก[ที่นี่](https://releases.aspose.com/words/net/).
2. สภาพแวดล้อมการพัฒนา: Visual Studio หรือสภาพแวดล้อมการพัฒนา .NET อื่น ๆ
3. ความเข้าใจพื้นฐานเกี่ยวกับ C#: คุณไม่จำเป็นต้องเป็นผู้เชี่ยวชาญ แต่การรู้วิธีการใช้ C# จะช่วยได้
4. ไดเร็กทอรีเอกสาร: โฟลเดอร์ที่คุณสามารถจัดเก็บและเรียกค้นเอกสาร

## นำเข้าเนมสเปซ

ก่อนอื่น มาเรียงลำดับเนมสเปซของเรากันก่อน คุณต้องรวมเนมสเปซต่อไปนี้ในโครงการของคุณ:

```csharp
using System;
using System.IO;
using Aspose.Words;
using Aspose.Words.Drawing;
```

มาแบ่งสิ่งนี้ออกเป็นขั้นตอนเล็กๆ น้อยๆ เพื่อให้ง่ายต่อการปฏิบัติตาม

## ขั้นตอนที่ 1: ตั้งค่าเอกสารของคุณ

ลองจินตนาการว่าคุณเป็นศิลปินที่มีผืนผ้าใบว่างเปล่า ขั้นแรก เราต้องการผ้าใบเปล่าซึ่งเป็นเอกสาร Word ของเรา ต่อไปนี้เป็นวิธีการตั้งค่า:

```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสารของคุณ
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

รหัสนี้จะเริ่มต้นเอกสาร Word ใหม่และตั้งค่า DocumentBuilder ซึ่งเราจะใช้ในการแทรกเนื้อหาลงในเอกสารของเรา

## ขั้นตอนที่ 2: อ่านวัตถุ Ole ของคุณ

ต่อไป เรามาอ่านไฟล์ที่คุณต้องการฝังกัน คิดว่านี่เป็นการหยิบสมบัติที่คุณต้องการซ่อนไว้ในช่องลับของคุณ:

```csharp
byte[] bs = File.ReadAllBytes(dataDir + "Zip file.zip");
```

บรรทัดนี้จะอ่านไบต์ทั้งหมดจากไฟล์ ZIP ของคุณและจัดเก็บไว้ในอาร์เรย์ไบต์

## ขั้นตอนที่ 3: แทรกวัตถุ Ole

ตอนนี้มาถึงส่วนเวทย์มนตร์ เราจะฝังไฟล์ลงในเอกสาร Word ของเรา:

```csharp
using (Stream stream = new MemoryStream(bs))
{
    Shape shape = builder.InsertOleObject(stream, "Package", true, null);
    OlePackage olePackage = shape.OleFormat.OlePackage;
    olePackage.FileName = "filename.zip";
    olePackage.DisplayName = "displayname.zip";
}
```

 ที่นี่ เราสร้างสตรีมหน่วยความจำจากอาร์เรย์ไบต์และใช้`InsertOleObject` วิธีการฝังลงในเอกสาร นอกจากนี้เรายังตั้งชื่อไฟล์และชื่อที่แสดงสำหรับวัตถุที่ฝังอยู่

## ขั้นตอนที่ 4: บันทึกเอกสารของคุณ

สุดท้ายนี้ มาบันทึกผลงานชิ้นเอกของเรากัน:

```csharp
doc.Save(dataDir + "WorkingWithOleObjectsAndActiveX.InsertOleObjectWithOlePackage.docx");
```

วิธีนี้จะบันทึกเอกสารพร้อมกับไฟล์ที่ฝังอยู่ในไดเร็กทอรีที่ระบุ

## บทสรุป

และคุณก็ได้แล้ว! คุณได้ฝังวัตถุ OLE ลงในเอกสาร Word เรียบร้อยแล้วโดยใช้ Aspose.Words for .NET เหมือนกับการเพิ่มอัญมณีที่ซ่อนอยู่ในเอกสารของคุณซึ่งสามารถเปิดเผยได้ตลอดเวลา เทคนิคนี้มีประโยชน์อย่างเหลือเชื่อสำหรับการใช้งานที่หลากหลาย ตั้งแต่เอกสารทางเทคนิคไปจนถึงรายงานแบบไดนามิก 

## คำถามที่พบบ่อย

### ฉันสามารถฝังไฟล์ประเภทอื่นโดยใช้วิธีนี้ได้หรือไม่
ได้ คุณสามารถฝังไฟล์ได้หลายประเภท เช่น แผ่นงาน Excel, PDF และรูปภาพ

### ฉันต้องมีใบอนุญาตสำหรับ Aspose.Words หรือไม่
 ใช่ คุณต้องมีใบอนุญาตที่ถูกต้อง คุณจะได้รับ[ใบอนุญาตชั่วคราว](https://purchase.aspose.com/temporary-license/) สำหรับการประเมินผล

### ฉันจะกำหนดชื่อที่แสดงของวัตถุ OLE ได้อย่างไร
 คุณสามารถตั้งค่า`DisplayName` ทรัพย์สินของ`OlePackage` เพื่อปรับแต่งมัน

### Aspose.Words เข้ากันได้กับ .NET Core หรือไม่
ใช่ Aspose.Words รองรับทั้ง .NET Framework และ .NET Core

### ฉันสามารถแก้ไขวัตถุ OLE ที่ฝังอยู่ในเอกสาร Word ได้หรือไม่
ไม่ คุณไม่สามารถแก้ไขวัตถุ OLE ภายใน Word ได้โดยตรง คุณต้องเปิดมันในแอปพลิเคชันดั้งเดิม