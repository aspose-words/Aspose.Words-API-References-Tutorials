---
title: การเปรียบเทียบเอกสารเพื่อหาข้อแตกต่าง
linktitle: การเปรียบเทียบเอกสารเพื่อหาข้อแตกต่าง
second_title: API การประมวลผลเอกสาร Java ของ Aspose.Words
description: เรียนรู้วิธีเปรียบเทียบเอกสารเพื่อหาความแตกต่างโดยใช้ Aspose.Words ใน Java คำแนะนำทีละขั้นตอนของเราจะช่วยให้การจัดการเอกสารมีความแม่นยำ
type: docs
weight: 12
url: /th/java/document-merging/comparing-documents-for-differences/
---
## การแนะนำ

เคยสงสัยไหมว่าจะหาจุดแตกต่างระหว่างเอกสาร Word สองฉบับได้อย่างไร บางทีคุณอาจกำลังแก้ไขเอกสารหรือพยายามหาการเปลี่ยนแปลงที่ทำโดยผู้ร่วมงาน การเปรียบเทียบด้วยตนเองอาจน่าเบื่อและเกิดข้อผิดพลาดได้ แต่ด้วย Aspose.Words สำหรับ Java จะทำให้เป็นเรื่องง่าย! ไลบรารีนี้ช่วยให้คุณทำการเปรียบเทียบเอกสารโดยอัตโนมัติ เน้นการแก้ไข และรวมการเปลี่ยนแปลงได้อย่างง่ายดาย

## ข้อกำหนดเบื้องต้น

ก่อนที่จะเริ่มเขียนโค้ด ให้แน่ใจว่าคุณมีสิ่งต่อไปนี้พร้อมแล้ว:  
1. Java Development Kit (JDK) ติดตั้งอยู่บนระบบของคุณ  
2.  Aspose.Words สำหรับไลบรารี Java คุณสามารถ[ดาวน์โหลดได้ที่นี่](https://releases.aspose.com/words/java/).  
3. สภาพแวดล้อมการพัฒนาเช่น IntelliJ IDEA หรือ Eclipse  
4. ความคุ้นเคยเบื้องต้นกับการเขียนโปรแกรมภาษา Java  
5.  ใบอนุญาต Aspose ที่ถูกต้อง หากคุณไม่มี ให้ขอใบอนุญาต[ใบอนุญาตชั่วคราวที่นี่](https://purchase.aspose.com/temporary-license/).

## แพ็คเกจนำเข้า

ในการใช้ Aspose.Words คุณจะต้องนำเข้าคลาสที่จำเป็น ด้านล่างนี้คือคลาสที่จำเป็นในการนำเข้า:

```java
import com.aspose.words.*;
import java.util.Date;
```

ตรวจสอบให้แน่ใจว่าแพ็คเกจเหล่านี้ถูกเพิ่มไปยังโครงการของคุณอย่างถูกต้อง


ในหัวข้อนี้เราจะแบ่งกระบวนการออกเป็นขั้นตอนง่ายๆ


## ขั้นตอนที่ 1: ตั้งค่าเอกสารของคุณ

ในการเริ่มต้น คุณต้องมีเอกสารสองฉบับ ฉบับหนึ่งแสดงเอกสารต้นฉบับ และอีกฉบับแสดงเอกสารเวอร์ชันที่แก้ไขแล้ว วิธีสร้างเอกสารมีดังนี้

```java
Document doc1 = new Document();
DocumentBuilder builder = new DocumentBuilder(doc1);
builder.writeln("This is the original document.");

Document doc2 = new Document();
builder = new DocumentBuilder(doc2);
builder.writeln("This is the edited document.");
```

 การดำเนินการนี้จะสร้างเอกสารสองฉบับในหน่วยความจำที่มีเนื้อหาพื้นฐาน นอกจากนี้ คุณยังสามารถโหลดเอกสาร Word ที่มีอยู่แล้วได้โดยใช้`new Document("path/to/document.docx")`.


## ขั้นตอนที่ 2: ตรวจสอบการแก้ไขที่มีอยู่

การแก้ไขในเอกสาร Word แสดงถึงการเปลี่ยนแปลงที่ติดตาม ก่อนเปรียบเทียบ ตรวจสอบให้แน่ใจว่าเอกสารทั้งสองฉบับไม่มีการแก้ไขที่มีอยู่ก่อนหน้านี้:

```java
if (doc1.getRevisions().getCount() == 0 && doc2.getRevisions().getCount() == 0) {
    System.out.println("No revisions found. Proceeding with comparison...");
}
```

หากมีการแก้ไข คุณอาจต้องการยอมรับหรือปฏิเสธก่อนดำเนินการต่อ


## ขั้นตอนที่ 3: เปรียบเทียบเอกสาร

 ใช้`compare` วิธีการหาความแตกต่าง วิธีการนี้จะเปรียบเทียบเอกสารเป้าหมาย (`doc2`) พร้อมเอกสารต้นฉบับ (`doc1`-

```java
doc1.compare(doc2, "AuthorName", new Date());
```

ที่นี่:
- AuthorName คือชื่อของบุคคลที่ทำการเปลี่ยนแปลง
- วันที่คือเวลาประทับของการเปรียบเทียบ


## ขั้นตอนที่ 4: การแก้ไขกระบวนการ

เมื่อเปรียบเทียบแล้ว Aspose.Words จะสร้างการแก้ไขในเอกสารต้นฉบับ (`doc1`) มาวิเคราะห์การแก้ไขเหล่านี้กัน:

```java
for (Revision r : doc1.getRevisions()) {
    System.out.println("Revision type: " + r.getRevisionType());
    System.out.println("Node type: " + r.getParentNode().getNodeType());
    System.out.println("Changed text: " + r.getParentNode().getText());
}
```

ลูปนี้ให้ข้อมูลโดยละเอียดเกี่ยวกับการแก้ไขแต่ละครั้ง เช่น ประเภทของการเปลี่ยนแปลงและข้อความที่ได้รับผลกระทบ


## ขั้นตอนที่ 5: ยอมรับการแก้ไขทั้งหมด

หากคุณต้องการเอกสารต้นฉบับ (`doc1`) ให้ตรงกับเอกสารเป้าหมาย (`doc2`) ยอมรับการแก้ไขทั้งหมด:

```java
doc1.getRevisions().acceptAll();
```

 การอัพเดตนี้`doc1` เพื่อสะท้อนการเปลี่ยนแปลงทั้งหมดที่เกิดขึ้นใน`doc2`.


## ขั้นตอนที่ 6: บันทึกเอกสารที่อัปเดต

สุดท้ายให้บันทึกเอกสารที่อัพเดตลงในดิสก์:

```java
doc1.save("Document.Compare.docx");
```

เพื่อยืนยันการเปลี่ยนแปลง ให้โหลดเอกสารซ้ำและตรวจสอบว่าไม่มีการแก้ไขที่เหลืออยู่:

```java
doc1 = new Document("Document.Compare.docx");
if (doc1.getRevisions().getCount() == 0) {
    System.out.println("Documents are now identical.");
}
```


## ขั้นตอนที่ 7: ตรวจสอบความเท่าเทียมกันของเอกสาร

เพื่อให้แน่ใจว่าเอกสารเหมือนกัน ให้เปรียบเทียบข้อความ:

```java
if (doc1.getText().trim().equals(doc2.getText().trim())) {
    System.out.println("Documents are equal.");
}
```

หากข้อความตรงกัน ขอแสดงความยินดี คุณเปรียบเทียบและซิงโครไนซ์เอกสารสำเร็จแล้ว!


## บทสรุป

การเปรียบเทียบเอกสารไม่ใช่เรื่องยุ่งยากอีกต่อไปด้วย Aspose.Words สำหรับ Java ด้วยโค้ดเพียงไม่กี่บรรทัด คุณสามารถระบุความแตกต่าง ประมวลผลการแก้ไข และรับรองความสอดคล้องของเอกสาร ไม่ว่าคุณจะจัดการโครงการเขียนร่วมกันหรือตรวจสอบเอกสารทางกฎหมาย ฟีเจอร์นี้จะช่วยเปลี่ยนเกมได้

## คำถามที่พบบ่อย

### ฉันสามารถเปรียบเทียบเอกสารกับรูปภาพและตารางได้หรือไม่  
ใช่ Aspose.Words รองรับการเปรียบเทียบเอกสารที่ซับซ้อน รวมถึงเอกสารที่มีรูปภาพ ตาราง และการจัดรูปแบบ

### ฉันต้องมีใบอนุญาตเพื่อใช้ฟีเจอร์นี้หรือไม่?  
 ใช่ ต้องมีใบอนุญาตจึงจะใช้งานได้เต็มรูปแบบ รับ[ใบอนุญาตชั่วคราวที่นี่](https://purchase.aspose.com/temporary-license/).

### จะเกิดอะไรขึ้นหากมีการแก้ไขที่เกิดขึ้นก่อนหน้านี้?  
คุณจะต้องยอมรับหรือปฏิเสธก่อนที่จะเปรียบเทียบเอกสารเพื่อหลีกเลี่ยงความขัดแย้ง

### ฉันสามารถไฮไลท์การแก้ไขในเอกสารได้ไหม  
ใช่ Aspose.Words ช่วยให้คุณปรับแต่งวิธีแสดงการแก้ไขได้ เช่น การเน้นการเปลี่ยนแปลง

### คุณสมบัตินี้มีให้ใช้ในภาษาการเขียนโปรแกรมอื่นหรือไม่?  
ใช่ Aspose.Words รองรับหลายภาษา รวมถึง .NET และ Python