---
title: إلحاق نص مرجعي في مستند Word
linktitle: إلحاق نص مرجعي في مستند Word
second_title: Aspose.Words واجهة برمجة تطبيقات معالجة المستندات
description: تعرف على كيفية إلحاق نص بإشارة مرجعية في مستند Word باستخدام Aspose.Words لـ .NET باستخدام هذا الدليل التفصيلي خطوة بخطوة. مثالية للمطورين.
type: docs
weight: 10
url: /ar/net/programming-with-bookmarks/append-bookmarked-text/
---
## مقدمة

مرحبًا يا من هناك! هل سبق لك أن حاولت إلحاق نص من قسم ذي إشارة مرجعية في مستند Word ووجدت الأمر صعبًا؟ انت محظوظ! سيرشدك هذا البرنامج التعليمي خلال العملية باستخدام Aspose.Words for .NET. سنقوم بتقسيمها إلى خطوات بسيطة حتى تتمكن من المتابعة بسهولة. هيا بنا نتعمق ونضيف هذا النص الذي تم وضع إشارة مرجعية عليه مثل المحترفين!

## المتطلبات الأساسية

قبل أن نبدأ، دعونا نتأكد من أن لديك كل ما تحتاجه:

-  Aspose.Words for .NET: تأكد من تثبيته. إذا لم يكن الأمر كذلك، يمكنك[قم بتنزيله هنا](https://releases.aspose.com/words/net/).
- بيئة التطوير: أي بيئة تطوير .NET مثل Visual Studio.
- المعرفة الأساسية بـ C#: فهم مفاهيم برمجة C# الأساسية سيساعدك.
- مستند Word مع الإشارات المرجعية: مستند Word يحتوي على إشارات مرجعية، وسنستخدمه لإلحاق نص منه.

## استيراد مساحات الأسماء

أول الأشياء أولاً، فلنستورد مساحات الأسماء الضرورية. سيضمن ذلك أن لدينا جميع الأدوات التي نحتاجها في متناول أيدينا.

```csharp
using System;
using Aspose.Words;
using Aspose.Words.Importing;
```

دعونا نقسم المثال إلى خطوات تفصيلية.

## الخطوة 1: تحميل المستند وتهيئة المتغيرات

حسنًا، لنبدأ بتحميل مستند Word الخاص بنا وتهيئة المتغيرات التي سنحتاجها.

```csharp
// قم بتحميل المستندات المصدر والوجهة.
Document srcDoc = new Document("source.docx");
Document dstDoc = new Document("destination.docx");

// تهيئة مستورد المستندات.
NodeImporter importer = new NodeImporter(srcDoc, dstDoc, ImportFormatMode.KeepSourceFormatting);

// ابحث عن الإشارة المرجعية في المستند المصدر.
Bookmark srcBookmark = srcDoc.Range.Bookmarks["YourBookmarkName"];
```

## الخطوة 2: تحديد فقرات البداية والنهاية

الآن، دعونا نحدد الفقرات التي تبدأ فيها الإشارة المرجعية وتنتهي فيها. وهذا أمر بالغ الأهمية لأننا بحاجة إلى التعامل مع النص ضمن هذه الحدود.

```csharp
// هذه هي الفقرة التي تحتوي على بداية الإشارة المرجعية.
Paragraph startPara = (Paragraph)srcBookmark.BookmarkStart.ParentNode;

// هذه هي الفقرة التي تحتوي على نهاية الإشارة المرجعية.
Paragraph endPara = (Paragraph)srcBookmark.BookmarkEnd.ParentNode;

if (startPara == null || endPara == null)
    throw new InvalidOperationException("Parent of the bookmark start or end is not a paragraph, cannot handle this scenario yet.");
```

## الخطوة 3: التحقق من صحة أصل الفقرة

نحتاج إلى التأكد من أن فقرات البداية والنهاية لها نفس الأصل. هذا سيناريو بسيط لإبقاء الأمور واضحة.

```csharp
// نقتصر على سيناريو بسيط إلى حد معقول.
if (startPara.ParentNode != endPara.ParentNode)
    throw new InvalidOperationException("Start and end paragraphs have different parents, cannot handle this scenario yet.");
```

## الخطوة 4: تحديد العقدة للتوقف

بعد ذلك، نحتاج إلى تحديد العقدة التي سنتوقف عندها عن نسخ النص. ستكون هذه العقدة مباشرة بعد نهاية الفقرة.

```csharp
// نريد نسخ جميع الفقرات من فقرة البداية حتى (بما في ذلك) الفقرة النهاية،
// وبالتالي فإن العقدة التي نتوقف عندها هي واحدة بعد نهاية الفقرة.
Node endNode = endPara.NextSibling;
```

## الخطوة 5: إلحاق نص ذو إشارة مرجعية بالمستند الوجهة

أخيرًا، دعونا نتنقل عبر العقد من فقرة البداية إلى العقدة التي تلي الفقرة النهاية، ونلحقها بالمستند الوجهة.

```csharp
for (Node curNode = startPara; curNode != endNode; curNode = curNode.NextSibling)
{
    // يؤدي هذا إلى إنشاء نسخة من العقدة الحالية واستيرادها (مما يجعلها صالحة) في السياق
    // من وثيقة الوجهة. الاستيراد يعني تعديل الأنماط ومعرفات القائمة بشكل صحيح.
    Node newNode = importer.ImportNode(curNode, true);

    // قم بإلحاق العقدة المستوردة بالمستند الوجهة.
    dstDoc.FirstSection.Body.AppendChild(newNode);
}

// احفظ المستند الوجهة بالنص الملحق.
dstDoc.Save("appended_document.docx");
```

## خاتمة

وهناك لديك! لقد نجحت في إلحاق نص من قسم ذي إشارة مرجعية في مستند Word باستخدام Aspose.Words لـ .NET. هذه الأداة القوية تجعل معالجة المستندات أمرًا سهلاً، والآن لديك خدعة أخرى في جعبتك. ترميز سعيد!

## الأسئلة الشائعة

### هل يمكنني إلحاق نص من إشارات مرجعية متعددة دفعة واحدة؟
نعم، يمكنك تكرار العملية لكل إشارة مرجعية وإلحاق النص وفقًا لذلك.

### ماذا لو كانت فقرات البداية والنهاية لهما آباء مختلفين؟
يفترض المثال الحالي أن لديهم نفس الوالد. بالنسبة للآباء المختلفين، هناك حاجة إلى معالجة أكثر تعقيدًا.

### هل يمكنني الاحتفاظ بالتنسيق الأصلي للنص الملحق؟
 قطعاً! ال`ImportFormatMode.KeepSourceFormatting` يضمن الحفاظ على التنسيق الأصلي.

### هل من الممكن إلحاق نص بموضع معين في المستند الوجهة؟
نعم، يمكنك إلحاق النص بأي موضع عن طريق الانتقال إلى العقدة المطلوبة في المستند الوجهة.

### ماذا لو كنت بحاجة إلى إلحاق نص من إشارة مرجعية بقسم جديد؟
يمكنك إنشاء قسم جديد في المستند الوجهة وإلحاق النص هناك.