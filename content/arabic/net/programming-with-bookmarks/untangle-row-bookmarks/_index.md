---
title: فك تشابك الإشارات المرجعية في مستند Word
linktitle: فك تشابك الإشارات المرجعية في مستند Word
second_title: Aspose.Words واجهة برمجة تطبيقات معالجة المستندات
description: قم بفك تشابك الإشارات المرجعية للصفوف المتشابكة في مستندات Word الخاصة بك بسهولة باستخدام Aspose.Words for .NET. يرشدك هذا الدليل خلال عملية إدارة الإشارات المرجعية بشكل أكثر نظافة وأمانًا.
type: docs
weight: 10
url: /ar/net/programming-with-bookmarks/untangle-row-bookmarks/
---
## مقدمة

هل سبق لك أن واجهت موقفًا أدى فيه حذف صف في مستند Word بواسطة إشارة مرجعية إلى إفساد الإشارات المرجعية الأخرى في الصفوف المجاورة؟ يمكن أن يكون هذا محبطًا للغاية، خاصة عند التعامل مع جداول معقدة. ولحسن الحظ، يقدم Aspose.Words for .NET حلاً قويًا: فك تشابك الإشارات المرجعية للصفوف. 

سيرشدك هذا الدليل خلال عملية فك تشابك الإشارات المرجعية للصفوف في مستندات Word الخاصة بك باستخدام Aspose.Words for .NET. سنقوم بتقسيم الكود إلى خطوات سهلة الفهم ونشرح الغرض من كل وظيفة، مما يمكّنك من معالجة مشكلات الإشارات المرجعية المزعجة بثقة.

## المتطلبات الأساسية

قبل الغوص، ستحتاج إلى بعض الأشياء:

1.  Aspose.Words for .NET: توفر هذه المكتبة التجارية وظائف للعمل مع مستندات Word برمجيًا. 2. يمكنك تنزيل نسخة تجريبية مجانية من[رابط التحميل](https://releases.aspose.com/words/net/) أو شراء ترخيص من[يشتري](https://purchase.aspose.com/buy).
3. بيئة تطوير AC#: سيعمل Visual Studio أو أي برنامج C# IDE آخر بشكل مثالي.
4. مستند Word يحتوي على إشارات مرجعية للصفوف: سنستخدم نموذج مستند باسم "الإشارات المرجعية لعمود الجدول.docx" لأغراض العرض التوضيحي.

## استيراد مساحات الأسماء

تتضمن الخطوة الأولى استيراد مساحات الأسماء الضرورية إلى مشروع C# الخاص بك. توفر مساحات الأسماء هذه إمكانية الوصول إلى الفئات والوظائف التي سنستخدمها من Aspose.Words لـ .NET:

```csharp
using Aspose.Words;
using System;
```

## الخطوة 1: قم بتحميل مستند Word

نبدأ بتحميل مستند Word الذي يحتوي على الإشارات المرجعية للصفوف المتشابكة. ال`Document` يتعامل الفصل مع معالجة المستندات في Aspose.Words. إليك كيفية تحميل المستند:

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY"; // استبدل بموقع المستند الخاص بك
Document doc = new Document(dataDir + "Table column bookmarks.docx");
```

 تذكر أن تحل محل`"YOUR DOCUMENT DIRECTORY"` بالمسار الفعلي إلى ملف "Bookmarks.docx لعمود الجدول".

## الخطوة 2: فك تشابك الإشارات المرجعية

 هذا هو المكان الذي يحدث السحر! ال`Untangle` تعتني الوظيفة بفك تشابك الإشارات المرجعية للصف. دعونا نحلل وظائفها:

```csharp
private void Untangle(Document doc)
{
   foreach (Bookmark bookmark in doc.Range.Bookmarks)
   {
	   // احصل على الصف الأصلي لكل من الإشارة المرجعية ونهاية الإشارة المرجعية
	   Row row1 = (Row)bookmark.BookmarkStart.GetAncestor(typeof(Row));
	   Row row2 = (Row)bookmark.BookmarkEnd.GetAncestor(typeof(Row));

	   // تحقق مما إذا كانت الصفوف صالحة ومتجاورة
	   if (row1 != null && row2 != null && row1.NextSibling == row2)
		   // انقل نهاية الإشارة المرجعية إلى الفقرة الأخيرة من الخلية الأخيرة في الصف العلوي
		   row1.LastCell.LastParagraph.AppendChild(bookmark.BookmarkEnd);
   }
}
```

فيما يلي شرح خطوة بخطوة لما يفعله الكود:

 نقوم بالتكرار عبر جميع الإشارات المرجعية في المستند باستخدام ملف`foreach` حلقة.
بالنسبة لكل إشارة مرجعية، نقوم باسترداد الصف الأصلي لكل من بداية الإشارة المرجعية (`bookmark.BookmarkStart`) ونهاية الإشارة المرجعية (`bookmark.BookmarkEnd` ) باستخدام`GetAncestor` طريقة.
ثم نتحقق من العثور على كلا الصفين (`row1 != null`و`row2 != null`وإذا كانت صفوفًا متجاورة (`row1.NextSibling == row2`). وهذا يضمن أننا نقوم فقط بتعديل الإشارات المرجعية التي تمتد عبر الصفوف المجاورة.
في حالة استيفاء الشروط، نقوم بنقل عقدة نهاية الإشارة المرجعية إلى نهاية الفقرة الأخيرة في الخلية الأخيرة من الصف العلوي (`row1.LastCell.LastParagraph.AppendChild(bookmark.BookmarkEnd)`) فك تشابكها بشكل فعال.

## الخطوة 3: حذف الصف حسب الإشارة المرجعية

 الآن بعد أن أصبحت الإشارات المرجعية غير متشابكة، يمكننا حذف الصفوف بأمان باستخدام أسماء الإشارات المرجعية الخاصة بها. ال`DeleteRowByBookmark` تتولى الدالة هذه المهمة:

```csharp
private void DeleteRowByBookmark(Document doc, string bookmarkName)
{
   Bookmark bookmark = doc.Range.Bookmarks[bookmarkName];

   Row row = (Row)bookmark?.BookmarkStart.GetAncestor(typeof(Row));
   row?.Remove();
}
```

وفيما يلي تفصيل لهذه الوظيفة:

نحن نأخذ اسم الإشارة المرجعية (`bookmarkName`) كمدخل.
 نقوم باسترداد كائن الإشارة المرجعية المقابل باستخدام`doc.Range.Bookmarks[bookmarkName]`.
 نحصل بعد ذلك على الصف الأصلي للإشارة المرجعية التي نبدأ في استخدامها`GetAncestor` (مشابهه ل`Untangle` وظيفة).
أخيرًا، نتحقق من وجود الإشارة المرجعية والصف (`bookmark != null` و

## الخطوة 4: التحقق من فك التشابك

 بينما ال`Untangle`يجب أن تضمن الوظيفة سلامة الإشارات المرجعية الأخرى، ومن الممارسات الجيدة دائمًا التحقق منها. إليك كيفية التحقق مما إذا كانت عملية فك التشابك لم تحذف عن طريق الخطأ نهاية إشارة مرجعية أخرى:

```csharp
if (doc.Range.Bookmarks["ROW1"].BookmarkEnd == null)
   throw new Exception("Wrong, the end of the bookmark was deleted.");
```

يتحقق مقتطف الرمز هذا مما إذا كانت نهاية الإشارة المرجعية المسماة "ROW1" لا تزال موجودة بعد حذف الصف الذي يحتوي على الإشارة المرجعية "ROW2". إذا كانت فارغة، فسيتم طرح استثناء، مما يشير إلى وجود مشكلة في عملية فك التشابك. 

## الخطوة 5: احفظ المستند

 أخيرًا، بعد فك تشابك الإشارات المرجعية واحتمال حذف الصفوف، احفظ المستند المعدل باستخدام الملف`Save` طريقة:

```csharp
doc.Save(dataDir + "WorkingWithBookmarks.UntangleRowBookmarks.docx");
```

يؤدي هذا إلى حفظ المستند مع الإشارات المرجعية غير المتشابكة وأي صفوف محذوفة تحت اسم ملف جديد "WorkingWithBookmarks.UntangleRowBookmarks.docx". 

## خاتمة

 باتباع هذه الخطوات والاستفادة من`Untangle`وظيفة، يمكنك فك تشابك الإشارات المرجعية للصف بشكل فعال في مستندات Word الخاصة بك باستخدام Aspose.Words for .NET. وهذا يضمن أن حذف الصفوف حسب الإشارات المرجعية لا يسبب عواقب غير مقصودة مع الإشارات المرجعية الأخرى في الصفوف المجاورة. تذكر أن تحل محل العناصر النائبة مثل`"YOUR DOCUMENT DIRECTORY"` مع المسارات الفعلية وأسماء الملفات.

## الأسئلة الشائعة

### هل Aspose.Words لـ .NET مجاني؟

 Aspose.Words for .NET هي مكتبة تجارية تتوفر بها نسخة تجريبية مجانية. يمكنك تنزيله من[رابط التحميل](https://releases.aspose.com/words/net/).

### هل يمكنني فك تشابك الإشارات المرجعية يدويًا في Word؟

على الرغم من أن ذلك ممكن من الناحية الفنية، إلا أن فك تشابك الإشارات المرجعية يدويًا في Word يمكن أن يكون مملاً وعرضة للأخطاء. يقوم Aspose.Words for .NET بأتمتة هذه العملية، مما يوفر لك الوقت والجهد.

###  ماذا يحدث إذا`Untangle` function encounters an error?

يتضمن الكود معالج الاستثناء الذي يطرح استثناءً إذا أدت عملية فك التشابك عن طريق الخطأ إلى حذف نهاية إشارة مرجعية أخرى. يمكنك تخصيص معالجة الأخطاء هذه لتناسب احتياجاتك المحددة.

### هل يمكنني استخدام هذا الرمز لفك الإشارات المرجعية عبر الصفوف غير المتجاورة؟

حاليًا، يركز الكود على فك تشابك الإشارات المرجعية التي تمتد عبر الصفوف المجاورة. قد يتطلب تعديل التعليمات البرمجية للتعامل مع الصفوف غير المتجاورة منطقًا إضافيًا لتحديد تلك السيناريوهات ومعالجتها.

### هل هناك أي قيود لاستخدام هذا النهج؟

يفترض هذا الأسلوب أن الإشارات المرجعية محددة جيدًا داخل خلايا الجدول. إذا تم وضع الإشارات المرجعية خارج الخلايا أو في مواقع غير متوقعة، فقد لا تعمل عملية فك التشابك على النحو المنشود.