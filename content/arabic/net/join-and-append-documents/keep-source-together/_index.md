---
title: إبقاء الطاولة متماسكة
linktitle: إبقاء الطاولة متماسكة
second_title: واجهة برمجة تطبيقات معالجة المستندات Aspose.Words
description: تعرف على كيفية منع الجداول من التعطل عبر الصفحات باستخدام Aspose.Words for .NET من خلال هذا الدليل خطوة بخطوة. تأكد من أن مستندات Word أنيقة وذات مظهر احترافي
type: docs
weight: 10
url: /ar/net/join-and-append-documents/keep-source-together/
---
## مقدمة

تُعد الجداول جزءًا أساسيًا من العديد من مستندات Word، ولكن في بعض الأحيان، قد تواجه موقفًا حيث ينقسم الجدول عبر صفحتين. يمكن أن يؤدي هذا إلى تعطيل تدفق المستند والتأثير على قابليته للقراءة. ألن يكون من الرائع أن تكون هناك طريقة للاحتفاظ بالجدول بأكمله معًا في صفحة واحدة؟ حسنًا، مع Aspose.Words for .NET، يوجد حل سهل لهذه المشكلة! في هذا البرنامج التعليمي، سنشرح كيفية منع الجداول من الانقسام عبر الصفحات، مما يضمن أن يبدو مستندك أنيقًا واحترافيًا.

## المتطلبات الأساسية

قبل أن ننتقل إلى البرنامج التعليمي، دعنا نتأكد من أن لديك كل ما تحتاجه لمتابعته بسلاسة.

### Aspose.Words لمكتبة .NET

أولاً، ستحتاج إلى تثبيت Aspose.Words for .NET. هذه هي المكتبة القوية التي تتيح لك العمل مع مستندات Word برمجيًا.

- [تنزيل Aspose.Words لـ .NET](https://releases.aspose.com/words/net/)

### بيئة التطوير

يجب أن يكون لديك بيئة تطوير مهيأة لتشغيل كود C#، مثل:

- Visual Studio (أي إصدار حديث)
- .NET Framework 2.0 أو أحدث

### مستند Word يحتوي على جدول

 ستحتاج إلى مستند Word يحتوي على جدول. في هذا البرنامج التعليمي، سنعمل مع مستند نموذجي يسمى`"Table spanning two pages.docx"`يحتوي هذا الملف على جدول يمتد حاليًا عبر صفحتين.

### رخصة مؤقتة (اختياري)

 على الرغم من أن Aspose.Words يأتي مع نسخة تجريبية مجانية، فقد ترغب في استخدام[رخصة مؤقتة](https://purchase.aspose.com/temporary-license/) لإطلاق العنان للإمكانات الكاملة للمكتبة.

## استيراد الحزم

قبل كتابة أي كود، نحتاج إلى استيراد المساحات الأساسية اللازمة للعمل مع Aspose.Words لـ .NET. أضف الواردات التالية في أعلى ملف الكود الخاص بك:

```csharp
using Aspose.Words;
using Aspose.Words.Tables;
```

 تتيح لك هذه المساحات الاسمية الوصول إلى فئات مثل`Document`, `Table`, `Cell`، وغيرها التي سنستخدمها في هذا البرنامج التعليمي.

## الخطوة 1: تحميل المستند

 أول شيء يتعين علينا القيام به هو تحميل مستند Word الذي يحتوي على الجدول. لهذا، سنستخدم`Document` فئة من Aspose.Words. تتيح لك هذه الفئة فتح ملفات Word ومعالجتها برمجيًا.

```csharp
// المسار إلى دليل المستندات.
string dataDir = "YOUR DOCUMENTS DIRECTORY";

Document doc = new Document(dataDir + "Table spanning two pages.docx");
```

 في مقتطف التعليمات البرمجية هذا، نحدد موقع مستندنا. استبدل`"YOUR DOCUMENTS DIRECTORY"` مع الدليل الفعلي الذي يتم تخزين مستندك فيه.

## الخطوة 2: الوصول إلى الجدول

بمجرد تحميل المستند، فإن الخطوة التالية هي الوصول إلى الجدول الذي نريد الاحتفاظ به معًا. في هذا المثال، نفترض أن الجدول هو أول جدول في المستند.

```csharp
Table table = (Table) doc.GetChild(NodeType.Table, 0, true);
```

 يجد هذا السطر من التعليمات البرمجية الجدول الأول في المستند.`GetChild` تسترجع الطريقة نوعًا معينًا من العقد، والذي في هذه الحالة هو`NodeType.Table` . ال`0` يشير إلى أننا نريد الجدول الأول، و`true`يضمن العلم أننا نقوم بالبحث بشكل متكرر عبر جميع العقد الفرعية.

## الخطوة 3: تكرار خلايا الجدول

الآن، نحتاج إلى تكرار كل خلية في الجدول. نظرًا لأن الجدول يحتوي على عدة صفوف وكل صف يحتوي على عدة خلايا، فسنقوم بالتكرار عبر كل خلية والتأكد من عدم تعطلها عبر الصفحات.

```csharp
foreach (Cell cell in table.GetChildNodes(NodeType.Cell, true))
{
    cell.EnsureMinimum();
```

 هنا،`GetChildNodes` يقوم باسترجاع جميع الخلايا الموجودة في الجدول، ونقوم بالتكرار عبر كل منها.`EnsureMinimum()` تتأكد الطريقة من أن كل خلية تحتوي على فقرة واحدة على الأقل، حيث أن الخلية الفارغة قد تسبب مشاكل لاحقًا.

## الخطوة 4: تعيين خاصية KeepWithNext

 لمنع الجدول من الانهيار عبر الصفحات، نحتاج إلى ضبط`KeepWithNext` خاصية لكل فقرة داخل الجدول. تضمن هذه الخاصية بقاء الفقرة مع الفقرة التالية، مما يمنع بشكل فعال فواصل الصفحات بينهما.

```csharp
    foreach (Paragraph para in cell.Paragraphs)
        if (!(cell.ParentRow.IsLastRow && para.IsEndOfCell))
            para.ParagraphFormat.KeepWithNext = true;
```

 تتحقق هذه الحلقة من كل فقرة داخل كل خلية. يضمن الشرط عدم تطبيق`KeepWithNext`الخاصية إلى الفقرة الأخيرة في الصف الأخير. وإلا فلن يكون للخاصية أي تأثير نظرًا لعدم وجود فقرة تالية.

## الخطوة 5: احفظ المستند

 وأخيرا، بعد تطبيق`KeepWithNext` الخاصية، نحتاج إلى حفظ المستند المعدل.

```csharp
doc.Save(dataDir + "WorkingWithTables.KeepTableTogether.docx");
```

يحفظ هذا السطر المستند المحدث باسم جديد، مع الحفاظ على الملف الأصلي. يمكنك الآن فتح الملف الناتج ورؤية أن الجدول لم يعد مقسمًا إلى صفحتين!

## خاتمة

والآن، إليك الحل! باتباع هذه الخطوات البسيطة، يمكنك بسهولة منع الجداول من التعطل عبر الصفحات في مستندات Word باستخدام Aspose.Words for .NET. سواء كنت تعمل على تقارير أو عقود أو مستندات أخرى، فإن الحفاظ على الجداول سليمة يضمن مظهرًا أكثر أناقة واحترافية.

تكمن روعة Aspose.Words في مرونته وسهولة استخدامه، مما يسمح لك بمعالجة مستندات Word برمجيًا دون الحاجة إلى تثبيت Microsoft Word على جهازك. الآن بعد أن أتقنت كيفية الاحتفاظ بالجداول معًا، استكشف الميزات الأخرى للمكتبة لرفع مهارات معالجة المستندات لديك إلى المستوى التالي!

## الأسئلة الشائعة

### لماذا لا يزال الجدول الخاص بي يتقطع عبر الصفحات بعد استخدام هذا الكود؟

 إذا كان الجدول الخاص بك لا يزال ينكسر، فتأكد من تطبيق`KeepWithNext` الخاصية بشكل صحيح. تأكد مرة أخرى من تعيين هذه الخاصية في جميع الفقرات باستثناء الفقرة الأخيرة في كل خلية.

### هل يمكنني الاحتفاظ فقط بصفوف محددة معًا؟

 نعم، يمكنك تطبيقه بشكل انتقائي`KeepWithNext` يمكنك تخصيص الخاصية لصفوف أو فقرات محددة داخل الجدول للتحكم في الأجزاء التي يجب أن تبقى معًا.

### هل تعمل هذه الطريقة مع الجداول الكبيرة؟

بالنسبة للجداول الكبيرة جدًا، قد يقوم Word بتقسيمها عبر الصفحات إذا لم تكن هناك مساحة كافية لاستيعاب الجدول بالكامل في صفحة واحدة. فكر في تعديل تنسيق الجدول أو الهوامش لاستيعاب الجداول الأكبر حجمًا.

### هل يمكنني استخدام هذه الطريقة مع تنسيقات المستندات الأخرى؟

نعم! يدعم Aspose.Words for .NET العديد من التنسيقات مثل DOC وDOCX وPDF وغيرها. تعمل نفس الطريقة على جميع التنسيقات التي تدعم الجداول.

### هل Aspose.Words for .NET مكتبة مجانية؟

 يقدم Aspose.Words for .NET إصدارًا تجريبيًا مجانيًا، ولكن للوصول الكامل إلى جميع الميزات، ستحتاج إلى شراء ترخيص. يمكنك استكشاف خيارات الترخيص على[صفحة شراء Aspose](https://purchase.aspose.com/buy).