---
title: إنشاء وتوقيع خط التوقيع الجديد
linktitle: إنشاء وتوقيع خط التوقيع الجديد
second_title: Aspose.Words واجهة برمجة تطبيقات معالجة المستندات
description: تعرف على كيفية إنشاء سطر توقيع وتوقيعه رقميًا في مستند Word باستخدام Aspose.Words لـ .NET من خلال هذا البرنامج التعليمي خطوة بخطوة. مثالي لأتمتة المستندات.
type: docs
weight: 10
url: /ar/net/programming-with-digital-signatures/creating-and-signing-new-signature-line/
---
## مقدمة

مرحبًا يا من هناك! إذن، لديك مستند Word وتحتاج إلى إضافة سطر توقيع ثم التوقيع عليه رقميًا. يبدو الأمر صعبا؟ مُطْلَقاً! بفضل Aspose.Words for .NET، يمكنك تحقيق ذلك بسلاسة باستخدام بضعة أسطر فقط من التعليمات البرمجية. في هذا البرنامج التعليمي، سنرشدك خلال العملية بأكملها بدءًا من إعداد بيئتك وحتى حفظ مستندك بتوقيع جديد لامع. مستعد؟ دعونا الغوص في!

## المتطلبات الأساسية

قبل أن ننتقل إلى الكود، دعونا نتأكد من أن لديك كل ما تحتاجه:
1.  Aspose.Words لـ .NET - يمكنك ذلك[قم بتنزيله هنا](https://releases.aspose.com/words/net/).
2. بيئة تطوير .NET - يوصى بشدة باستخدام Visual Studio.
3. مستند للتوقيع - قم بإنشاء مستند Word بسيط أو استخدم مستندًا موجودًا.
4.  ملف الشهادة - هذا مطلوب للتوقيعات الرقمية. يمكنك استخدام أ`.pfx` ملف.
5. صور لخط التوقيع - بشكل اختياري، ملف صورة للتوقيع.

## استيراد مساحات الأسماء

أولاً، نحتاج إلى استيراد مساحات الأسماء الضرورية. تعتبر هذه الخطوة حاسمة لأنها تهيئ البيئة اللازمة لاستخدام وظائف Aspose.Words.

```csharp
using System;
using System.IO;
using Aspose.Words;
using Aspose.Words.Drawing;
using Aspose.Words.Saving;
using Aspose.Words.Signing;
```

## الخطوة 1: إعداد دليل المستندات

كل مشروع يحتاج إلى بداية جيدة. لنقم بإعداد المسار إلى دليل المستندات الخاص بك. هذا هو المكان الذي سيتم فيه حفظ المستندات الخاصة بك واسترجاعها.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## الخطوة 2: إنشاء مستند جديد

الآن، لنقم بإنشاء مستند Word جديد باستخدام Aspose.Words. ستكون هذه اللوحة القماشية الخاصة بنا حيث نضيف سطر التوقيع.

```csharp
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## الخطوة 3: إدخال سطر التوقيع

 هذا هو المكان الذي يحدث فيه السحر. نقوم بإدراج سطر التوقيع في وثيقتنا باستخدام`DocumentBuilder` فصل.

```csharp
SignatureLine signatureLine = builder.InsertSignatureLine(new SignatureLineOptions()).SignatureLine;
```

## الخطوة 4: حفظ المستند بسطر التوقيع

بمجرد وضع سطر التوقيع، نحتاج إلى حفظ المستند. وهذه خطوة وسيطة قبل الشروع في التوقيع عليها.

```csharp
doc.Save(dataDir + "SignDocuments.SignatureLine.docx");
```

## الخطوة 5: إعداد خيارات التسجيل

الآن، لنقم بإعداد الخيارات لتوقيع المستند. يتضمن ذلك تحديد معرف سطر التوقيع والصورة المراد استخدامها.

```csharp
SignOptions signOptions = new SignOptions
{
    SignatureLineId = signatureLine.Id,
    SignatureLineImage = File.ReadAllBytes(dataDir + "Enhanced Windows MetaFile.emf")
};
```

## الخطوة 6: تحميل الشهادة

تتطلب التوقيعات الرقمية شهادة. هنا، نقوم بتحميل ملف الشهادة الذي سيتم استخدامه لتوقيع المستند.

```csharp
CertificateHolder certHolder = CertificateHolder.Create(dataDir + "morzal.pfx", "aw");
```

## الخطوة 7: توقيع الوثيقة

 هذه هي الخطوة النهائية. نحن نستخدم`DigitalSignatureUtil`الصف لتوقيع الوثيقة. يتم حفظ المستند الموقع باسم جديد.

```csharp
DigitalSignatureUtil.Sign(dataDir + "SignDocuments.SignatureLine.docx",
    dataDir + "SignDocuments.NewSignatureLine.docx", certHolder, signOptions);
```

## خاتمة

وهنا لديك! من خلال هذه الخطوات، تكون قد نجحت في إنشاء مستند Word جديد وإضافة سطر توقيع وتوقيعه رقميًا باستخدام Aspose.Words for .NET. إنها أداة قوية تجعل أتمتة المستندات أمرًا سهلاً. سواء كنت تتعامل مع عقود أو اتفاقيات أو أي مستندات رسمية، فإن هذه الطريقة تضمن توقيعها ومصادقتها بشكل آمن.

## الأسئلة الشائعة

### هل يمكنني استخدام تنسيقات صور أخرى لسطر التوقيع؟
نعم، يمكنك استخدام تنسيقات الصور المختلفة مثل PNG، JPG، BMP، إلخ.

###  هل من الضروري استخدام أ`.pfx` file for the certificate?
 نعم أ`.pfx` الملف هو تنسيق شائع لتخزين معلومات التشفير بما في ذلك الشهادات والمفاتيح الخاصة.

### هل يمكنني إضافة أسطر توقيع متعددة في مستند واحد؟
قطعاً! يمكنك إدراج أسطر توقيع متعددة عن طريق تكرار خطوة الإدراج لكل توقيع.

### ماذا لو لم يكن لدي شهادة رقمية؟
ستحتاج إلى الحصول على شهادة رقمية من مرجع مصدق موثوق به أو إنشاء واحدة باستخدام أدوات مثل OpenSSL.

### كيف يمكنني التحقق من التوقيع الرقمي في المستند؟
يمكنك فتح المستند الموقع في Word والانتقال إلى تفاصيل التوقيع للتحقق من صحة التوقيع وسلامته.