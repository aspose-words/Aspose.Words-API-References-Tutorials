---
title: Создание оглавления в Aspose.Words для Java
linktitle: Создание оглавления
second_title: API обработки Java-документов Aspose.Words
description: Узнайте, как создавать и настраивать оглавление (TOC) с помощью Aspose.Words для Java. Создавайте организованные и профессиональные документы без особых усилий.
type: docs
weight: 21
url: /ru/java/document-manipulation/generating-table-of-contents/
---

## Введение в создание оглавления в Aspose.Words для Java

В этом уроке мы познакомим вас с процессом создания оглавления (TOC) с помощью Aspose.Words для Java. TOC — важнейшая функция для создания организованных документов. Мы расскажем, как настроить внешний вид и макет оглавления.

## Предварительные условия

Прежде чем начать, убедитесь, что Aspose.Words for Java установлен и настроен в вашем проекте Java.

## Шаг 1. Создайте новый документ

Для начала давайте создадим новый документ для работы.

```java
Document doc = new Document();
```

## Шаг 2. Настройте стили содержания

Чтобы настроить внешний вид оглавления, вы можете изменить связанные с ним стили. В этом примере мы выделим записи оглавления первого уровня жирным шрифтом.

```java
doc.getStyles().getByStyleIdentifier(StyleIdentifier.TOC_1).getFont().setBold(true);
```

## Шаг 3. Добавьте контент в свой документ

Вы можете добавить свой контент в документ. Этот контент будет использоваться для создания оглавления.

## Шаг 4: Создайте оглавление

Чтобы создать оглавление, вставьте поле оглавления в нужное место вашего документа. Это поле будет автоматически заполнено в зависимости от заголовков и стилей вашего документа.

```java
// Вставьте поле оглавления в нужное место вашего документа.
FieldToc fieldToc = new FieldToc();
doc.getFirstSection().getBody().getFirstParagraph().appendChild(fieldToc);
```

## Шаг 5: Сохраните документ

Наконец, сохраните документ с оглавлением.

```java
doc.save("your_output_path_here");
```

## Настройка табуляции в оглавлении

Вы также можете настроить позиции табуляции в оглавлении, чтобы контролировать расположение номеров страниц. Вот как вы можете изменить позиции табуляции:

```java
Document doc = new Document("Table of contents.docx");

for (Paragraph para : (Iterable<Paragraph>) doc.getChildNodes(NodeType.PARAGRAPH, true))
{
    if (para.getParagraphFormat().getStyle().getStyleIdentifier() >= StyleIdentifier.TOC_1 &&
        para.getParagraphFormat().getStyle().getStyleIdentifier() <= StyleIdentifier.TOC_9)
    {
        //Получите первую вкладку, используемую в этом абзаце, которая выравнивает номера страниц.
        TabStop tab = para.getParagraphFormat().getTabStops().get(0);
        
        // Удалить старую вкладку.
        para.getParagraphFormat().getTabStops().removeByPosition(tab.getPosition());
        
        // Вставьте новую вкладку в измененном положении (например, на 50 единиц влево).
        para.getParagraphFormat().getTabStops().add(tab.getPosition() - 50.0, tab.getAlignment(), tab.getLeader());
    }
}

doc.save("output.docx");
```

Теперь у вас есть настроенное оглавление в документе с настроенными позициями табуляции для выравнивания номеров страниц.


## Заключение

В этом уроке мы рассмотрели, как создать оглавление (TOC) с помощью Aspose.Words для Java, мощной библиотеки для работы с документами Word. Хорошо структурированное оглавление необходимо для организации и навигации по длинным документам, а Aspose.Words предоставляет инструменты для легкого создания и настройки оглавления.

## Часто задаваемые вопросы

### Как изменить форматирование записей оглавления?

 Вы можете изменить стили, связанные с уровнями TOC, используя`doc.getStyles().getByStyleIdentifier(StyleIdentifier.TOC_X)`, где X — уровень ТОС.

### Как я могу добавить больше уровней в мой TOC?

Чтобы включить больше уровней в оглавление, вы можете изменить поле оглавления и указать желаемое количество уровней.

### Могу ли я изменить позиции табуляции для определенных записей оглавления?

Да, как показано в приведенном выше примере кода, вы можете изменить позиции табуляции для определенных записей оглавления, перебирая абзацы и соответствующим образом изменяя позиции табуляции.