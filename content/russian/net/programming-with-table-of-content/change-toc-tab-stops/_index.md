---
title: Изменить позиции табуляции Toc в документе Word
linktitle: Изменить позиции табуляции Toc в документе Word
second_title: API обработки документов Aspose.Words
description: Узнайте, как изменить позиции табуляции оглавления в документах Word с помощью Aspose.Words для .NET. Это пошаговое руководство поможет вам создать профессионально выглядящее оглавление.
type: docs
weight: 10
url: /ru/net/programming-with-table-of-content/change-toc-tab-stops/
---
## Введение

Вы когда-нибудь задумывались, как оживить оглавление (TOC) в документах Word? Возможно, вы хотите, чтобы эти позиции табуляции были идеально выровнены для профессионального подхода. Вы находитесь в правильном месте! Сегодня мы углубимся в то, как вы можете изменить позиции табуляции оглавления с помощью Aspose.Words для .NET. Оставайтесь здесь, и я обещаю, что вы уйдете со всеми ноу-хау, чтобы ваше оглавление выглядело шикарно и аккуратно.

## Предварительные условия

Прежде чем мы начнем, давайте убедимся, что у вас есть все необходимое:

1.  Aspose.Words для .NET: вы можете[скачай это здесь](https://releases.aspose.com/words/net/).
2. Среда разработки: Visual Studio или любая IDE, совместимая с C#.
3. Документ Word: в частности, тот, который содержит оглавление.

Получил все это? Потрясающий! Давайте катиться.

## Импортировать пространства имен

Прежде всего, вам необходимо импортировать необходимые пространства имен. Это похоже на упаковку инструментов перед началом проекта.

```csharp
using Aspose.Words;
using Aspose.Words.Tables;
```

Давайте разобьем этот процесс на простые и понятные шаги. Мы загрузим документ, изменим позиции табуляции оглавления и сохраним обновленный документ.

## Шаг 1. Загрузите документ

Почему? Нам нужен доступ к документу Word, содержащему оглавление, которое мы хотим изменить.

Как? Вот простой фрагмент кода, который поможет вам начать:

```csharp
// Путь к каталогу ваших документов
string dataDir = "YOUR DOCUMENTS DIRECTORY";

// Загрузите документ, содержащий оглавление
Document doc = new Document(dataDir + "Table of contents.docx");
```

Представьте, что ваш документ похож на торт, и мы собираемся добавить немного глазури. Первый шаг — достать торт из коробки.

## Шаг 2: Определите параграфы содержания

Почему? Нам нужно точно определить параграфы, составляющие содержание. 

Как? Прокрутите абзацы и проверьте их стили:

```csharp
foreach(Paragraph para in doc.GetChildNodes(NodeType.Paragraph, true))
{
    if (para.ParagraphFormat.Style.StyleIdentifier >= StyleIdentifier.Toc1 &&
        para.ParagraphFormat.Style.StyleIdentifier <= StyleIdentifier.Toc9)
    {
        // Абзац оглавления найден
    }
}
```

Думайте об этом как о сканировании толпы в поисках своих друзей. Здесь мы ищем абзацы, оформленные как записи оглавления.

## Шаг 3. Измените позиции табуляции

Почему? Вот где происходит волшебство. Изменение позиций табуляции придает оглавлению более чистый вид.

Как? Удалите существующую позицию табуляции и добавьте новую в измененной позиции:

```csharp
foreach(Paragraph para in doc.GetChildNodes(NodeType.Paragraph, true))
{
    if (para.ParagraphFormat.Style.StyleIdentifier >= StyleIdentifier.Toc1 &&
        para.ParagraphFormat.Style.StyleIdentifier <= StyleIdentifier.Toc9)
    {
        TabStop tab = para.ParagraphFormat.TabStops[0];
        para.ParagraphFormat.TabStops.RemoveByPosition(tab.Position);
        para.ParagraphFormat.TabStops.Add(tab.Position - 50, tab.Alignment, tab.Leader);
    }
}
```

Это все равно, что переставлять мебель в гостиной до тех пор, пока она не станет идеальной. Мы доводим эти позиции табуляции до совершенства.

## Шаг 4. Сохраните измененный документ

Почему? Чтобы гарантировать, что вся ваша тяжелая работа будет сохранена и ее можно будет просмотреть или поделиться.

Как? Сохраните документ под новым именем, чтобы сохранить оригинал:

```csharp
// Сохраните измененный документ
doc.Save(dataDir + "WorkingWithTableOfContent.ChangeTocTabStops.docx");
```

И вуаля! В вашем оглавлении теперь позиции табуляции расположены именно там, где вы хотите.

## Заключение

Изменить позиции табуляции оглавления в документе Word с помощью Aspose.Words for .NET не составит труда, если вы разберете его. Загрузив документ, определив абзацы оглавления, изменив позиции табуляции и сохранив документ, вы сможете добиться безупречного и профессионального вида. Помните: практика ведет к совершенству, поэтому продолжайте экспериментировать с различными позициями табуляции, чтобы получить именно тот макет, который вам нужен.

## Часто задаваемые вопросы

### Могу ли я изменить позиции табуляции для разных уровней содержания отдельно?
Да, вы можете! Просто проверьте каждый конкретный уровень TOC (Toc1, Toc2 и т. д.) и внесите соответствующие изменения.

### Что делать, если мой документ имеет несколько оглавлений?
Код сканирует все абзацы в стиле TOC, поэтому он изменяет все TOC, присутствующие в документе.

### Можно ли добавить несколько позиций табуляции в запись оглавления?
 Абсолютно! Вы можете добавить столько позиций табуляции, сколько необходимо, отрегулировав`para.ParagraphFormat.TabStops` коллекция.

### Могу ли я изменить выравнивание позиции табуляции и стиль выноски?
Да, вы можете указать различные варианты выравнивания и стили выноски при добавлении новой позиции табуляции.

### Нужна ли мне лицензия для использования Aspose.Words для .NET?
 Да, вам нужна действующая лицензия для использования Aspose.Words for .NET после окончания пробного периода. Вы можете получить[временная лицензия](https://purchase.aspose.com/temporary-license/) или[купить один](https://purchase.aspose.com/buy).