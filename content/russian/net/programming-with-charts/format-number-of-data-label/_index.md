---
title: Формат номера метки данных на диаграмме
linktitle: Формат номера метки данных на диаграмме
second_title: API обработки документов Aspose.Words
description: Узнайте, как форматировать количество меток данных на диаграмме с помощью Aspose.Words для .NET. Легко настраивайте числовые форматы для меток данных.
type: docs
weight: 10
url: /ru/net/programming-with-charts/format-number-of-data-label/
---

В этом руководстве объясняется, как использовать Aspose.Words для .NET для форматирования количества меток данных на диаграмме. Предоставленный исходный код демонстрирует, как создать диаграмму, добавить данные серии и настроить числовой формат меток данных.

## Шаг 1. Настройте проект

Убедитесь, что у вас есть следующие предварительные условия:

- Установлена библиотека Aspose.Words для .NET. Вы можете загрузить его, используя для установки диспетчер пакетов NuGet.
- Путь к каталогу документов, в котором будет сохранен выходной документ.

## Шаг 2. Создайте новый документ и вставьте диаграмму.

 Создать новый`Document` объект и`DocumentBuilder` для построения документа.

```csharp
// Путь к каталогу ваших документов
string dataDir = "YOUR DOCUMENT DIRECTORY";

Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

 Затем вставьте диаграмму в документ, используя`InsertChart` метод`DocumentBuilder`. В этом примере мы вставим линейную диаграмму.

```csharp
Shape shape = builder.InsertChart(ChartType.Line, 432, 252);
Chart chart = shape.Chart;
chart.Title.Text = "Data Labels With Different Number Format";
```

## Шаг 3. Добавьте данные серии на диаграмму

Добавьте данные серии на диаграмму. В этом примере мы добавим три категории и соответствующие им значения.

```csharp
chart.Series.Clear();
ChartSeries series1 = chart.Series.Add("Aspose Series 1", 
    new string[] { "Category 1", "Category 2", "Category 3" }, 
    new double[] { 2.5, 1.5, 3.5 });
series1.HasDataLabels = true;
```

## Шаг 4. Настройте числовой формат меток данных.

 Чтобы отформатировать количество меток данных, откройте`DataLabels` Коллекция, связанная с сериалом.

```csharp
series1.DataLabels.ShowValue = true;
series1.DataLabels[0].NumberFormat.FormatCode = "\"$\"#,##0.00";
series1.DataLabels[1].NumberFormat.FormatCode = "dd/mm/yyyy";
series1.DataLabels[2].NumberFormat.FormatCode = "0.00%";
```

В этом примере мы устанавливаем разные числовые форматы для каждой метки данных. Первая метка данных форматируется как валюта, вторая — как дата, а третья — как процент.

## Шаг 5: Сохраните документ

 Наконец, сохраните документ в указанном каталоге, используя команду`Save` метод`Document` объект.

```csharp
doc.Save(dataDir + "WorkingWithCharts.FormatNumberOfDataLabel.docx");
```

На этом реализация форматирования количества меток данных на диаграмме с помощью Aspose.Words для .NET завершена.

### Пример исходного кода для формата метки числа данных с использованием Aspose.Words для .NET 

```csharp
	// Путь к каталогу ваших документов
	string dataDir = "YOUR DOCUMENT DIRECTORY";

	Document doc = new Document();
	DocumentBuilder builder = new DocumentBuilder(doc);
	Shape shape = builder.InsertChart(ChartType.Line, 432, 252);
	Chart chart = shape.Chart;
	chart.Title.Text = "Data Labels With Different Number Format";
	// Удалить созданную по умолчанию серию.
	chart.Series.Clear();
	ChartSeries series1 = chart.Series.Add("Aspose Series 1", 
		new string[] { "Category 1", "Category 2", "Category 3" }, 
		new double[] { 2.5, 1.5, 3.5 });
	series1.HasDataLabels = true;
	series1.DataLabels.ShowValue = true;
	series1.DataLabels[0].NumberFormat.FormatCode = "\"$\"#,##0.00";
	series1.DataLabels[1].NumberFormat.FormatCode = "dd/mm/yyyy";
	series1.DataLabels[2].NumberFormat.FormatCode = "0.00%";
	// Или вы можете установить код формата, который будет связан с исходной ячейкой,
	// в этом случае NumberFormat будет сброшен до общего значения и унаследован от исходной ячейки.
	series1.DataLabels[2].NumberFormat.IsLinkedToSource = true;
	doc.Save(dataDir + "WorkingWithCharts.FormatNumberOfDataLabel.docx");
```

## Заключение

В этом уроке вы узнали, как форматировать количество меток данных на диаграмме с помощью Aspose.Words для .NET. Следуя пошаговому руководству и используя предоставленный исходный код, вы можете создать диаграмму, добавить данные серии и настроить числовой формат меток данных в соответствии с вашими требованиями.

 Aspose.Words for .NET предоставляет комплексный API для обработки слов с диаграммами в документах Word, позволяющий манипулировать различными аспектами диаграммы, включая метки данных. Получив доступ к`DataLabels` коллекции, связанной с серией, вы можете настроить числовой формат отдельных меток данных.

API позволяет управлять отображением значений, задавать разные числовые форматы для каждой метки данных и привязывать числовой формат к исходной ячейке. Такая гибкость позволяет представлять числовые данные на диаграммах с нужным форматированием, например, с символами валют, форматами дат и процентными значениями.

Используя Aspose.Words для .NET, вы можете включить мощные возможности построения диаграмм в свои .NET-приложения и создавать документы профессионального вида с полностью отформатированными диаграммами и метками данных.

### Часто задаваемые вопросы

#### Вопрос 1. Что такое Aspose.Words для .NET?
Aspose.Words for .NET — это многофункциональная библиотека обработки документов, которая позволяет разработчикам создавать, манипулировать и сохранять документы Word программным способом в приложениях .NET. Он предоставляет широкий спектр функций для обработки текстов с элементами документа, включая диаграммы и метки данных.

#### В2. Как установить Aspose.Words для .NET?
Вы можете установить Aspose.Words для .NET, загрузив его с помощью диспетчера пакетов NuGet в Visual Studio. Просто найдите «Aspose.Words» в менеджере пакетов NuGet и установите его в свой проект.

#### Вопрос 3. Могу ли я отформатировать другие аспекты диаграммы с помощью Aspose.Words для .NET?
Да, Aspose.Words для .NET предоставляет широкие возможности для форматирования различных аспектов диаграммы. Помимо меток данных, вы можете настроить тип диаграммы, данные серии, свойства оси, легенду, заголовок, область графика и многие другие элементы диаграммы. API предлагает детальный контроль над внешним видом и форматированием диаграмм.

#### Вопрос 4. Могу ли я применять разные числовые форматы к разным меткам данных в одной серии?
 Да, Aspose.Words для .NET позволяет применять разные числовые форматы к отдельным меткам данных в одной серии. Получив доступ к`DataLabels` коллекции, связанной с серией, вы можете установить`FormatCode` свойство каждой метки данных, чтобы указать желаемый числовой формат. Это позволяет представлять числовые значения в разных форматах на одной диаграмме.

#### Вопрос 5. Могу ли я использовать собственные числовые форматы для меток данных?
 Да, Aspose.Words for .NET поддерживает пользовательские числовые форматы для меток данных. Вы можете указать желаемый числовой формат, установив`FormatCode`свойство метки данных в код пользовательского формата. Это дает вам возможность применять широкий спектр числовых форматов, таких как символы валюты, форматы дат, процентные значения и т. д.

#### Вопрос 6. Могу ли я сохранить диаграмму с отформатированными метками данных в разных форматах?
 Да, Aspose.Words for .NET позволяет сохранять документ, содержащий диаграмму, с отформатированными метками данных в различных форматах, таких как DOCX, PDF, HTML и других. Вы можете выбрать подходящий формат в соответствии с вашими требованиями и использовать`Save` метод`Document` объект для сохранения документа. Отформатированные метки данных сохранятся в сохраненном документе.