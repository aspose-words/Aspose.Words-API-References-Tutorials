---
title: Формат номера метки данных на диаграмме
linktitle: Формат номера метки данных на диаграмме
second_title: API обработки документов Aspose.Words
description: Узнайте, как форматировать метки данных на диаграммах с помощью Aspose.Words для .NET, с помощью этого пошагового руководства. Улучшайте свои документы Word без особых усилий.
type: docs
weight: 10
url: /ru/net/programming-with-charts/format-number-of-data-label/
---
## Введение

Создание интересных и информативных документов часто включает в себя диаграммы с хорошо отформатированными метками данных. Если вы разработчик .NET и хотите улучшить свои документы Word с помощью сложных диаграмм, Aspose.Words for .NET — фантастическая библиотека, которая поможет вам в этом. В этом руководстве шаг за шагом вы пройдете процесс форматирования числовых меток на диаграмме с помощью Aspose.Words для .NET.

## Предварительные условия

Прежде чем углубиться в код, необходимо выполнить несколько предварительных условий:

-  Aspose.Words for .NET: убедитесь, что у вас установлена библиотека Aspose.Words for .NET. Если вы еще не установили его, вы можете[скачай это здесь](https://releases.aspose.com/words/net/).
- Среда разработки: у вас должна быть настроена среда разработки .NET. Visual Studio настоятельно рекомендуется.
- Базовые знания C#: Знание программирования на C# имеет важное значение, поскольку это руководство включает в себя написание и понимание кода C#.
-  Временная лицензия: Чтобы использовать Aspose.Words без каких-либо ограничений, вы можете получить[временная лицензия](https://purchase.aspose.com/temporary-license/).

Теперь давайте углубимся в пошаговый процесс форматирования числовых меток на диаграмме.

## Импортировать пространства имен

Прежде всего, нам нужно импортировать необходимые пространства имен для работы с Aspose.Words for .NET. Добавьте следующие строки в начало файла C#:

```csharp
using Aspose.Words;
using Aspose.Words.Drawing;
using Aspose.Words.Drawing.Charts;
```

## Шаг 1. Настройте каталог документов

Прежде чем вы сможете начать работу с документом Word, вам необходимо указать каталог, в котором ваш документ будет сохранен. Это необходимо для последующей операции сохранения.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

 Заменять`"YOUR DOCUMENT DIRECTORY"` с фактическим путем к каталогу вашего документа.

## Шаг 2. Инициализируйте документ и DocumentBuilder

 Следующим шагом будет инициализация нового`Document` и`DocumentBuilder` .`DocumentBuilder` — это вспомогательный класс, который позволяет нам создавать содержимое документа.

```csharp
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## Шаг 3. Вставьте диаграмму в документ

 Теперь давайте вставим диаграмму в документ, используя`DocumentBuilder`. В этом уроке в качестве примера мы будем использовать линейную диаграмму.

```csharp
Shape shape = builder.InsertChart(ChartType.Line, 432, 252);
Chart chart = shape.Chart;
chart.Title.Text = "Data Labels With Different Number Format";
```

Здесь мы вставляем линейную диаграмму с определенной шириной и высотой и устанавливаем заголовок диаграммы.

## Шаг 4. Очистите серию по умолчанию и добавьте новую серию.

По умолчанию диаграмма будет содержать несколько предварительно созданных рядов. Нам нужно очистить их и добавить свои собственные серии с конкретными точками данных.

```csharp
// Удалить созданную по умолчанию серию.
chart.Series.Clear();

// Добавьте новые серии с пользовательскими точками данных.
ChartSeries series1 = chart.Series.Add("Aspose Series 1", 
	new string[] { "Category 1", "Category 2", "Category 3" }, 
	new double[] { 2.5, 1.5, 3.5 });
```

## Шаг 5. Включите метки данных

Чтобы отобразить метки данных на диаграмме, нам нужно включить их для нашей серии.

```csharp
series1.HasDataLabels = true;
series1.DataLabels.ShowValue = true;
```

## Шаг 6. Форматирование меток данных

Основой этого руководства является форматирование меток данных. Мы можем применять разные числовые форматы к каждой метке данных индивидуально.

```csharp
series1.DataLabels[0].NumberFormat.FormatCode = "\"$\"#,##0.00"; // Формат валюты
series1.DataLabels[1].NumberFormat.FormatCode = "dd/mm/yyyy"; // Формат даты
series1.DataLabels[2].NumberFormat.FormatCode = "0.00%"; // Процентный формат
```

 Кроме того, вы можете связать формат метки данных с исходной ячейкой. При связывании`NumberFormat` будет сброшен до общего значения и унаследован от исходной ячейки.

```csharp
series1.DataLabels[2].NumberFormat.IsLinkedToSource = true;
```

## Шаг 7: Сохраните документ

Наконец, сохраните документ в указанном каталоге.

```csharp
doc.Save(dataDir + "WorkingWithCharts.FormatNumberOfDataLabel.docx");
```

Это сохранит ваш документ с указанным именем и обеспечит сохранение диаграммы с отформатированными метками данных.

## Заключение

Форматирование меток данных на диаграмме с помощью Aspose.Words for .NET может значительно повысить читаемость и профессионализм ваших документов Word. Следуя этому пошаговому руководству, вы теперь сможете создавать диаграммы, добавлять ряды данных и форматировать метки данных в соответствии со своими потребностями. Aspose.Words for .NET — это мощный инструмент, позволяющий выполнять обширную настройку и автоматизацию документов Word, что делает его бесценным активом для разработчиков .NET.

## Часто задаваемые вопросы

### Что такое Aspose.Words для .NET?
Aspose.Words for .NET — это мощная библиотека для создания, управления и преобразования документов Word программным способом с использованием C#.

### Могу ли я форматировать другие типы диаграмм с помощью Aspose.Words для .NET?
Да, Aspose.Words for .NET поддерживает различные типы диаграмм, включая столбчатые, столбчатые, круговые и другие.

### Как получить временную лицензию на Aspose.Words для .NET?
 Вы можете получить временную лицензию[здесь](https://purchase.aspose.com/temporary-license/).

### Можно ли связать метки данных с исходными ячейками в Excel?
Да, вы можете связать метки данных с исходными ячейками, позволяя наследовать числовой формат из исходной ячейки.

### Где я могу найти более подробную документацию по Aspose.Words для .NET?
 Вы можете найти подробную документацию[здесь](https://reference.aspose.com/words/net/).
