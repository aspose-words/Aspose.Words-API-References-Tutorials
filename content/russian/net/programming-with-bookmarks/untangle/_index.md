---
title: Распутать в документе Word
linktitle: Распутать в документе Word
second_title: API обработки документов Aspose.Words
description: Узнайте, как распутать вложенные закладки в документе Word в соседних строках таблицы с помощью Aspose.Words для .NET.
type: docs
weight: 10
url: /ru/net/programming-with-bookmarks/untangle/
---

В этой статье мы рассмотрим приведенный выше исходный код C#, чтобы понять, как использовать функцию Untangle в библиотеке Aspose.Words для .NET. Эта функция раскрывает вложенные закладки, находящиеся в соседних строках таблицы.

## Предпосылки

- Базовые знания языка С#.
- Среда разработки .NET с установленной библиотекой Aspose.Words.

## Шаг 1. Просмотр закладок документа

Мы используем цикл foreach для перебора всех закладок, присутствующих в документе:

```csharp
foreach(Bookmark bookmark in doc.Range.Bookmarks)
{
     // Код для обработки закладок здесь
}
```

## Шаг 2. Получите родительские строки из закладок

 Мы используем`GetAncestor`методы для получения родительских строк начального и конечного узлов закладки:

```csharp
Row row1 = (Row)bookmark.BookmarkStart.GetAncestor(typeof(Row));
Row row2 = (Row)bookmark.BookmarkEnd.GetAncestor(typeof(Row));
```

## Шаг 3. Распутайте вложенные закладки

Если обе родительские строки найдены и закладка начинается и заканчивается в соседних строках, мы перемещаем конечный узел закладки в конец последнего абзаца последней ячейки в верхней строке:

```csharp
if (row1 != null && row2 != null && row1.NextSibling == row2)
     row1.LastCell.LastParagraph.AppendChild(bookmark.BookmarkEnd);
```

### Пример исходного кода для Untangle с использованием Aspose.Words для .NET

Вот полный пример исходного кода для распутывания вложенных закладок с помощью Aspose.Words для .NET:

```csharp

	foreach (Bookmark bookmark in doc.Range.Bookmarks)
	{
		// Получите родительскую строку как закладки, так и конечного узла закладки.
		Row row1 = (Row) bookmark.BookmarkStart.GetAncestor(typeof(Row));
		Row row2 = (Row) bookmark.BookmarkEnd.GetAncestor(typeof(Row));

		// Если обе строки найдены в порядке, а начало и конец закладки содержатся в соседних строках,
		// переместите конечный узел закладки в конец последнего абзаца в последней ячейке верхней строки.
		if (row1 != null && row2 != null && row1.NextSibling == row2)
			row1.LastCell.LastParagraph.AppendChild(bookmark.BookmarkEnd);
	}

```

## Заключение

В этой статье мы изучили исходный код C#, чтобы понять, как использовать функцию Untangle Aspose.Words для .NET. Мы следовали пошаговому руководству, чтобы распутать вложенные закладки в соседних строках таблицы.

### Часто задаваемые вопросы

#### В: Функция «Распутать» работает только с вложенными закладками в соседних строках таблицы?

О: Да, функция «Распутать» предназначена специально для распутывания вложенных закладок, находящихся в соседних строках таблицы. Если закладки находятся не в соседних строках, эта функция не будет применяться.

#### В: Как определить вложенные закладки в документе Word?

О: Вы можете идентифицировать вложенные закладки, перебирая закладки в документе и проверяя, находятся ли начальная и конечная закладки в соседних строках таблицы. Вы можете использовать исходный код, представленный в этой статье, в качестве отправной точки для реализации этой функции.

#### В: Изменяет ли функция расшифровки содержимое исходного документа?

О: Да, функция «Распутать» изменяет исходный документ, перемещая конечный узел закладки в конец последнего абзаца последней ячейки в верхней строке. Обязательно сохраните резервную копию документа перед применением этой функции.

#### Q: Как я могу отделить вложенные закладки в других типах элементов документа, таких как разделы или абзацы?

О: Функция «Распутать», представленная в этой статье, специально разработана для распутывания вложенных закладок в соседних строках таблицы. Если вы хотите распутать вложенные закладки в другие элементы документа, вам потребуется соответствующим образом адаптировать код и использовать соответствующие методы для доступа к нужным элементам.

#### В: Существуют ли какие-либо другие способы распутывания вложенных закладок в документе Word с помощью Aspose.Words for .NET?

 A: Метод, представленный в этой статье, является распространенным методом распутывания вложенных закладок в соседних строках таблицы. Однако могут быть и другие подходы или методы в зависимости от конкретных потребностей вашего проекта. Вы можете проверить[Ссылки на Aspose.Words для .NET API](https://reference.aspose.com/words/net/) для дальнейшего изучения доступных функций.