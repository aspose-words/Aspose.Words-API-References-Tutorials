---
title: Распутать закладки строк в документе Word
linktitle: Распутать закладки строк в документе Word
second_title: API обработки документов Aspose.Words
description: С легкостью распутывайте запутанные закладки строк в документах Word с помощью Aspose.Words для .NET. Это руководство проведет вас через процесс более чистого и безопасного управления закладками.
type: docs
weight: 10
url: /ru/net/programming-with-bookmarks/untangle-row-bookmarks/
---
## Введение

Вы когда-нибудь сталкивались с ситуацией, когда удаление строки в документе Word по закладке портит другие закладки в соседних строках? Это может быть невероятно неприятно, особенно при работе со сложными таблицами. К счастью, Aspose.Words для .NET предлагает мощное решение: распутывание закладок строк. 

Это руководство проведет вас через процесс распутывания закладок строк в документах Word с помощью Aspose.Words для .NET. Мы разобьем код на простые для понимания шаги и объясним назначение каждой функции, что позволит вам уверенно решать эти надоедливые проблемы с закладками.

## Предварительные условия

Прежде чем погрузиться в воду, вам понадобится несколько вещей:

1.  Aspose.Words for .NET: эта коммерческая библиотека предоставляет функциональные возможности для программной работы с документами Word. 2. Вы можете загрузить бесплатную пробную версию с сайта[ссылка для скачивания](https://releases.aspose.com/words/net/) или приобрести лицензию у[купить](https://purchase.aspose.com/buy).
3. Среда разработки AC#: Visual Studio или любая другая среда разработки C# будет работать отлично.
4. Документ Word с закладками строк: в демонстрационных целях мы будем использовать образец документа с именем «Закладки столбца таблицы.docx».

## Импортировать пространства имен

Первый шаг включает импорт необходимых пространств имен в проект C#. Эти пространства имен предоставляют доступ к классам и функциям, которые мы будем использовать из Aspose.Words для .NET:

```csharp
using Aspose.Words;
using System;
```

## Шаг 1. Загрузите документ Word

 Начнем с загрузки документа Word, содержащего закладки запутанных строк.`Document` класс обрабатывает манипуляции с документами в Aspose.Words. Вот как загрузить документ:

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY"; // Замените местоположением вашего документа
Document doc = new Document(dataDir + "Table column bookmarks.docx");
```

 Не забудьте заменить`"YOUR DOCUMENT DIRECTORY"` с фактическим путем к файлу «Столбец таблицы bookmarks.docx».

## Шаг 2. Распутываем закладки строк

 Вот где происходит волшебство!`Untangle` функция заботится о распутывании закладок строк. Давайте разберем его функционал:

```csharp
private void Untangle(Document doc)
{
   foreach (Bookmark bookmark in doc.Range.Bookmarks)
   {
	   // Получить родительскую строку как закладки, так и конца закладки
	   Row row1 = (Row)bookmark.BookmarkStart.GetAncestor(typeof(Row));
	   Row row2 = (Row)bookmark.BookmarkEnd.GetAncestor(typeof(Row));

	   // Проверьте, являются ли строки действительными и смежными
	   if (row1 != null && row2 != null && row1.NextSibling == row2)
		   //Переместить конец закладки в последний абзац последней ячейки верхней строки.
		   row1.LastCell.LastParagraph.AppendChild(bookmark.BookmarkEnd);
   }
}
```

Вот пошаговое объяснение того, что делает код:

 Мы перебираем все закладки в документе, используя`foreach` петля.
Для каждой закладки мы извлекаем родительскую строку как начала закладки (`bookmark.BookmarkStart`) и конец закладки (`bookmark.BookmarkEnd` ) с помощью`GetAncestor` метод.
Затем мы проверяем, найдены ли обе строки (`row1 != null`и`row2 != null`) и если они являются соседними строками (`row1.NextSibling == row2`). Это гарантирует, что мы изменяем только те закладки, которые охватывают соседние строки.
Если условия выполнены, перемещаем конечный узел закладки в конец последнего абзаца в последней ячейке верхней строки (`row1.LastCell.LastParagraph.AppendChild(bookmark.BookmarkEnd)`), эффективно распутывая их.

## Шаг 3. Удалить строку по закладке

 Теперь, когда закладки распутаны, мы можем безопасно удалять строки, используя имена их закладок.`DeleteRowByBookmark` функция выполняет эту задачу:

```csharp
private void DeleteRowByBookmark(Document doc, string bookmarkName)
{
   Bookmark bookmark = doc.Range.Bookmarks[bookmarkName];

   Row row = (Row)bookmark?.BookmarkStart.GetAncestor(typeof(Row));
   row?.Remove();
}
```

Вот разбивка этой функции:

Берем имя закладки (`bookmarkName`) в качестве входных данных.
 Мы извлекаем соответствующий объект закладки, используя`doc.Range.Bookmarks[bookmarkName]`.
Затем мы начинаем использовать родительскую строку закладки`GetAncestor` (аналогично`Untangle` функция).
Наконец, мы проверяем, существуют ли закладка и строка (`bookmark != null` и

## Шаг 4. Проверьте распутывание

 В то время как`Untangle` Функция должна обеспечивать безопасность других закладок, всегда полезно проверять. Вот как мы можем проверить, не удалил ли процесс распутывания случайно конец другой закладки:

```csharp
if (doc.Range.Bookmarks["ROW1"].BookmarkEnd == null)
   throw new Exception("Wrong, the end of the bookmark was deleted.");
```

Этот фрагмент кода проверяет, существует ли конец закладки с именем «ROW1» после удаления строки с закладкой «ROW2». Если оно равно нулю, выдается исключение, указывающее на проблему с процессом распутывания. 

## Шаг 5: Сохраните документ

 Наконец, распутав закладки и, возможно, удалив строки, сохраните измененный документ, используя команду`Save` метод:

```csharp
doc.Save(dataDir + "WorkingWithBookmarks.UntangleRowBookmarks.docx");
```

При этом документ с распутанными закладками и удаленными строками сохраняется под новым именем файла «WorkingWithBookmarks.UntangleRowBookmarks.docx». 

## Заключение

 Следуя этим шагам и используя`Untangle`Функция Aspose.Words for .NET позволяет эффективно распутывать закладки строк в документах Word. Это гарантирует, что удаление строк по закладкам не приведет к непредвиденным последствиям для других закладок в соседних строках. Не забудьте заменить заполнители, например`"YOUR DOCUMENT DIRECTORY"` с вашими фактическими путями и именами файлов.

## Часто задаваемые вопросы

### Является ли Aspose.Words для .NET бесплатным?

 Aspose.Words for .NET — это коммерческая библиотека с бесплатной пробной версией. Вы можете скачать его с[ссылка для скачивания](https://releases.aspose.com/words/net/).

### Могу ли я вручную распутать закладки строк в Word?

Хотя это технически возможно, распутывание закладок в Word вручную может быть утомительным и подверженным ошибкам. Aspose.Words for .NET автоматизирует этот процесс, экономя ваше время и усилия.

###  Что произойдет, если`Untangle` function encounters an error?

Код включает обработчик исключений, который выдает исключение, если процесс распутывания случайно удаляет конец другой закладки. Вы можете настроить эту обработку ошибок в соответствии со своими конкретными потребностями.

### Могу ли я использовать этот код, чтобы распутать закладки в несмежных строках?

В настоящее время код сосредоточен на распутывании закладок, расположенных на соседних строках. Изменение кода для обработки несмежных строк потребует дополнительной логики для идентификации и обработки этих сценариев.

### Есть ли какие-либо ограничения для использования этого подхода?

Этот подход предполагает, что закладки четко определены внутри ячеек таблицы. Если закладки размещены за пределами ячеек или в неожиданных местах, процесс распутывания может работать не так, как предполагалось.