---
title: Показать Скрыть закладки в документе Word
linktitle: Показать Скрыть закладки в документе Word
second_title: API обработки документов Aspose.Words
description: Узнайте, как отображать и скрывать закладки в документах Word с помощью Aspose.Words для .NET, из этого подробного пошагового руководства.
type: docs
weight: 10
url: /ru/net/programming-with-bookmarks/show-hide-bookmarked-content/
---
## Введение

Готовы окунуться в мир обработки документов с Aspose.Words для .NET? Если вы разработчик, желающий автоматизировать задачи по работе с документами, или просто кто-то, кто интересуется программной обработкой файлов Word, вы в правильном месте. Сегодня мы рассмотрим, как отображать и скрывать закладки в документе Word с помощью Aspose.Words для .NET. Это пошаговое руководство сделает вас профессионалом в управлении видимостью контента на основе закладок. Давайте начнем!

## Предпосылки

Прежде чем мы перейдем к деталям, вам понадобится несколько вещей:

1. Visual Studio: любая версия, совместимая с .NET.
2.  Aspose.Words для .NET: Загрузить[здесь](https://releases.aspose.com/words/net/).
3. Базовые знания C#: Если вы можете написать простую программу «Hello World», то все в порядке.
4. Документ Word с закладками: для этого урока мы будем использовать образец документа с закладками.

## Импорт пространств имен

Для начала давайте импортируем необходимые пространства имен. Это гарантирует, что у нас будут все необходимые инструменты для нашей задачи.

```csharp
using System;
using Aspose.Words;
using Aspose.Words.Bookmark;
```

Создав эти пространства имен, мы готовы начать наше путешествие.

## Шаг 1: Настройка вашего проекта

Хорошо, начнем с настройки нашего проекта в Visual Studio.

### Создать новый проект

Откройте Visual Studio и создайте новый проект Console App (.NET Core). Назовите его как-нибудь броским, например, "BookmarkVisibilityManager".

### Добавить Aspose.Words для .NET

Вам нужно будет добавить Aspose.Words for .NET в ваш проект. Вы можете сделать это через NuGet Package Manager.

1. Перейдите в Инструменты > Диспетчер пакетов NuGet > Управление пакетами NuGet для решения.
2. Найдите «Aspose.Words».
3. Установите пакет.

Отлично! Теперь, когда наш проект настроен, давайте перейдем к загрузке нашего документа.

## Шаг 2: Загрузка документа

Нам нужно загрузить документ Word, содержащий закладки. Для этого урока мы будем использовать образец документа с именем "Bookmarks.docx".

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document doc = new Document(dataDir + "Bookmarks.docx");
```

 Этот фрагмент кода устанавливает путь к каталогу ваших документов и загружает документ в`doc` объект.

## Шаг 3: Показать/скрыть закладки контента

Теперь самое интересное – показывать или скрывать контент на основе закладок. Мы создадим метод под названием`ShowHideBookmarkedContent` чтобы справиться с этим.

Вот метод, который переключает видимость заложенного контента:

```csharp
public void ShowHideBookmarkedContent(Document doc, string bookmarkName, bool isHidden)
{
    Bookmark bm = doc.Range.Bookmarks[bookmarkName];

    Node currentNode = bm.BookmarkStart;
    while (currentNode != null && currentNode.NodeType != NodeType.BookmarkEnd)
    {
        if (currentNode.NodeType == NodeType.Run)
        {
            Run run = currentNode as Run;
            run.Font.Hidden = isHidden;
        }
        currentNode = currentNode.NextSibling;
    }
}
```

### Разбивка метода

-  Извлечение закладки:`Bookmark bm = doc.Range.Bookmarks[bookmarkName];` извлекает закладку.
- Обход узлов: мы обходим узлы внутри закладки.
-  Переключение видимости: если узел является`Run` (непрерывный текст), мы устанавливаем его`Hidden` свойство.

## Шаг 4: Применение метода

Теперь, когда наш метод готов, давайте применим его для отображения или скрытия контента на основе закладки.

```csharp
ShowHideBookmarkedContent(doc, "MyBookmark1", true);
```

Эта строка кода скроет содержимое закладки с именем «MyBookmark1».

## Шаг 5: Сохранение документа

Наконец, сохраним наш измененный документ.

```csharp
doc.Save(dataDir + "WorkingWithBookmarks.ShowHideBookmarks.docx");
```

Это сохранит документ с внесенными нами изменениями.

## Заключение

И вот оно! Вы только что узнали, как показывать и скрывать закладки в документе Word с помощью Aspose.Words для .NET. Этот мощный инструмент делает манипуляции с документами легкими, независимо от того, автоматизируете ли вы отчеты, создаете шаблоны или просто возитесь с файлами Word. Счастливого кодирования!

## Часто задаваемые вопросы

### Могу ли я переключать несколько закладок одновременно?
 Да, вы можете позвонить`ShowHideBookmarkedContent` метод для каждой закладки, которую вы хотите переключить.

### Влияет ли скрытие контента на структуру документа?
Нет, скрытие контента влияет только на его видимость. Контент остается в документе.

### Могу ли я использовать этот метод для других типов контента?
Этот метод специально переключает текстовые прогоны. Для других типов контента вам нужно будет изменить логику обхода узлов.

### Является ли Aspose.Words для .NET бесплатным?
 Aspose.Words предлагает бесплатную пробную версию[здесь](https://releases.aspose.com/) , но для использования в производстве требуется полная лицензия. Вы можете приобрести ее[здесь](https://purchase.aspose.com/buy).

### Как я могу получить поддержку, если у меня возникнут проблемы?
 Вы можете получить поддержку от сообщества Aspose[здесь](https://forum.aspose.com/c/words/8).