---
title: Показать скрыть содержимое закладок в документе Word
linktitle: Показать скрыть содержимое закладок в документе Word
second_title: API обработки документов Aspose.Words
description: Узнайте, как динамически отображать или скрывать содержимое закладок в документах Word с помощью Aspose.Words для .NET, с помощью этого подробного пошагового руководства.
type: docs
weight: 10
url: /ru/net/programming-with-bookmarks/show-hide-bookmarked-content/
---

## Введение

Привет! Вы когда-нибудь хотели контролировать видимость определенного содержимого в документе Word на основе определенных условий? С помощью Aspose.Words для .NET вы можете динамически отображать или скрывать содержимое закладок с помощью всего лишь нескольких строк кода. В этом уроке я шаг за шагом проведу вас через этот процесс, гарантируя, что вы поймете каждую часть кода. К концу вы станете профессионалом в управлении закладками в документах Word. Давайте начнем!

## Предварительные условия

Прежде чем мы углубимся в руководство, давайте убедимся, что у вас есть все необходимое:

1. Базовые знания C#: вы должны хорошо разбираться в синтаксисе и концепциях C#.
2.  Aspose.Words для .NET: загрузите его[здесь](https://releases.aspose.com/words/net/) . Если вы не готовы к покупке, вы можете начать с[бесплатная пробная версия](https://releases.aspose.com/).
3. Visual Studio: подойдет любая последняя версия, но рекомендуется использовать последнюю версию.
4. .NET Framework: убедитесь, что он установлен на вашем компьютере.

Готовы начать? Большой! Начнем с импорта необходимых пространств имен.

## Импортировать пространства имен

Чтобы использовать Aspose.Words для .NET, нам необходимо импортировать необходимые пространства имен. Этот шаг гарантирует, что у нас будет доступ ко всем классам и методам, которые мы будем использовать.

```csharp
using System;
using Aspose.Words;
using Aspose.Words.Fields;
```

Эти пространства имен имеют решающее значение для работы с документами Word и управления их содержимым.

## Шаг 1. Настройка документа

Сначала давайте создадим новый документ Word и конструктор документов. Конструктор документов помогает нам легко добавлять и манипулировать содержимым в документе.

```csharp
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

На этом этапе мы инициализируем новый документ и построитель документов. Это настраивает нашу среду для дальнейших операций.

## Шаг 2. Добавление содержимого в закладки

Далее мы добавим в документ некоторый контент и создадим вокруг него закладку. Эта закладка поможет нам идентифицировать контент и манипулировать им.

```csharp
builder.Write("This is some text before the bookmark.");
builder.StartBookmark("MyBookmark");
builder.Write("This is the bookmarked content.");
builder.EndBookmark("MyBookmark");
builder.Write("This is some text after the bookmark.");
```

 Здесь мы добавляем текст до и после содержимого, добавленного в закладки.`StartBookmark`и`EndBookmark` методы определяют границы закладки.

## Шаг 3. Вставка условного поля

Чтобы контролировать видимость содержимого закладок, мы будем использовать условное поле. В этом поле будет проверяться условие и соответственно отображаться или скрываться содержимое.

```csharp
builder.MoveToDocumentEnd();
Field field = builder.InsertField("IF \"", null);
builder.MoveTo(field.Start.NextSibling);
builder.InsertField("MERGEFIELD MyBookmark", null);
builder.Write("\" = \"true\" \"Visible\" \"Hidden\"");
```

На этом этапе мы вставляем поле IF, которое проверяет значение закладки. Если значение «истина», будет отображаться «Видимый»; в противном случае будет отображаться «Скрытый».

## Шаг 4: Перестановка узлов

Далее нам нужно переставить узлы, чтобы обеспечить правильное применение условной логики к содержимому, отмеченному закладкой.

```csharp
Bookmark bm = doc.Range.Bookmarks["MyBookmark"];
Node currentNode = field.Start;
bool flag = true;

while (currentNode != null && flag)
{
    if (currentNode.NodeType == NodeType.Run && currentNode.ToString(SaveFormat.Text).Trim() == "\"")
        flag = false;

    Node nextNode = currentNode.NextSibling;
    bm.BookmarkStart.ParentNode.InsertBefore(currentNode, bm.BookmarkStart);
    currentNode = nextNode;
}

Node endNode = bm.BookmarkEnd;
flag = true;

while (currentNode != null && flag)
{
    if (currentNode.NodeType == NodeType.FieldEnd)
        flag = false;

    Node nextNode = currentNode.NextSibling;
    bm.BookmarkEnd.ParentNode.InsertAfter(currentNode, endNode);
    endNode = currentNode;
    currentNode = nextNode;
}
```

Здесь мы перемещаем узлы, чтобы убедиться, что условие правильно охватывает контент, отмеченный закладкой.

## Шаг 5. Выполнение слияния почты

Наконец, мы выполним слияние почты, чтобы установить значение закладки и определить, следует ли отображать или скрывать содержимое.

```csharp
doc.MailMerge.Execute(new[] { "MyBookmark" }, new object[] { "true" });
```

На этом шаге для значения закладки устанавливается значение «true», что делает контент видимым в зависимости от нашего условия.

## Шаг 6: Сохранение документа

После всех манипуляций последним шагом будет сохранение измененного документа.

```csharp
doc.Save("ShowHideBookmarkedContent.docx");
```

Здесь мы сохраняем документ с описательным именем файла, чтобы указать на изменения.

## Заключение

 Вот и все! Вы успешно научились показывать или скрывать содержимое закладок в документе Word с помощью Aspose.Words для .NET. В этом руководстве рассказывается о создании документа, добавлении закладок, вставке условных полей, перестановке узлов и выполнении слияния почты. Aspose.Words предлагает множество функций, поэтому не стесняйтесь изучить[Документация по API](https://reference.aspose.com/words/net/) для более продвинутых возможностей.

## Часто задаваемые вопросы

### 1. Что такое Aspose.Words для .NET?

Aspose.Words for .NET — это мощная библиотека, которая позволяет разработчикам программно создавать, изменять и конвертировать документы Word. Он широко используется для задач автоматизации документов.

### 2. Могу ли я использовать Aspose.Words для .NET бесплатно?

 Вы можете попробовать Aspose.Words для .NET, используя[бесплатная пробная версия](https://releases.aspose.com/). Для долгосрочного использования вам необходимо приобрести лицензию.

### 3. Как изменить другие свойства закладки?

 Aspose.Words позволяет вам манипулировать различными свойствами закладки, такими как ее текст и местоположение. Обратитесь к[Документация по API](https://reference.aspose.com/words/net/) для получения подробных инструкций.

### 4. Как мне получить поддержку Aspose.Words для .NET?

Вы можете получить поддержку, посетив[Форум поддержки Aspose](https://forum.aspose.com/c/words/8).

### 5. Могу ли я манипулировать другими типами контента с помощью Aspose.Words для .NET?

Да, Aspose.Words for .NET поддерживает различные типы манипуляций с содержимым, включая текст, изображения, таблицы и многое другое.