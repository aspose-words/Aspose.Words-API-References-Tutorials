---
title: Уменьшите размер PDF-файла с помощью масштабирования шрифтов Wmf до размера метафайла
linktitle: Уменьшите размер PDF-файла с помощью масштабирования шрифтов Wmf до размера метафайла
second_title: API обработки документов Aspose.Words
description: Пошаговое руководство по уменьшению размера PDF-файла путем масштабирования шрифтов WMF до размера метафайла при конвертации в PDF с помощью Aspose.Words для .NET.
type: docs
weight: 10
url: /ru/net/programming-with-pdfsaveoptions/scale-wmf-fonts-to-metafile-size/
---
## Введение

При работе с файлами PDF, особенно сгенерированными из документов Word, содержащих графику WMF (Windows Metafile), управление размером может стать важнейшим аспектом обработки документов. Один из способов управления размером PDF — настройка отображения шрифтов WMF в документе. В этом уроке мы рассмотрим, как уменьшить размер PDF, масштабируя шрифты WMF до размера метафайла с помощью Aspose.Words for .NET.

## Предпосылки

Прежде чем приступить к выполнению этих шагов, убедитесь, что у вас есть следующее:

1. Aspose.Words для .NET: Убедитесь, что у вас установлена библиотека Aspose.Words. Если нет, вы можете[скачать здесь](https://releases.aspose.com/words/net/).
2. Среда разработки: в этом руководстве предполагается, что у вас настроена среда разработки .NET (например, Visual Studio), в которой вы можете писать и выполнять код C#.
3. Базовые знания программирования .NET: знакомство с базовыми концепциями программирования .NET и синтаксисом C# будет полезным.
4. Документ Word с графикой WMF: Вам понадобится документ Word, содержащий графику WMF. Вы можете использовать свой собственный документ или создать его для тестирования.

## Импорт пространств имен

Во-первых, вам нужно импортировать необходимые пространства имен в ваш проект C#. Это даст вам доступ к классам и методам, необходимым для работы с Aspose.Words.

```csharp
using Aspose.Words;
using Aspose.Words.Saving;
```

## Шаг 1: Загрузите документ Word

 Для начала загрузите документ Word, содержащий графику WMF. Это делается с помощью`Document` класс из Aspose.Words.

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";

// Загрузить документ
Document doc = new Document(dataDir + "WMF with text.docx");
```

 Здесь,`dataDir` это заполнитель для вашего пути к каталогу документов. Мы создаем экземпляр`Document` class, передавая путь к файлу Word. Это загружает документ в память, готовый к дальнейшей обработке.

## Шаг 2: Настройка параметров рендеринга метафайла

 Далее необходимо настроить параметры рендеринга метафайла. В частности, установить`ScaleWmfFontsToMetafileSize`собственность`false`. Это контролирует, масштабируются ли шрифты WMF в соответствии с размером метафайла.

```csharp
// Создайте новый экземпляр MetafileRenderingOptions
MetafileRenderingOptions metafileRenderingOptions = new MetafileRenderingOptions
{
    ScaleWmfFontsToMetafileSize = false
};
```

 The`MetafileRenderingOptions` класс предоставляет параметры для отображения метафайлов (например, WMF). Устанавливая`ScaleWmfFontsToMetafileSize` к`false`, вы указываете Aspose.Words не масштабировать шрифты в соответствии с размером метафайла, что может помочь уменьшить общий размер PDF-файла.

## Шаг 3: Задайте параметры сохранения PDF-файла

Теперь настройте параметры сохранения PDF для использования только что установленных вами параметров рендеринга метафайлов. Это сообщит Aspose.Words, как обрабатывать метафайлы при сохранении документа в формате PDF.

```csharp
// Создайте новый экземпляр PdfSaveOptions
PdfSaveOptions saveOptions = new PdfSaveOptions
{
    MetafileRenderingOptions = metafileRenderingOptions
};
```

 The`PdfSaveOptions` класс позволяет указать различные настройки для сохранения документа в формате PDF. Назначая ранее настроенные`MetafileRenderingOptions` к`MetafileRenderingOptions` собственность`PdfSaveOptions`, вы гарантируете, что документ будет сохранен в соответствии с желаемыми настройками рендеринга метафайла.

## Шаг 4: Сохраните документ как PDF.

Наконец, сохраните документ Word как PDF, используя настроенные параметры сохранения. Это применит все настройки, включая параметры рендеринга метафайла, к выходному PDF.


```csharp
// Сохранить документ как PDF
doc.Save(dataDir + "WorkingWithPdfSaveOptions.ScaleWmfFontsToMetafileSize.pdf", saveOptions);
```

 На этом этапе`Save` Метод`Document` класс используется для экспорта документа в файл PDF. Указывается путь, по которому будет сохранен PDF, а также`PdfSaveOptions` которые включают настройки рендеринга метафайла.

## Заключение

Масштабируя шрифты WMF до размера метафайла, вы можете значительно уменьшить размер ваших файлов PDF, созданных из документов Word. Этот метод помогает оптимизировать хранение и распространение документов без ущерба для качества визуального контента. Выполнение шагов, описанных выше, гарантирует, что ваши файлы PDF будут более управляемыми и эффективными по размеру.

## Часто задаваемые вопросы

### Что такое WMF и почему он важен для размера PDF?

WMF (Windows Metafile) — графический формат, используемый в Microsoft Windows. Он может содержать как векторные, так и растровые данные. Поскольку векторные данные можно масштабировать и манипулировать ими, важно правильно с ними обращаться, чтобы избежать ненужно больших файлов PDF.

### Как масштабирование шрифтов WMF до размера метафайла влияет на PDF?

Масштабирование шрифтов WMF до размера метафайла может помочь уменьшить общий размер PDF-файла, избегая рендеринга шрифтов с высоким разрешением, который может увеличить размер файла.

### Могу ли я использовать другие форматы метафайлов с Aspose.Words?

Да, Aspose.Words поддерживает различные форматы метафайлов, включая EMF (Enhanced Metafile) в дополнение к WMF.

### Применим ли этот метод ко всем типам документов Word?

Да, этот метод можно применить к любому документу Word, содержащему графику WMF, что помогает оптимизировать размер создаваемого PDF-файла.

### Где я могу найти более подробную информацию об Aspose.Words?

 Вы можете узнать больше об Aspose.Words в[Документация Aspose.Words](https://reference.aspose.com/words/net/) . Для загрузки, пробных версий и поддержки посетите[Страница загрузки Aspose.Words](https://releases.aspose.com/words/net/), [Купить Aspose.Words](https://purchase.aspose.com/buy), [Бесплатная пробная версия](https://releases.aspose.com/), [Временная лицензия](https://purchase.aspose.com/temporary-license/) , и[Поддерживать](https://forum.aspose.com/c/words/8).