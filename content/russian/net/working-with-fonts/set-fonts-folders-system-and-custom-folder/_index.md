---
title: Установить систему папок шрифтов и пользовательскую папку
linktitle: Установить систему папок шрифтов и пользовательскую папку
second_title: API обработки документов Aspose.Words
description: Пошаговое руководство по настройке папок системных и пользовательских шрифтов при рендеринге документа с помощью Aspose.Words for .NET.
type: docs
weight: 10
url: /ru/net/working-with-fonts/set-fonts-folders-system-and-custom-folder/
---

В этом руководстве мы покажем вам пошаговый процесс установки папок системных шрифтов и пользовательской папки при рендеринге документа с помощью Aspose.Words для .NET. Мы объясним прилагаемый исходный код C# и предоставим вам подробное руководство, которое поможет вам понять и реализовать эту функцию в ваших собственных проектах. К концу этого руководства вы узнаете, как указать несколько папок шрифтов, включая системную папку и пользовательскую папку, для использования при рендеринге ваших документов с помощью Aspose.Words для .NET.

## Шаг 1. Определите каталог документов.
Во-первых, вам нужно установить путь к каталогу ваших документов. Это место, где вы хотите сохранить отредактированный визуализированный документ. Замените «КАТАЛОГ ВАШИХ ДОКУМЕНТОВ» на соответствующий путь.

```csharp
string dataDir = "YOUR DOCUMENTS DIRECTORY";
```

## Шаг 2. Загрузите документ для рендеринга
 Затем вы можете загрузить документ для рендеринга, используя`Document` сорт. Обязательно укажите правильный путь к документу.

```csharp
Document doc = new Document(dataDir + "Rendering.docx");
```

## Шаг 3. Установите папки системных и пользовательских шрифтов.
 Теперь вы можете установить системные папки шрифтов и пользовательскую папку, используя`FontSettings` класс и`SetFontsSources()` метод. Во-первых, вам нужно получить список источников шрифтов, зависящих от среды, используя`GetFontsSources()` и сохраните его в списке. Затем вы можете создать новый экземпляр`FolderFontSource` указав путь к пользовательской папке, содержащей ваши шрифты. Добавьте этот экземпляр в список существующих источников шрифтов. Наконец, используйте`SetFontsSources()` чтобы обновить источники шрифтов новым списком.

```csharp
FontSettings fontSettings = new FontSettings();
List<FontSourceBase> fontSources = new List<FontSourceBase>(fontSettings.GetFontsSources());
FolderFontSource folderFontSource = new FolderFontSource("C:\\MyFonts\\", true);
fontSources.Add(folderFontSource);
FontSourceBase[] updatedFontSources = fontSources.ToArray();
fontSettings.SetFontsSources(updatedFontSources);
```

## Шаг 4. Примените настройки шрифта
 Далее вам необходимо применить настройки шрифта к вашему документу, используя`FontSettings` собственность`Document` сорт.

```csharp
doc.FontSettings = fontSettings;
```

## Шаг 5. Сохраните визуализированный документ.
Наконец, вы можете сохранить визуализированный документ в файл, выполнив

   используя`Save()` метод`Document` сорт. Обязательно укажите правильный путь и имя файла.

```csharp
doc.Save(dataDir + "WorkingWithFonts.SetFontsFoldersSystemAndCustomFolder.pdf");
```

### Пример исходного кода для установки системных папок шрифтов и пользовательской папки с использованием Aspose.Words для .NET 

```csharp
//Путь к каталогу ваших документов
string dataDir = "YOUR DOCUMENT DIRECTORY";

Document doc = new Document(dataDir + "Rendering.docx");
FontSettings fontSettings = new FontSettings();
// Получите массив источников шрифтов, зависящих от среды, которые ищутся по умолчанию.
// Например, это будет содержать источник «Windows\Fonts» на компьютерах с Windows.
// Мы добавляем этот массив в новый список, чтобы упростить добавление или удаление записей шрифтов.
List<FontSourceBase> fontSources = new List<FontSourceBase>(fontSettings.GetFontsSources());
// Добавьте новый источник папки, который будет указывать Aspose.Words искать шрифты в следующей папке.
FolderFontSource folderFontSource = new FolderFontSource("C:\\MyFonts\\", true);
// Добавьте пользовательскую папку, содержащую наши шрифты, в список существующих источников шрифтов.
fontSources.Add(folderFontSource);
FontSourceBase[] updatedFontSources = fontSources.ToArray();
fontSettings.SetFontsSources(updatedFontSources);
doc.FontSettings = fontSettings;
doc.Save(dataDir + "WorkingWithFonts.SetFontsFoldersSystemAndCustomFolder.pdf");
```

## Заключение
В этом уроке мы узнали, как установить папки системных шрифтов и пользовательскую папку при рендеринге документа с помощью Aspose.Words для .NET. Следуя этому пошаговому руководству, вы можете легко указать несколько папок шрифтов, включая системную папку и пользовательскую папку, для использования при рендеринге документов. Aspose.Words предлагает мощный и гибкий API для обработки слов со шрифтами в ваших документах. Обладая этими знаниями, вы можете контролировать и настраивать источники шрифтов, используемые при рендеринге документов, в соответствии с вашими конкретными потребностями.

### Часто задаваемые вопросы

#### Вопрос: Как мне установить папки системных шрифтов в Aspose.Words?

О: Чтобы настроить папки системных шрифтов в Aspose.Words, вам не нужно ничего делать. Aspose.Words автоматически использует системные шрифты, установленные в вашей операционной системе.

#### Вопрос: Как я могу установить собственные папки шрифтов в Aspose.Words?

 О: Чтобы установить папки с пользовательскими шрифтами в Aspose.Words, вы можете использовать`SetFontsFolders` метод`Fonts` класс, определяющий расположение папок пользовательских шрифтов.

#### Вопрос: Могу ли я указать несколько папок со шрифтами в Aspose.Words?

 О: Да, вы можете указать несколько папок со шрифтами в Aspose.Words, используя`SetFontsFolders` метод`Fonts` класс со списком местоположений папок.

#### Вопрос: Как проверить папки шрифтов, определенные в Aspose.Words?

 Чтобы проверить папки шрифтов, определенные в Aspose.Words, вы можете использовать`GetFolders` метод`Fonts` class, чтобы получить список настроенных папок шрифтов.

#### Вопрос: Имеют ли пользовательские шрифты папок приоритет над системными шрифтами в Aspose.Words?

О: Да, шрифты пользовательских папок имеют приоритет над системными шрифтами в Aspose.Words. Если шрифт присутствует как в пользовательских папках, так и в системных шрифтах, Aspose.Words будет использовать версию из пользовательской папки.