---
title: Установить системные и пользовательские папки шрифтов
linktitle: Установить системные и пользовательские папки шрифтов
second_title: API обработки документов Aspose.Words
description: Узнайте, как настроить системные и пользовательские папки шрифтов в документах Word с помощью Aspose.Words для .NET, гарантируя корректное отображение ваших документов в различных средах.
type: docs
weight: 10
url: /ru/net/working-with-fonts/set-fonts-folders-system-and-custom-folder/
---
## Введение

Представьте, что вы создаете документ с уникальным стилем шрифта, и вдруг обнаруживаете, что шрифты не отображаются правильно на другом компьютере. Раздражает, не так ли? Вот тут-то и вступает в игру настройка папок шрифтов. С Aspose.Words для .NET вы можете определить системные и пользовательские папки шрифтов, чтобы ваши документы всегда выглядели так, как задумано. Давайте рассмотрим, как этого можно добиться.

## Предпосылки

Прежде чем начать, убедитесь, что у вас есть следующее:

-  Библиотека Aspose.Words for .NET: если вы еще этого не сделали, загрузите ее[здесь](https://releases.aspose.com/words/net/).
- Среда разработки: IDE, например Visual Studio.
- Базовые знания C#: знакомство с C# поможет вам разобраться в примерах кода.

## Импорт пространств имен

Сначала импортируйте необходимые пространства имен в свой проект:

```csharp
using System;
using System.Collections.Generic;
using Aspose.Words;
using Aspose.Words.Fonts;
```

Теперь давайте разберем процесс на простые шаги.

## Шаг 1: Загрузите документ

 Для начала загрузите документ Word в Aspose.Words.`Document` объект. Этот документ будет тем, в котором вы хотите задать папки шрифтов.

```csharp
// Путь к каталогу ваших документов
string dataDir = "YOUR DOCUMENT DIRECTORY";

Document doc = new Document(dataDir + "Rendering.docx");
```

## Шаг 2: Инициализация настроек шрифта

 Создать новый экземпляр`FontSettings`. Этот объект позволит вам управлять источниками шрифтов.

```csharp
FontSettings fontSettings = new FontSettings();
```

## Шаг 3: Извлечение источников системных шрифтов

Получить системные источники шрифтов по умолчанию. На машине Windows это обычно включает "Windows\Fonts\"каталог.

```csharp
List<FontSourceBase> fontSources = new List<FontSourceBase>(fontSettings.GetFontsSources());
```

## Шаг 4: Добавьте папку с пользовательскими шрифтами

Добавьте пользовательскую папку, содержащую ваши дополнительные шрифты. Это полезно, если у вас есть определенные шрифты, не установленные в системном каталоге шрифтов.

```csharp
FolderFontSource folderFontSource = new FolderFontSource("C:\\MyFonts\\", true);
fontSources.Add(folderFontSource);
```

## Шаг 5: Обновите источники шрифтов

 Преобразовать список источников шрифтов обратно в массив и установить его в`FontSettings` объект.

```csharp
FontSourceBase[] updatedFontSources = fontSources.ToArray();
fontSettings.SetFontsSources(updatedFontSources);
```

## Шаг 6: Примените настройки шрифта к документу

 Наконец, примените настроенный`FontSettings` в свой документ и сохраните его в желаемом формате, например, PDF.

```csharp
doc.FontSettings = fontSettings;
doc.Save(dataDir + "WorkingWithFonts.SetFontsFoldersSystemAndCustomFolder.pdf");
```

## Заключение

И вот вам! Выполнив эти шаги, вы можете быть уверены, что ваши документы Word используют правильные шрифты, будь то системные шрифты или пользовательские шрифты, хранящиеся в определенном каталоге. Такая настройка помогает поддерживать целостность внешнего вида вашего документа в различных средах.

## Часто задаваемые вопросы

### Что произойдет, если шрифт отсутствует и в системных, и в пользовательских папках?

Aspose.Words будет использовать шрифт по умолчанию для замены отсутствующего шрифта, гарантируя, что документ останется читабельным.

### Могу ли я добавить несколько пользовательских папок шрифтов?

 Да, вы можете добавить несколько папок пользовательских шрифтов, повторив процесс создания.`FolderFontSource` объектов и добавление их в список источников шрифтов.

### Можно ли использовать сетевые пути для пользовательских папок шрифтов?

 Да, вы можете указать сетевой путь в`FolderFontSource` конструктор.

### Какие форматы файлов поддерживает Aspose.Words для сохранения документов?

Aspose.Words поддерживает различные форматы, включая DOCX, PDF, HTML и другие.

### Как обрабатывать уведомления о замене шрифтов?

 Вы можете обрабатывать уведомления о замене шрифтов с помощью`FontSettings` классы`FontSubstitutionWarning`событие.