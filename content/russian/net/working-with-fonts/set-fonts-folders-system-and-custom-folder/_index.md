---
title: Установить систему папок шрифтов и пользовательскую папку
linktitle: Установить систему папок шрифтов и пользовательскую папку
second_title: API обработки документов Aspose.Words
description: Узнайте, как настроить папки системных и пользовательских шрифтов в документах Word с помощью Aspose.Words for .NET, гарантируя правильное отображение ваших документов в различных средах.
type: docs
weight: 10
url: /ru/net/working-with-fonts/set-fonts-folders-system-and-custom-folder/
---
## Введение

Представьте, что вы создаете документ с уникальным стилем шрифта и обнаруживаете, что шрифты отображаются неправильно на другом компьютере. Разочаровывает, правда? Здесь в игру вступает настройка папок шрифтов. С помощью Aspose.Words for .NET вы можете определять системные и пользовательские папки шрифтов, чтобы ваши документы всегда выглядели так, как задумано. Давайте углубимся в то, как вы можете достичь этого.

## Предварительные условия

Прежде чем мы начнем, убедитесь, что у вас есть следующее:

-  Aspose.Words для библиотеки .NET: загрузите ее, если вы еще этого не сделали.[здесь](https://releases.aspose.com/words/net/).
- Среда разработки: IDE, например Visual Studio.
- Базовые знания C#: Знакомство с C# поможет вам следовать примерам кода.

## Импортировать пространства имен

Сначала импортируйте необходимые пространства имен в свой проект:

```csharp
using System;
using System.Collections.Generic;
using Aspose.Words;
using Aspose.Words.Fonts;
```

Теперь давайте разобьем процесс на простые шаги.

## Шаг 1. Загрузите документ

 Для начала загрузите документ Word в Aspose.Words.`Document` объект. В этом документе вы хотите установить папки шрифтов.

```csharp
// Путь к каталогу ваших документов
string dataDir = "YOUR DOCUMENT DIRECTORY";

Document doc = new Document(dataDir + "Rendering.docx");
```

## Шаг 2. Инициализируйте настройки шрифта

 Создайте новый экземпляр`FontSettings`. Этот объект позволит вам управлять источниками шрифтов.

```csharp
FontSettings fontSettings = new FontSettings();
```

## Шаг 3. Получение источников системных шрифтов

Получите источники системных шрифтов по умолчанию. На компьютере с Windows это обычно включает в себя папку «Windows\Fonts».\"каталог.

```csharp
List<FontSourceBase> fontSources = new List<FontSourceBase>(fontSettings.GetFontsSources());
```

## Шаг 4. Добавьте папку с пользовательскими шрифтами

Добавьте пользовательскую папку, содержащую дополнительные шрифты. Это полезно, если у вас есть определенные шрифты, которые не установлены в каталоге системных шрифтов.

```csharp
FolderFontSource folderFontSource = new FolderFontSource("C:\\MyFonts\\", true);
fontSources.Add(folderFontSource);
```

## Шаг 5. Обновите источники шрифтов

 Преобразуйте список источников шрифтов обратно в массив и установите для него значение`FontSettings` объект.

```csharp
FontSourceBase[] updatedFontSources = fontSources.ToArray();
fontSettings.SetFontsSources(updatedFontSources);
```

## Шаг 6. Примените настройки шрифта к документу

 Наконец, примените настроенный`FontSettings` в свой документ и сохраните его в нужном формате, например PDF.

```csharp
doc.FontSettings = fontSettings;
doc.Save(dataDir + "WorkingWithFonts.SetFontsFoldersSystemAndCustomFolder.pdf");
```

## Заключение

И вот оно! Выполнив эти шаги, вы можете быть уверены, что в ваших документах Word используются правильные шрифты, независимо от того, являются ли они системными шрифтами или пользовательскими шрифтами, хранящимися в определенном каталоге. Эта настройка помогает поддерживать целостность внешнего вида вашего документа в различных средах.

## Часто задаваемые вопросы

### Что произойдет, если шрифт отсутствует как в системной, так и в пользовательской папках?

Aspose.Words будет использовать шрифт по умолчанию для замены отсутствующего шрифта, гарантируя, что документ останется читаемым.

### Могу ли я добавить несколько папок со шрифтами?

 Да, вы можете добавить несколько папок со шрифтами, повторив процесс создания.`FolderFontSource` объекты и добавление их в список источников шрифтов.

### Можно ли использовать сетевые пути для папок с пользовательскими шрифтами?

 Да, вы можете указать сетевой путь в`FolderFontSource` конструктор.

### Какие форматы файлов поддерживает Aspose.Words для сохранения документов?

Aspose.Words поддерживает различные форматы, включая DOCX, PDF, HTML и другие.

### Как обрабатывать уведомления о замене шрифта?

 Вы можете обрабатывать уведомления о замене шрифта, используя`FontSettings` класс`FontSubstitutionWarning`событие.