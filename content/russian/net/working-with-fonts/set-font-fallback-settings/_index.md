---
title: Установить настройки резервного шрифта
linktitle: Установить настройки резервного шрифта
second_title: API обработки документов Aspose.Words
description: Узнайте, как настроить параметры возврата шрифтов в Aspose.Words для .NET. Это всеобъемлющее руководство гарантирует, что все символы в ваших документах будут отображаться правильно.
type: docs
weight: 10
url: /ru/net/working-with-fonts/set-font-fallback-settings/
---
## Введение

При работе с документами, содержащими разнообразные текстовые элементы, такие как разные языки или специальные символы, крайне важно обеспечить правильное отображение этих элементов. Aspose.Words for .NET предлагает мощную функцию Font Fallback Settings, которая помогает определить правила замены шрифтов, когда исходный шрифт не поддерживает определенные символы. В этом руководстве мы рассмотрим, как настроить Font Fallback Settings с помощью Aspose.Words for .NET в пошаговом руководстве.

## Предпосылки

Прежде чем приступить к изучению руководства, убедитесь, что у вас выполнены следующие предварительные условия:

- Базовые знания C#: знакомство с языком программирования C# и платформой .NET.
-  Aspose.Words для .NET: Загрузите и установите с сайта[ссылка для скачивания](https://releases.aspose.com/words/net/).
- Среда разработки: среда, подобная Visual Studio, для написания и запуска кода.
-  Образец документа: Имейте образец документа (например,`Rendering.docx`) готов к тестированию.
- XML правил резервного копирования шрифтов: подготовьте XML-файл, определяющий правила резервного копирования шрифтов.

## Импорт пространств имен

Для использования Aspose.Words необходимо импортировать необходимые пространства имен. Это позволяет получить доступ к различным классам и методам, необходимым для обработки документов.

```csharp
using Aspose.Words;
using Aspose.Words.Fonts;
using System;
```

## Шаг 1: Определите каталог документов

Сначала определите каталог, в котором хранится ваш документ. Это необходимо для поиска и обработки вашего документа.

```csharp
// Путь к каталогу документов
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## Шаг 2: Загрузите документ

 Загрузите ваш документ в Aspose.Words`Document` объект. Этот шаг позволяет работать с документом программно.

```csharp
Document doc = new Document(dataDir + "Rendering.docx");
```

## Шаг 3: Настройте параметры шрифта

Создать новый`FontSettings` объект и загрузить настройки резервного шрифта из XML-файла. Этот XML-файл содержит правила резервного шрифта.

```csharp
FontSettings fontSettings = new FontSettings();
fontSettings.FallbackSettings.Load(dataDir + "Font fallback rules.xml");
```

## Шаг 4: Примените настройки шрифта к документу

 Назначить настроенный`FontSettings`к документу. Это гарантирует, что правила резервного шрифта будут применены при рендеринге документа.

```csharp
doc.FontSettings = fontSettings;
```

## Шаг 5: Сохраните документ.

Наконец, сохраните документ. Настройки резервного шрифта будут использоваться во время операции сохранения, чтобы обеспечить правильную замену шрифта.

```csharp
doc.Save(dataDir + "WorkingWithFonts.SetFontFallbackSettings.pdf");
```

## Файл XML: правила резервного копирования шрифтов

Вот пример того, как должен выглядеть ваш XML-файл, определяющий правила резервного копирования шрифтов:

```xml
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<FontFallbackSettings xmlns="Aspose.Words">
    <FallbackTable>
        <Rule Ranges="0B80-0BFF" FallbackFonts="Vijaya"/>
        <Rule Ranges="1F300-1F64F" FallbackFonts="Segoe UI Emoji, Segoe UI Symbol"/>
        <Rule Ranges="2000-206F, 2070-209F, 20B9" FallbackFonts="Arial" />
        <Rule Ranges="3040-309F" FallbackFonts="MS Gothic" BaseFonts="Times New Roman"/>
        <Rule Ranges="3040-309F" FallbackFonts="MS Mincho"/>
        <Rule FallbackFonts="Arial Unicode MS"/>
    </FallbackTable>
</FontFallbackSettings>
```

## Заключение

Выполнив эти шаги, вы сможете эффективно настроить и использовать Font Fallback Settings в Aspose.Words for .NET. Это гарантирует, что ваши документы будут отображать все символы правильно, даже если исходный шрифт не поддерживает некоторые символы. Реализация этих настроек значительно повысит качество и читаемость ваших документов.

## Часто задаваемые вопросы

### В1: Что такое резервный шрифт?

Font Fallback — это функция, которая позволяет заменять шрифты, если исходный шрифт не поддерживает определенные символы, обеспечивая правильное отображение всех текстовых элементов.

### В2: Могу ли я указать несколько резервных шрифтов?

Да, вы можете указать несколько резервных шрифтов в правилах XML. Aspose.Words проверит каждый шрифт в указанном порядке, пока не найдет тот, который поддерживает символ.

### В3: Где я могу скачать Aspose.Words для .NET?

 Вы можете скачать его с сайта[Страница загрузки Aspose](https://releases.aspose.com/words/net/).

### В4: Как создать XML-файл для правил резервного копирования шрифтов?

Файл XML можно создать с помощью любого текстового редактора. Он должен соответствовать структуре, показанной в примере, приведенном в этом руководстве.

### В5: Доступна ли поддержка для Aspose.Words?

 Да, вы можете найти поддержку на[Форум поддержки Aspose.Words](https://forum.aspose.com/c/words/8).