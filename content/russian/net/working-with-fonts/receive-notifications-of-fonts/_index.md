---
title: Получать уведомления о шрифтах
linktitle: Получать уведомления о шрифтах
second_title: API обработки документов Aspose.Words
description: Узнайте, как получать уведомления об отсутствующих или замененных шрифтах при использовании Aspose.Words для .NET.
type: docs
weight: 10
url: /ru/net/working-with-fonts/receive-notifications-of-fonts/
---

В этом уроке мы расскажем вам, как получать уведомления о шрифтах при использовании Aspose.Words для .NET. Уведомления о шрифтах позволяют обнаруживать отсутствующие или замененные шрифты в документах и управлять ими. Мы шаг за шагом проведем вас, чтобы помочь вам понять и реализовать код в вашем проекте .NET.

## Предварительные условия
Прежде чем начать, убедитесь, что у вас есть следующие предметы:
- Практическое знание языка программирования C#.
- Библиотека Aspose.Words для .NET, установленная в вашем проекте.

## Шаг 1. Определите каталог документов.
 Во-первых, вам нужно установить путь к каталогу, соответствующий местоположению вашего документа Word. Заменять`"YOUR DOCUMENT DIRECTORY"` в коде с соответствующим путем.

```csharp
// Путь к каталогу ваших документов
string dataDir = "YOUR DOCUMENTS DIRECTORY";
```

## Шаг 2. Загрузите документ и настройте параметры шрифта.
 Далее мы загрузим документ, используя`Document` класс и настройте параметры шрифта с помощью`FontSettings` сорт. Мы установим шрифт по умолчанию, который будет использоваться в случае отсутствия шрифтов.

```csharp
// Загрузите документ и настройте параметры шрифта.
Document doc = new Document(dataDir + "Rendering.docx");
FontSettings fontSettings = new FontSettings();
fontSettings.SubstitutionSettings.DefaultFontSubstitution.DefaultFontName = "Arial";
```

## Шаг 3. Установите обработчик уведомлений
Далее мы определим обработчик уведомлений, реализовав`IWarningCallback` интерфейс. Это позволит нам собирать предупреждения о шрифтах при сохранении документа.

```csharp
// Определить обработчик уведомлений
HandleDocumentWarnings callback = new HandleDocumentWarnings();
doc. WarningCallback = callback;
```

## Шаг 4. Примените настройки шрифта и сохраните документ.
Наконец, мы применим настройки шрифта к документу и сохраним его. Любые предупреждения о шрифтах будут перехвачены обработчиком уведомлений, который мы определили ранее.

```csharp
// Примените настройки шрифта и сохраните документ
doc.FontSettings = fontSettings;
doc.Save(dataDir + "WorkingWithFonts.ReceiveNotificationsOfFonts.pdf");
```

### Пример исходного кода для получения уведомлений о шрифтах с использованием Aspose.Words для .NET 
```csharp

//Путь к каталогу ваших документов
string dataDir = "YOUR DOCUMENT DIRECTORY";

Document doc = new Document(dataDir + "Rendering.docx");
FontSettings fontSettings = new FontSettings();
// Мы можем выбрать шрифт по умолчанию, который будет использоваться в случае отсутствия шрифтов.
fontSettings.SubstitutionSettings.DefaultFontSubstitution.DefaultFontName = "Arial";
// Для тестирования мы настроим Aspose.Words искать шрифты только в несуществующей папке. Поскольку Aspose.Words не будет
// найдите любые шрифты в указанном каталоге, тогда во время рендеринга шрифты в документе будут заменены шрифтами по умолчанию
// шрифт, указанный в FontSettings.DefaultFontName. Мы можем уловить это подмножество, используя наш обратный вызов.
fontSettings.SetFontsFolder(string.Empty, false);
//Создайте новый класс, реализующий IWarningCallback, который будет собирать все предупреждения, возникающие во время сохранения документа.
HandleDocumentWarnings callback = new HandleDocumentWarnings();
doc.WarningCallback = callback;
doc.FontSettings = fontSettings;
doc.Save(dataDir + "WorkingWithFonts.ReceiveNotificationsOfFonts.pdf");

```

## Заключение
В этом уроке мы увидели, как получать уведомления о шрифтах при использовании Aspose.Words для .NET. Уведомления о шрифтах позволяют обнаруживать отсутствующие или замененные шрифты в документах и управлять ими. Используйте эту функцию, чтобы обеспечить согласованность шрифтов в ваших документах и принять соответствующие меры в случае отсутствия шрифтов.

### Часто задаваемые вопросы

#### Вопрос: Как я могу получать уведомления об отсутствующих шрифтах в Aspose.Words?

 О: Чтобы получать уведомления об отсутствующих шрифтах в Aspose.Words, вы можете использовать`FontSettings` класс и`FontSubstitutionCallback` событие. Вы можете настроить метод обратного вызова, который будет получать уведомления при обнаружении отсутствующих шрифтов при обработке документов.

#### Вопрос: Как мне справиться с отсутствием шрифтов в документах Word?

О: Чтобы справиться с отсутствующими шрифтами в документах Word, вы можете использовать разные стратегии. Вы можете установить недостающие шрифты в системе, в которой вы запускаете приложение Aspose.Words, или заменить отсутствующие шрифты доступными альтернативными шрифтами.

#### Вопрос: Можно ли получать уведомления о замене шрифта в Aspose.Words?

 О: Да, в Aspose.Words можно получать уведомления о замене шрифта. При замене шрифтов в процессе обработки документа вы можете быть уведомлены с помощью кнопки`FontSubstitutionCallback` событие и предпринять соответствующие действия для настройки внешнего вида текста.

#### Вопрос: Как обеспечить единообразие внешнего вида текста при замене шрифтов в Aspose.Words?

О: Чтобы обеспечить единообразие внешнего вида текста при замене шрифтов, вы можете настроить свойства форматирования текста, такие как размер, стиль и цвет шрифта. Вы также можете рассмотреть возможность использования заменяющих шрифтов, визуально похожих на исходные шрифты.