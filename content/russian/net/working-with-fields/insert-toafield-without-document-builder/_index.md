---
title: Вставить поле TOA без построителя документов
linktitle: Вставить поле TOA без построителя документов
second_title: API обработки документов Aspose.Words
description: Узнайте, как вставить поле TOA без использования конструктора документов в Aspose.Words для .NET. Следуйте нашему пошаговому руководству, чтобы эффективно управлять юридическими цитатами.
type: docs
weight: 10
url: /ru/net/working-with-fields/insert-toafield-without-document-builder/
---
## Введение

Создание поля таблицы полномочий (TOA) в документе Word может показаться сбором сложной головоломки. Однако с помощью Aspose.Words для .NET этот процесс становится плавным и простым. В этой статье мы покажем вам, как вставить поле TOA без использования конструктора документов, что упростит вам управление цитатами и юридическими ссылками в документах Word.

## Предварительные условия

Прежде чем углубиться в руководство, давайте рассмотрим основы, которые вам понадобятся:

-  Aspose.Words для .NET: убедитесь, что у вас установлена последняя версия. Вы можете скачать его с сайта[Веб-сайт Aspose](https://releases.aspose.com/words/net/).
- Среда разработки: .NET-совместимая IDE, такая как Visual Studio.
- Базовые знания C#: понимание базового синтаксиса и концепций C# будет полезным.
- Образец документа Word: создайте или подготовьте образец документа, куда вы хотите вставить поле TOA.

## Импортировать пространства имен

Для начала вам необходимо импортировать необходимые пространства имен из библиотеки Aspose.Words. Эта настройка гарантирует, что у вас есть доступ ко всем классам и методам, необходимым для манипулирования документами.

```csharp
using System;
using Aspose.Words;
using Aspose.Words.Fields;
```

Давайте разобьем этот процесс на простые и понятные шаги. Мы проведем вас через каждый этап, объяснив, что делает каждый фрагмент кода и как он способствует созданию поля TOA.

## Шаг 1. Инициализируйте документ

 Сначала вам нужно создать экземпляр`Document` сорт. Этот объект представляет документ Word, над которым вы работаете.

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";

Document doc = new Document();
```

Этот код инициализирует новый документ Word. Вы можете думать об этом как о создании пустого холста, на который вы добавите свой контент.

## Шаг 2. Создайте и настройте поле TA

Далее мы добавим поле TA (Таблица полномочий). В этом поле отмечаются записи, которые появятся в TOA.

```csharp
Paragraph para = new Paragraph(doc);

// Мы хотим вставить поля TA и TOA следующим образом:
// { TA \c 1 \l "Значение 0" }
FieldTA fieldTA = (FieldTA) para.AppendField(FieldType.FieldTOAEntry, false);
fieldTA.EntryCategory = "1";
fieldTA.LongCitation = "Value 0";

doc.FirstSection.Body.AppendChild(para);
```

Вот разбивка:
- Paragraph para = new Paragraph(doc);: Создает новый абзац в документе.
-  FieldTA fieldTA = (FieldTA) para.AppendField(FieldType.FieldTOAEntry, false);: добавляет поле TA в абзац.`FieldType.FieldTOAEntry` указывает, что это поле ввода TOA.
- fieldTA.EntryCategory = "1";: Устанавливает категорию записи. Это полезно для классификации различных типов записей.
- fieldTA.LongCitation = «Значение 0»;: Указывает длинный текст цитаты. Это текст, который появится в TOA.
- doc.FirstSection.Body.AppendChild(para);: добавляет абзац с полем TA к телу документа.

## Шаг 3. Добавьте поле TOA.

Теперь мы добавим фактическое поле TOA, которое соберет все записи TA в таблицу.

```csharp
para = new Paragraph(doc);

FieldToa fieldToa = (FieldToa) para.AppendField(FieldType.FieldTOA, false);
fieldToa.EntryCategory = "1";
doc.FirstSection.Body.AppendChild(para);
```

На этом этапе:
- FieldToa fieldToa = (FieldToa) para.AppendField(FieldType.FieldTOA, false);: добавляет поле TOA в абзац.
- fieldToa.EntryCategory = "1";: Фильтрует записи, чтобы включить только те, которые отмечены категорией "1".

## Шаг 4. Обновите поле TOA.

После вставки поля TOA вам необходимо обновить его, чтобы оно отражало последние записи.

```csharp
fieldToa.Update();
```

Эта команда обновляет поле TOA, гарантируя, что все отмеченные записи правильно отображаются в таблице.

## Шаг 5: Сохраните документ

Наконец, сохраните документ с добавленным полем TOA.

```csharp
doc.Save(dataDir + "WorkingWithFields.InsertTOAFieldWithoutDocumentBuilder.docx");
```

 Эта строка кода сохраняет документ в указанном каталоге. Обязательно замените`"YOUR DOCUMENT DIRECTORY"` с фактическим путем, по которому вы хотите сохранить файл.

## Заключение

И вот оно! Вы успешно добавили поле TOA в документ Word без использования конструктора документов. Следуя этим шагам, вы сможете эффективно управлять цитатами и создавать полные таблицы полномочий в своих юридических документах. Aspose.Words для .NET делает этот процесс плавным и эффективным, предоставляя вам инструменты для легкого решения сложных задач с документами.

## Часто задаваемые вопросы

### Могу ли я добавить несколько полей ТА с разными категориями?
 Да, вы можете добавить несколько полей ТА с разными категориями, установив`EntryCategory`имущество соответственно.

### Как я могу настроить внешний вид TOA?
Вы можете настроить внешний вид TOA, изменив свойства поля TOA, такие как форматирование записей и метки категорий.

### Можно ли автоматически обновить поле TOA?
 Хотя вы можете вручную обновить поле TOA, используя`Update` Aspose.Words в настоящее время не поддерживает автоматическое обновление при изменении документа.

### Могу ли я программно добавлять поля TA в определенные части документа?
Да, вы можете добавлять поля ТА в определенные места, вставляя их в нужные абзацы или разделы.

### Как обрабатывать несколько полей TOA в одном документе?
 Вы можете управлять несколькими полями TOA, назначая разные`EntryCategory` значения и обеспечение того, чтобы каждое поле TOA фильтровало записи на основе своей категории.