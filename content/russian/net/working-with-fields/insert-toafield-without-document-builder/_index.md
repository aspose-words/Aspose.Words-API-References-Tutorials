---
title: Вставить поле TOA без конструктора документов
linktitle: Вставить поле TOA без конструктора документов
second_title: API обработки документов Aspose.Words
description: Узнайте, как вставить поле TOA без использования конструктора документов в Aspose.Words для .NET. Следуйте нашему пошаговому руководству, чтобы эффективно управлять юридическими цитатами.
type: docs
weight: 10
url: /ru/net/working-with-fields/insert-toafield-without-document-builder/
---
## Введение

Создание поля таблицы авторитетных источников (TOA) в документе Word может показаться сборкой сложной головоломки. Однако с помощью Aspose.Words для .NET процесс становится гладким и простым. В этой статье мы проведем вас через шаги по вставке поля TOA без использования конструктора документов, что облегчит вам управление цитатами и юридическими ссылками в документах Word.

## Предпосылки

Прежде чем погрузиться в обучение, давайте рассмотрим основные моменты, которые вам понадобятся:

-  Aspose.Words for .NET: Убедитесь, что у вас установлена последняя версия. Вы можете загрузить ее с[Сайт Aspose](https://releases.aspose.com/words/net/).
- Среда разработки: совместимая с .NET среда IDE, например Visual Studio.
- Базовые знания C#: Понимание базового синтаксиса и концепций C# будет полезным.
- Образец документа Word: создайте или подготовьте образец документа, в который вы хотите вставить поле TOA.

## Импорт пространств имен

Для начала вам нужно импортировать необходимые пространства имен из библиотеки Aspose.Words. Эта настройка гарантирует, что у вас будет доступ ко всем классам и методам, необходимым для манипуляции документами.

```csharp
using System;
using Aspose.Words;
using Aspose.Words.Fields;
```

Давайте разобьем процесс на простые, легко выполнимые шаги. Мы проведем вас через каждый этап, объяснив, что делает каждый фрагмент кода и как он способствует созданию поля TOA.

## Шаг 1: Инициализация документа

 Сначала вам нужно создать экземпляр`Document` класс. Этот объект представляет документ Word, над которым вы работаете.

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";

Document doc = new Document();
```

Этот код инициализирует новый документ Word. Вы можете думать об этом как о создании чистого холста, на который вы добавите свой контент.

## Шаг 2: Создание и настройка поля TA

Далее мы добавим поле TA (Table of Authoritys). Это поле отмечает записи, которые появятся в TOA.

```csharp
Paragraph para = new Paragraph(doc);

// Мы хотим вставить поля TA и TOA следующим образом:
// { TA \c 1 \l "Значение 0" }
FieldTA fieldTA = (FieldTA) para.AppendField(FieldType.FieldTOAEntry, false);
fieldTA.EntryCategory = "1";
fieldTA.LongCitation = "Value 0";

doc.FirstSection.Body.AppendChild(para);
```

Вот разбивка:
- Абзац para = new Paragraph(doc);: Создает новый абзац в документе.
-  FieldTA fieldTA = (FieldTA) para.AppendField(FieldType.FieldTOAEntry, false);: добавляет поле TA в абзац.`FieldType.FieldTOAEntry` указывает, что это поле ввода TOA.
- fieldTA.EntryCategory = "1";: Устанавливает категорию записи. Это полезно для категоризации различных типов записей.
- fieldTA.LongCitation = "Value 0";: Указывает длинный текст цитаты. Это текст, который будет отображаться в TOA.
- doc.FirstSection.Body.AppendChild(para);: Добавляет абзац с полем TA к телу документа.

## Шаг 3: Добавьте поле TOA

Теперь мы вставим фактическое поле TOA, которое объединяет все записи TA в таблицу.

```csharp
para = new Paragraph(doc);

FieldToa fieldToa = (FieldToa) para.AppendField(FieldType.FieldTOA, false);
fieldToa.EntryCategory = "1";
doc.FirstSection.Body.AppendChild(para);
```

На этом этапе:
- FieldToa fieldToa = (FieldToa) para.AppendField(FieldType.FieldTOA, false);: добавляет поле TOA в абзац.
- fieldToa.EntryCategory = "1";: Фильтрует записи, включая только те, которые отмечены категорией "1".

## Шаг 4: Обновите поле TOA

После вставки поля TOA его необходимо обновить, чтобы оно отражало последние записи.

```csharp
fieldToa.Update();
```

Эта команда обновляет поле TOA, гарантируя, что все отмеченные записи правильно отображаются в таблице.

## Шаг 5: Сохраните документ.

Наконец, сохраните документ с новым добавленным полем TOA.

```csharp
doc.Save(dataDir + "WorkingWithFields.InsertTOAFieldWithoutDocumentBuilder.docx");
```

 Эта строка кода сохраняет документ в указанном каталоге. Обязательно замените`"YOUR DOCUMENT DIRECTORY"` на фактический путь, по которому вы хотите сохранить файл.

## Заключение

И вот оно! Вы успешно добавили поле TOA в документ Word без использования конструктора документов. Выполнив эти шаги, вы сможете эффективно управлять цитатами и создавать комплексные таблицы авторитетов в ваших юридических документах. Aspose.Words для .NET делает этот процесс плавным и эффективным, предоставляя вам инструменты для легкого решения сложных задач с документами.

## Часто задаваемые вопросы

### Могу ли я добавить несколько полей ТА с разными категориями?
 Да, вы можете добавить несколько полей TA с разными категориями, установив`EntryCategory`имущество соответственно.

### Как настроить внешний вид TOA?
Вы можете настроить внешний вид TOA, изменив свойства поля TOA, такие как форматирование записи и метки категорий.

### Возможно ли автоматически обновить поле TOA?
 Хотя вы можете вручную обновить поле TOA с помощью`Update` Метод Aspose.Words в настоящее время не поддерживает автоматические обновления при изменении документа.

### Можно ли программно добавлять поля TA в определенные части документа?
Да, вы можете добавлять поля ТА в определенных местах, вставляя их в нужные абзацы или разделы.

### Как обрабатывать несколько полей TOA в одном документе?
 Вы можете управлять несколькими полями TOA, назначая разные`EntryCategory` значения и обеспечение фильтрации записей в каждом поле TOA на основе его категории.