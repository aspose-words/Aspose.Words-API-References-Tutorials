---
title: Изменить поле Обновить источник культуры
linktitle: Изменить поле Обновить источник культуры
second_title: API обработки документов Aspose.Words
description: Узнайте, как изменить источник культуры обновления поля в Aspose.Words для .NET, с помощью этого руководства. Легко управляйте форматированием даты на основе различных культур.
type: docs
weight: 10
url: /ru/net/working-with-fields/change-field-update-culture-source/
---
## Введение

В этом уроке мы собираемся погрузиться в мир Aspose.Words для .NET и изучить, как изменить источник культуры обновления поля. Если вы имеете дело с документами Word, которые содержат поля даты, и вам необходимо контролировать форматирование этих дат в зависимости от различных языковых стандартов, это руководство для вас. Давайте пройдемся по этому процессу шаг за шагом, чтобы вы поняли каждую концепцию и смогли эффективно применить ее в своих проектах.

## Предварительные условия

Прежде чем мы перейдем к коду, убедитесь, что у вас есть следующее:

-  Aspose.Words для .NET: его можно загрузить с сайта[здесь](https://releases.aspose.com/words/net/).
- Среда разработки: любая совместимая с .NET среда разработки (например, Visual Studio).
- Базовые знания C#. В этом руководстве предполагается, что у вас есть фундаментальные знания программирования на C#.

## Импортировать пространства имен

Сначала давайте импортируем необходимые пространства имен для нашего проекта. Это гарантирует, что у нас будет доступ ко всем необходимым классам и методам, предоставляемым Aspose.Words.

```csharp
using System;
using Aspose.Words;
using Aspose.Words.Fields;
```

Теперь давайте разобьем пример на несколько шагов, чтобы помочь вам понять, как изменить источник культуры обновления поля в Aspose.Words для .NET.

## Шаг 1. Инициализируйте документ

 Первым шагом является создание нового экземпляра`Document` класс и`DocumentBuilder`. Это закладывает основу для создания и управления нашим документом Word.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## Шаг 2. Вставьте поля с определенной локалью

Далее нам нужно вставить поля в документ. В этом примере мы добавим два поля даты. Мы установим немецкий язык шрифта (LocaleId = 1031), чтобы продемонстрировать, как язык и региональные параметры влияют на формат даты.

```csharp
builder.Font.LocaleId = 1031; // немецкий
builder.InsertField("MERGEFIELD Date1 \\@ \"dddd, d MMMM yyyy\"");
builder.Write(" - ");
builder.InsertField("MERGEFIELD Date2 \\@ \"dddd, d MMMM yyyy\"");
```

## Шаг 3. Установите источник культуры обновления поля

 Чтобы контролировать культуру, используемую при обновлении полей, мы установили параметр`FieldUpdateCultureSource` собственность`FieldOptions`сорт. Это свойство определяет, берется ли культура из кода поля или документа.

```csharp
doc.FieldOptions.FieldUpdateCultureSource = FieldUpdateCultureSource.FieldCode;
```

## Шаг 4. Выполните слияние почты

Теперь нам нужно выполнить слияние почты, чтобы заполнить поля фактическими данными. В этом примере мы установим второе поле даты (`Date2`) по 1 января 2011 года.

```csharp
doc.MailMerge.Execute(new string[] { "Date2" }, new object[] { new DateTime(2011, 1, 1) });
```

## Шаг 5: Сохраните документ

Наконец, мы сохраняем документ в указанный каталог. На этом шаге завершается процесс изменения источника культуры обновления поля.

```csharp
doc.Save(dataDir + "WorkingWithFields.ChangeFieldUpdateCultureSource.docx");
```

## Заключение

И вот оно! Вы успешно изменили источник культуры обновления поля в Aspose.Words для .NET. Выполнив эти шаги, вы можете гарантировать, что в ваших документах Word будут отображаться даты и другие значения полей в соответствии с указанными языковыми параметрами. Это может быть особенно полезно при создании документов для международной аудитории.

## Часто задаваемые вопросы

###  С какой целью устанавливается`LocaleId`?
`LocaleId` задает настройки языка и региональных параметров для текста, которые влияют на форматирование дат и других данных, зависящих от языкового стандарта.

### Могу ли я использовать другой язык, кроме немецкого?
 Да, вы можете установить`LocaleId`к любому допустимому идентификатору локали. Например, 1033 для английского языка (США).

###  Что произойдет, если я не установлю`FieldUpdateCultureSource` property?
Если это свойство не установлено, при обновлении полей будут использоваться настройки языка документа по умолчанию.

### Можно ли обновлять поля на основе культуры документа, а не кода поля?
 Да, вы можете установить`FieldUpdateCultureSource` к`FieldUpdateCultureSource.Document` чтобы использовать настройки культуры документа.

### Как отформатировать даты по другому шаблону?
 Вы можете изменить шаблон формата даты в`InsertField` метод путем изменения`\\@` значение переключателя.