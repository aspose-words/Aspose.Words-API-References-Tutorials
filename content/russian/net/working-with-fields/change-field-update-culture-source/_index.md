---
title: Изменить поле Обновить источник культуры
linktitle: Изменить поле Обновить источник культуры
second_title: API обработки документов Aspose.Words
description: Узнайте, как изменить источник культуры обновления поля в Aspose.Words для .NET с помощью этого руководства. Легко управляйте форматированием даты на основе различных культур.
type: docs
weight: 10
url: /ru/net/working-with-fields/change-field-update-culture-source/
---
## Введение

В этом руководстве мы погрузимся в мир Aspose.Words для .NET и рассмотрим, как изменить источник культуры обновления полей. Если вы работаете с документами Word, которые включают поля дат, и вам нужно контролировать, как эти даты форматируются на основе различных культур, это руководство для вас. Давайте пройдемся по процессу шаг за шагом, чтобы убедиться, что вы понимаете каждую концепцию и можете эффективно применять ее в своих проектах.

## Предпосылки

Прежде чем приступить к коду, убедитесь, что у вас есть следующее:

-  Aspose.Words для .NET: Вы можете загрузить его с[здесь](https://releases.aspose.com/words/net/).
- Среда разработки: любая совместимая с .NET IDE (например, Visual Studio).
- Базовые знания C#: это руководство предполагает, что у вас есть фундаментальные знания программирования на C#.

## Импорт пространств имен

Сначала импортируем необходимые пространства имен для нашего проекта. Это обеспечит нам доступ ко всем необходимым классам и методам, предоставляемым Aspose.Words.

```csharp
using System;
using Aspose.Words;
using Aspose.Words.Fields;
```

Теперь давайте разберем пример на несколько шагов, чтобы помочь вам понять, как изменить источник культуры обновления поля в Aspose.Words для .NET.

## Шаг 1: Инициализация документа

 Первый шаг — создать новый экземпляр`Document` класс и а`DocumentBuilder`. Это закладывает основу для создания и обработки нашего документа Word.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## Шаг 2: Вставьте поля с определенными региональными настройками

Далее нам нужно вставить поля в документ. Для этого примера мы вставим два поля даты. Мы установим локаль шрифта на немецкий язык (LocaleId = 1031), чтобы продемонстрировать, как культура влияет на формат даты.

```csharp
builder.Font.LocaleId = 1031; // немецкий
builder.InsertField("MERGEFIELD Date1 \\@ \"dddd, d MMMM yyyy\"");
builder.Write(" - ");
builder.InsertField("MERGEFIELD Date2 \\@ \"dddd, d MMMM yyyy\"");
```

## Шаг 3: Установка источника культуры обновления поля

 Для управления культурой, используемой при обновлении полей, мы устанавливаем`FieldUpdateCultureSource` собственность`FieldOptions`class. Это свойство определяет, берется ли культура из кода поля или документа.

```csharp
doc.FieldOptions.FieldUpdateCultureSource = FieldUpdateCultureSource.FieldCode;
```

## Шаг 4: Выполнение слияния писем

Теперь нам нужно выполнить слияние почты, чтобы заполнить поля фактическими данными. В этом примере мы установим второе поле даты (`Date2`) по 1 января 2011 года.

```csharp
doc.MailMerge.Execute(new string[] { "Date2" }, new object[] { new DateTime(2011, 1, 1) });
```

## Шаг 5: Сохраните документ.

Наконец, мы сохраняем документ в указанном каталоге. Этот шаг завершает процесс изменения источника культуры обновления поля.

```csharp
doc.Save(dataDir + "WorkingWithFields.ChangeFieldUpdateCultureSource.docx");
```

## Заключение

И вот оно! Вы успешно изменили источник культуры обновления поля в Aspose.Words для .NET. Выполнив эти шаги, вы можете гарантировать, что ваши документы Word будут отображать даты и другие значения полей в соответствии с указанными настройками культуры. Это может быть особенно полезно при создании документов для международной аудитории.

## Часто задаваемые вопросы

###  Какова цель установления`LocaleId`?
 The`LocaleId` определяет параметры языка и региональных параметров для текста, которые влияют на форматирование дат и других данных, зависящих от локали.

### Могу ли я использовать другую локаль, кроме немецкой?
 Да, вы можете установить`LocaleId`на любой допустимый идентификатор локали. Например, 1033 для английского языка (США).

###  Что произойдет, если я не установлю`FieldUpdateCultureSource` property?
Если это свойство не задано, при обновлении полей будут использоваться настройки языка и региональных параметров документа по умолчанию.

### Можно ли обновлять поля на основе региональных параметров документа, а не кода поля?
 Да, вы можете установить`FieldUpdateCultureSource` к`FieldUpdateCultureSource.Document` использовать настройки языка и региональных параметров документа.

### Как отформатировать даты по другому шаблону?
 Вы можете изменить шаблон формата даты в`InsertField` метод путем модификации`\\@` переключить значение.