---
title: Изменить локаль
linktitle: Изменить локаль
second_title: API обработки документов Aspose.Words
description: Узнайте, как изменить языковой стандарт для форматирования даты и чисел в документах Word с помощью Aspose.Words для .NET.
type: docs
weight: 10
url: /ru/net/working-with-fields/change-locale/
---

В этом руководстве мы проведем вас через процесс изменения локали в документах Word с помощью Aspose.Words для .NET. Изменяя локаль, вы можете управлять форматированием дат и чисел во время операций слияния почты. Мы предоставим вам необходимый исходный код C# и пошаговые инструкции для достижения этой цели.

## Предварительные условия
Прежде чем мы начнем, убедитесь, что у вас есть следующие предварительные условия:
- Библиотека Aspose.Words for .NET, установленная в вашей системе.

## Шаг 1. Создайте документ и DocumentBuilder
Для начала создайте экземпляр класса Document и объект DocumentBuilder:

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## Шаг 2. Вставьте поле
Затем вставьте поле слияния в документ с помощью метода InsertField:

```csharp
builder.InsertField("MERGEFIELD Date");
```

В приведенном выше коде мы вставляем в документ поле слияния с именем «Дата».

## Шаг 3. Измените локаль
Чтобы изменить языковой стандарт для форматирования даты и чисел, вы можете изменить текущую культуру потока. В этом примере мы установим немецкий язык («de-DE»):

```csharp
CultureInfo currentCulture = Thread.CurrentThread.CurrentCulture;
Thread.CurrentThread.CurrentCulture = new CultureInfo("de-DE");
```

В приведенном выше коде мы сохраняем текущую культуру, а затем устанавливаем немецкую культуру текущего потока.

## Шаг 4. Выполните слияние почты
Выполните операцию слияния почты и укажите значение даты в поле «Дата»:

```csharp
doc.MailMerge.Execute(new[] { "Date" }, new object[] { DateTime.Now });
```

В этом фрагменте кода мы выполняем операцию слияния почты и указываем текущую дату в качестве значения поля «Дата».

## Шаг 5. Восстановите исходную локаль
После завершения слияния восстановите исходную культуру для потока:

```csharp
Thread.CurrentThread.CurrentCulture = currentCulture;
```

В приведенном выше коде мы восстанавливаем исходную культуру потока.

## Шаг 6: Сохраните документ
Сохраните измененный документ в файл, используя метод Save класса Document:

```csharp
doc.Save(dataDir + "WorkingWithFields.ChangeLocale.docx");
```

### Пример исходного кода для изменения локали с помощью Aspose.Words для .NET
Вот полный исходный код для изменения локали в документах Word с помощью Aspose.Words для .NET:

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.InsertField("MERGEFIELD Date");

CultureInfo currentCulture = Thread.CurrentThread.CurrentCulture;
Thread.CurrentThread.CurrentCulture = new CultureInfo("de-DE");

doc.MailMerge.Execute(new[] { "Date" }, new object[] { DateTime.Now });

Thread.CurrentThread.CurrentCulture = currentCulture;

doc.Save(dataDir + "WorkingWithFields.ChangeLocale.docx");
```

## Заключение
Поздравляем! Вы успешно научились менять локаль в документах Word с помощью Aspose.Words для .NET. Следуя пошаговому руководству и используя предоставленный исходный код, вы теперь можете управлять форматированием дат и чисел во время операций слияния почты. Настройте языковой стандарт в соответствии со своими требованиями, чтобы обеспечить точное и единообразное форматирование в ваших документах.

### Часто задаваемые вопросы

#### Вопрос: Совместим ли Aspose.Words с различными версиями Microsoft Word?

О: Да, Aspose.Words совместим с различными версиями Microsoft Word, включая Word 2003, Word 2007, Word 2010, Word 2013, Word 2016 и Word 2019.

#### Вопрос: Поддерживает ли Aspose.Words сложные структуры полей?

А: Абсолютно! Aspose.Words предлагает обширную поддержку сложных структур полей, включая вложенные поля, вычисления и условные выражения. Вы можете использовать этот мощный API для работы с любым типом структуры полей.

#### Вопрос: Поддерживает ли Aspose.Words операции обновления полей?

О: Да, Aspose.Words позволяет обновлять поля по расписанию. С помощью API вы можете легко обновлять значения полей, обновлять вычисления и выполнять другие операции, связанные с полями.

#### Вопрос: Можно ли преобразовать поля в обычный текст с помощью Aspose.Words?

А: Конечно! Aspose.Words предоставляет методы для преобразования полей в обычный текст. Это может быть полезно, когда вам нужно извлечь контент без какого-либо форматирования или функций, связанных с полями.

#### Вопрос: Можно ли с помощью Aspose.Words генерировать документы Word с динамическими полями?

А: Абсолютно! Aspose.Words предлагает надежную функциональность для создания документов Word с динамическими полями. Вы можете создавать шаблоны с предопределенными полями и динамически заполнять их данными, предоставляя гибкое и эффективное решение для создания документов.