---
title: Редакция формы
linktitle: Редакция формы
second_title: API обработки документов Aspose.Words
description: Из этого подробного руководства вы узнаете, как обрабатывать изменения фигур в документах Word с помощью Aspose.Words for .NET. Освойте отслеживание изменений, вставку фигур и многое другое.
type: docs
weight: 10
url: /ru/net/working-with-revisions/shape-revision/
---
## Введение

Программное редактирование документов Word может оказаться сложной задачей, особенно когда дело касается обработки фигур. Независимо от того, создаете ли вы отчеты, разрабатываете шаблоны или просто автоматизируете создание документов, возможность отслеживать изменения формы и управлять ими имеет решающее значение. Aspose.Words for .NET предлагает мощный API, делающий этот процесс простым и эффективным. В этом уроке мы углубимся в особенности редактирования фигур в документах Word, гарантируя, что у вас есть инструменты и знания для легкого управления вашими документами.

## Предварительные условия

Прежде чем мы углубимся в код, давайте убедимся, что у вас есть все необходимое:

-  Aspose.Words для .NET: убедитесь, что у вас установлена библиотека Aspose.Words. Ты можешь[скачай это здесь](https://releases.aspose.com/words/net/).
- Среда разработки: у вас должна быть настроена среда разработки, например Visual Studio.
- Базовое понимание C#: Знакомство с языком программирования C# и базовыми концепциями объектно-ориентированного программирования.
- Документ Word: документ Word, с которым вы можете работать, или вы можете создать его во время обучения.

## Импортировать пространства имен

Сначала давайте импортируем необходимые пространства имен. Они предоставят нам доступ к классам и методам, необходимым для работы с документами и фигурами Word.

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using Aspose.Words;
using Aspose.Words.Drawing;
```

## Шаг 1. Настройка каталога документов

Прежде чем мы начнем работать с фигурами, нам нужно определить путь к каталогу наших документов. Здесь мы сохраним наши измененные документы.

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## Шаг 2. Создание нового документа

Давайте создадим новый документ Word, в который будем вставлять и редактировать фигуры.

```csharp
Document doc = new Document();
```

## Шаг 3. Вставка встроенной фигуры

Мы начнем со вставки встроенной фигуры в наш документ без отслеживания изменений. Встроенная фигура — это фигура, которая течет вместе с текстом.

```csharp
Shape shape = new Shape(doc, ShapeType.Cube);
shape.WrapType = WrapType.Inline;
shape.Width = 100.0;
shape.Height = 100.0;
doc.FirstSection.Body.FirstParagraph.AppendChild(shape);
```

## Шаг 4. Начинаем отслеживать изменения

Чтобы отслеживать изменения в нашем документе, нам нужно включить отслеживание версий. Это важно для выявления изменений, внесенных в формы.

```csharp
doc.StartTrackRevisions("John Doe");
```

## Шаг 5. Вставка другой фигуры с изменениями

Теперь, когда отслеживание изменений включено, давайте вставим еще одну фигуру. На этот раз любые изменения будут отслеживаться.

```csharp
shape = new Shape(doc, ShapeType.Sun);
shape.WrapType = WrapType.Inline;
shape.Width = 100.0;
shape.Height = 100.0;
doc.FirstSection.Body.FirstParagraph.AppendChild(shape);
```

## Шаг 6: Получение и изменение фигур

Мы можем получить все фигуры в документе и изменить их по мере необходимости. Здесь мы получим фигуры и удалим первую.

```csharp
List<Shape> shapes = doc.GetChildNodes(NodeType.Shape, true).Cast<Shape>().ToList();
shapes[0].Remove();
```

## Шаг 7: Сохранение документа

После внесения изменений нам необходимо сохранить документ. Это гарантирует сохранение всех версий и модификаций.

```csharp
doc.Save(dataDir + "Revision shape.docx");
```

## Шаг 8. Обработка изменений перемещения формы

Когда фигура перемещается, Aspose.Words отслеживает это как изменение. Это означает, что будет два экземпляра фигуры: один в исходном месте, другой в новом.

```csharp
doc = new Document(dataDir + "Revision shape.docx");
shapes = doc.GetChildNodes(NodeType.Shape, true).Cast<Shape>().ToList();
```

## Заключение

И вот оно! Вы успешно научились обрабатывать изменения формы в документах Word с помощью Aspose.Words для .NET. Независимо от того, управляете ли вы шаблонами документов, автоматизируете отчеты или просто отслеживаете изменения, эти навыки неоценимы. Следуя этому пошаговому руководству, вы не только освоили основы, но и получили представление о более продвинутых методах работы с документами.

## Часто задаваемые вопросы

### Что такое Aspose.Words для .NET?
Aspose.Words for .NET — это мощная библиотека, которая позволяет разработчикам создавать, изменять и конвертировать документы Word программным способом с использованием C#.

### Могу ли я отслеживать изменения, внесенные в другие элементы документа Word?
Да, Aspose.Words for .NET поддерживает отслеживание изменений различных элементов, включая текст, таблицы и многое другое.

### Как я могу получить бесплатную пробную версию Aspose.Words для .NET?
 Вы можете получить бесплатную пробную версию Aspose.Words для .NET.[здесь](https://releases.aspose.com/).

### Можно ли принять или отклонить изменения программно?
Да, Aspose.Words для .NET предоставляет методы для программного принятия или отклонения изменений.

### Могу ли я использовать Aspose.Words для .NET с другими языками .NET, кроме C#?
Абсолютно! Aspose.Words for .NET можно использовать с любым языком .NET, включая VB.NET и F#.