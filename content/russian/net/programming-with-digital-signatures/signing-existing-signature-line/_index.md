---
title: Подписание существующей строки подписи в документе Word
linktitle: Подписание существующей строки подписи в документе Word
second_title: API обработки документов Aspose.Words
description: Узнайте, как подписать существующую строку подписи в документе Word с помощью Aspose.Words для .NET.
type: docs
weight: 10
url: /ru/net/programming-with-digital-signatures/signing-existing-signature-line/
---
В этом руководстве мы покажем вам, как использовать функцию подписи существующей строки подписи с Aspose.Words для .NET. Эта функция позволяет вам поставить цифровую подпись на строке подписи, уже присутствующей в документе Word. Выполните следующие действия:

## Шаг 1. Загрузка документа и доступ к строке подписи.

Начните с загрузки документа, содержащего существующую строку подписи:

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document doc = new Document(dataDir + "Signature line.docx");

SignatureLine signatureLine = ((Shape)doc.FirstSection.Body.GetChild(NodeType.Shape, 0, true)).SignatureLine;
```

## Шаг 2. Настройка параметров подписи

Создайте экземпляр класса SignOptions и задайте параметры подписи, включая идентификатор строки подписи и изображение строки подписи:

```csharp
SignOptions signOptions = new SignOptions
{
SignatureLineId = signatureLine.Id,
SignatureLineImage = File.ReadAllBytes(ImagesDir + "Enhanced Windows MetaFile.emf")
};
```

Обязательно укажите правильный путь к изображению строки подписи.

## Шаг 3. Загрузка сертификата

Начните с загрузки сертификата подписи с помощью класса CertificateHolder:

```csharp
CertificateHolder certHolder = CertificateHolder.Create(dataDir + "morzal.pfx", "aw");
```

Обязательно укажите правильный путь к сертификату и связанный с ним пароль.

## Шаг 4. Подписание существующей строки подписи.

Используйте класс DigitalSignatureUtil, чтобы подписать существующую строку подписи:

```csharp
DigitalSignatureUtil.Sign(dataDir + "Digitally signed.docx",
	dataDir + "SignDocuments.SigningExistingSignatureLine.docx", certHolder, signOptions);
```

Обязательно укажите правильные пути для исходного документа, подписанного документа и сертификата.

### Пример исходного кода для подписи существующей строки подписи с использованием Aspose.Words для .NET

Вот полный исходный код для подписи существующей строки подписи с помощью Aspose.Words для .NET:


```csharp

	// Путь к каталогу документов.
	string dataDir = "YOUR DOCUMENT DIRECTORY";
	Document doc = new Document(dataDir + "Signature line.docx");
	
	SignatureLine signatureLine =
		((Shape) doc.FirstSection.Body.GetChild(NodeType.Shape, 0, true)).SignatureLine;

	SignOptions signOptions = new SignOptions
	{
		SignatureLineId = signatureLine.Id,
		SignatureLineImage = File.ReadAllBytes(ImagesDir + "Enhanced Windows MetaFile.emf")
	};

	CertificateHolder certHolder = CertificateHolder.Create(dataDir + "morzal.pfx", "aw");
	
	DigitalSignatureUtil.Sign(dataDir + "Digitally signed.docx",
		dataDir + "SignDocuments.SigningExistingSignatureLine.docx", certHolder, signOptions);
	

```

Выполнив эти шаги, вы можете легко подписать существующую строку подписи в документе Word с помощью Aspose.Words для .NET.

## Заключение

В этом уроке мы узнали, как подписать существующую строку подписи в документе Word с помощью Aspose.Words для .NET. Следуя предоставленным инструкциям, вы можете легко загрузить документ, получить доступ к существующей строке подписи, установить параметры подписи и подписать документ. Возможность подписать существующую строку подписи обеспечивает удобный способ добавления цифровых подписей в заранее определенные области в документах Word, обеспечивая целостность и аутентификацию документа. Aspose.Words for .NET предлагает мощный API для обработки текстов с цифровыми подписями, позволяющий настроить процесс подписи и повысить безопасность ваших документов Word.

### Часто задаваемые вопросы

#### Вопрос: Что такое существующая строка подписи в документе Word?

О: Существующая строка подписи в документе Word — это предопределенная область, в которой можно разместить подпись. Обычно он представлен в документе формой или объектом и служит выделенным местом для подписывающего лица для добавления своей цифровой подписи.

#### Вопрос: Как я могу подписать существующую строку подписи в документе Word, используя Aspose.Words для .NET?

О: Чтобы подписать существующую строку подписи в документе Word с помощью Aspose.Words for .NET, вы можете выполнить следующие действия:
1.  Загрузите документ с помощью`Document` class и укажите путь к файлу документа.
2.  Получите доступ к существующей строке подписи, используя соответствующий метод или свойство. Например, вы можете использовать`GetChild` метод для получения формы линии подписи.
3.  Создайте экземпляр`SignOptions` класс и установите`SignatureLineId` к идентификатору существующей строки подписи.
4.  Установить`SignatureLineImage` собственность`SignOptions` класс изображения, представляющего цифровую подпись.
5.  Загрузите сертификат подписи, используя`CertificateHolder` class и предоставьте необходимый сертификат и пароль.
6.  Использовать`DigitalSignatureUtil.Sign` метод подписи документа, предоставляющий необходимые параметры, включая`SignOptions` Объект Object.

#### Вопрос: Как получить доступ к существующей строке подписи в документе Word с помощью Aspose.Words for .NET?

 О: Чтобы получить доступ к существующей строке подписи в документе Word с помощью Aspose.Words for .NET, вы можете использовать соответствующий метод или свойство для получения формы линии подписи из структуры документа. Например, вы можете использовать`GetChild` метод с соответствующими параметрами, чтобы получить желаемую форму линии подписи.

#### Вопрос: Могу ли я настроить внешний вид цифровой подписи в существующей строке подписи?

О: Да, вы можете настроить внешний вид цифровой подписи в существующей строке подписи, предоставив файл изображения, представляющий подпись. Изображение может представлять собой логотип, рукописную подпись или любое другое графическое представление подписи. Вы можете установить`SignatureLineImage` собственность`SignOptions` class к байтам файла изображения.

#### Вопрос: Могу ли я подписать несколько существующих строк подписи в документе Word?
 О: Да, вы можете подписать несколько существующих строк подписи в документе Word. Вам необходимо выполнить действия для каждой строки подписи индивидуально, установив соответствующий`SignatureLineId` и`SignatureLineImage` ценности в`SignOptions` объект для каждой строки подписи.

#### Вопрос: В каком формате должен быть файл изображения для цифровой подписи в существующей строке подписи?

 О: Файл изображения для цифровой подписи в существующей строке подписи может быть в различных форматах, таких как PNG, JPEG, BMP или GIF. Вы можете указать путь к файлу или прочитать байты файла изображения и назначить его`SignatureLineImage` собственность`SignOptions` класс.
