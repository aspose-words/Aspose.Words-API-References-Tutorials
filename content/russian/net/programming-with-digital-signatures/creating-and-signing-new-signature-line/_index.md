---
title: Создание и подписание новой строки подписи
linktitle: Создание и подписание новой строки подписи
second_title: API обработки документов Aspose.Words
description: Узнайте, как создать и подписать цифровым способом строку подписи в документе Word с помощью Aspose.Words для .NET с помощью этого пошагового руководства. Идеально подходит для автоматизации документов.
type: docs
weight: 10
url: /ru/net/programming-with-digital-signatures/creating-and-signing-new-signature-line/
---
## Введение

Привет! Итак, у вас есть документ Word, и вам нужно добавить строку подписи, а затем подписать его цифровым способом. Звучит сложно? Вовсе нет! Благодаря Aspose.Words для .NET вы можете добиться этого без проблем, написав всего несколько строк кода. В этом уроке мы проведем вас через весь процесс, от настройки среды до сохранения документа с новой блестящей подписью. Готовы? Давайте погрузимся!

## Предпосылки

Прежде чем перейти к коду, давайте убедимся, что у вас есть все необходимое:
1.  Aspose.Words для .NET - Вы можете[скачать здесь](https://releases.aspose.com/words/net/).
2. Настоятельно рекомендуется среда разработки .NET - Visual Studio.
3. Документ для подписания — создайте простой документ Word или используйте существующий.
4.  Файл сертификата - Он необходим для цифровых подписей. Вы можете использовать`.pfx` файл.
5. Изображения для строки подписи — файл изображения для подписи (опционально).

## Импорт пространств имен

Во-первых, нам нужно импортировать необходимые пространства имен. Этот шаг имеет решающее значение, поскольку он настраивает среду для использования функциональности Aspose.Words.

```csharp
using System;
using System.IO;
using Aspose.Words;
using Aspose.Words.Drawing;
using Aspose.Words.Saving;
using Aspose.Words.Signing;
```

## Шаг 1: Настройка каталога документов

Каждому проекту нужно хорошее начало. Давайте настроим путь к вашему каталогу документов. Это место, где будут сохраняться и извлекаться ваши документы.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## Шаг 2: Создание нового документа

Теперь давайте создадим новый документ Word с помощью Aspose.Words. Это будет наш холст, куда мы добавим строку подписи.

```csharp
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## Шаг 3: Вставка строки подписи

 Вот тут и происходит волшебство. Вставляем строку подписи в наш документ с помощью`DocumentBuilder` сорт.

```csharp
SignatureLine signatureLine = builder.InsertSignatureLine(new SignatureLineOptions()).SignatureLine;
```

## Шаг 4: Сохранение документа со строкой подписи

После того, как строка подписи будет на месте, нам нужно сохранить документ. Это промежуточный шаг перед тем, как мы приступим к его подписанию.

```csharp
doc.Save(dataDir + "SignDocuments.SignatureLine.docx");
```

## Шаг 5: Настройка параметров подписи

Теперь настроим параметры подписания документа. Это включает в себя указание идентификатора строки подписи и используемого изображения.

```csharp
SignOptions signOptions = new SignOptions
{
    SignatureLineId = signatureLine.Id,
    SignatureLineImage = File.ReadAllBytes(dataDir + "Enhanced Windows MetaFile.emf")
};
```

## Шаг 6: Загрузка сертификата

Для цифровых подписей требуется сертификат. Здесь мы загружаем файл сертификата, который будет использоваться для подписи документа.

```csharp
CertificateHolder certHolder = CertificateHolder.Create(dataDir + "morzal.pfx", "aw");
```

## Шаг 7: Подписание документа

 Это последний шаг. Мы используем`DigitalSignatureUtil`класс для подписания документа. Подписанный документ сохраняется под новым именем.

```csharp
DigitalSignatureUtil.Sign(dataDir + "SignDocuments.SignatureLine.docx",
    dataDir + "SignDocuments.NewSignatureLine.docx", certHolder, signOptions);
```

## Заключение

И вот оно! С помощью этих шагов вы успешно создали новый документ Word, добавили строку подписи и подписали его в цифровом виде с помощью Aspose.Words for .NET. Это мощный инструмент, который делает автоматизацию документов легкой. Независимо от того, имеете ли вы дело с контрактами, соглашениями или любыми формальными документами, этот метод гарантирует их надежную подпись и аутентификацию.

## Часто задаваемые вопросы

### Могу ли я использовать другие форматы изображений для строки подписи?
Да, вы можете использовать различные форматы изображений, такие как PNG, JPG, BMP и т. д.

###  Необходимо ли использовать`.pfx` file for the certificate?
 Да, а`.pfx` Файл — это распространенный формат для хранения криптографической информации, включая сертификаты и закрытые ключи.

### Могу ли я добавить несколько строк подписи в один документ?
Конечно! Вы можете вставить несколько строк подписи, повторив шаг вставки для каждой подписи.

### Что делать, если у меня нет цифрового сертификата?
Вам необходимо получить цифровой сертификат от доверенного центра сертификации или сгенерировать его с помощью таких инструментов, как OpenSSL.

### Как проверить цифровую подпись в документе?
Вы можете открыть подписанный документ в Word и перейти к сведениям о подписи, чтобы проверить подлинность и целостность подписи.