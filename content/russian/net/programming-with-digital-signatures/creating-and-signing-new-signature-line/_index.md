---
title: Создание и подписание новой строки подписи
linktitle: Создание и подписание новой строки подписи
second_title: API обработки документов Aspose.Words
description: Узнайте, как создать и подписать новую строку подписи в документе Word с помощью Aspose.Words для .NET.
type: docs
weight: 10
url: /ru/net/programming-with-digital-signatures/creating-and-signing-new-signature-line/
---
В этом руководстве мы покажем вам, как использовать функцию создания и подписания новой строки подписи с помощью Aspose.Words для .NET. Эта функция позволяет вставить строку подписи в документ Word, установить дополнительные параметры и подписать документ. Выполните следующие действия:

## Шаг 1. Создание документа и генератора

Начните с создания экземпляра класса Document и объекта DocumentBuilder:

```csharp
string dataDir = "YOUR DOCUMENTS DIRECTORY";
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## Шаг 2. Вставка строки подписи.

Используйте метод InsertSignatureLine() объекта DocumentBuilder, чтобы вставить в документ новую строку подписи:

```csharp
SignatureLine signatureLine = builder.InsertSignatureLine(new SignatureLineOptions()).SignatureLine;
```

## Шаг 3. Сохраните документ.

Сохраните измененный документ:

```csharp
doc.Save(dataDir + "SignDocuments.SignatureLine.docx");
```

Обязательно укажите правильный путь и имя файла для сохранения документа.

## Шаг 4: Подписание документа

Чтобы подписать документ, вам необходимо установить параметры подписи и использовать класс DigitalSignatureUtil:

```csharp
SignOptions signOptions = new SignOptions
{
	SignatureLineId = signatureLine.Id,
	SignatureLineImage = File.ReadAllBytes(ImagesDir + "Enhanced Windows MetaFile.emf")
};

CertificateHolder certHolder = CertificateHolder.Create(MyDir + "morzal.pfx", "aw");

DigitalSignatureUtil.Sign(dataDir + "SignDocuments.SignatureLine.docx",
	dataDir + "SignDocuments.NewSignatureLine.docx", certHolder, signOptions);
```

Обязательно укажите правильные пути к документу, изображению строки подписи и подписанному документу.

### Пример исходного кода для создания и подписания новой строки подписи с использованием Aspose.Words для .NET

Вот полный исходный код для создания и подписания новой строки подписи с помощью Aspose.Words для .NET:

```csharp

	// Путь к каталогу документов.
	string dataDir = "YOUR DOCUMENT DIRECTORY";
	Document doc = new Document();
	DocumentBuilder builder = new DocumentBuilder(doc);

	SignatureLine signatureLine = builder.InsertSignatureLine(new SignatureLineOptions()).SignatureLine;
	
	doc.Save(dataDir + "SignDocuments.SignatureLine.docx");

	SignOptions signOptions = new SignOptions
	{
		SignatureLineId = signatureLine.Id,
		SignatureLineImage = File.ReadAllBytes(ImagesDir + "Enhanced Windows MetaFile.emf")
	};

	CertificateHolder certHolder = CertificateHolder.Create(MyDir + "morzal.pfx", "aw");
	
	DigitalSignatureUtil.Sign(dataDir + "SignDocuments.SignatureLine.docx",
		dataDir + "SignDocuments.NewSignatureLine.docx", certHolder, signOptions);

```

Выполнив эти шаги, вы сможете легко создать и подписать новую строку подписи в документе Word с помощью Aspose.Words для .NET.

## Заключение

В этом уроке мы узнали, как создать и подписать новую строку подписи в документе Word с помощью Aspose.Words для .NET. Следуя предоставленным инструкциям, вы можете легко вставить строку подписи в свой документ, настроить ее параметры и подписать документ с помощью цифрового сертификата. Добавление строк подписи и цифровых подписей в ваши документы повышает их подлинность и целостность, делая их более безопасными и заслуживающими доверия. Aspose.Words for .NET предоставляет мощный API для обработки текстов с подписями и цифровыми сертификатами в документах Word, что позволяет автоматизировать процесс подписания и гарантировать достоверность ваших документов.

### Часто задаваемые вопросы

#### Вопрос: Что такое строка подписи в документе Word?

О: Строка подписи в документе Word — это заполнитель, указывающий, где следует поставить подпись. Обычно он включает имя, должность и дату, а также оставляет место для рукописной или цифровой подписи.

#### Вопрос: Как создать строку подписи в документе Word с помощью Aspose.Words for .NET?

О: Чтобы создать строку подписи в документе Word с помощью Aspose.Words for .NET, вы можете выполнить следующие действия:
1.  Создайте экземпляр`Document` класс и`DocumentBuilder` объект.
2.  Использовать`InsertSignatureLine` метод`DocumentBuilder` объект для вставки новой строки подписи в документ.
3. Сохраните измененный документ.

#### Вопрос: Могу ли я настроить параметры строки подписи, такие как имя, должность и дата?

 О: Да, вы можете настроить параметры строки подписи.`SignatureLineOptions` класс предоставляет свойства для установки желаемых параметров, таких как`Signer`, `SignerTitle`, `ShowDate`и т. д. Вы можете изменить эти свойства перед вставкой строки подписи.

#### Вопрос: Как я могу подписать документ после создания строки подписи?

 О: Чтобы подписать документ после создания строки подписи, вам необходимо задать параметры подписи и использовать`DigitalSignatureUtil` сорт. Вот шаги:
1.  Установить`SignatureLineId` недвижимость в`SignOptions` объект к идентификатору строки подписи.
2.  Установить`SignatureLineImage` недвижимость в`SignOptions` возражайте против изображения подписи, которую вы хотите использовать.
3.  Загрузите сертификат подписи, используя`CertificateHolder` сорт.
4.  Использовать`DigitalSignatureUtil.Sign` метод для подписания документа, предоставляющий необходимые параметры.

#### Вопрос: Могу ли я использовать изображение цифровой подписи для подписания документа?

 О: Да, вы можете использовать изображение цифровой подписи для подписи документа. Для этого вам необходимо предоставить файл изображения в`SignOptions` объект с помощью`SignatureLineImage`свойство. Изображение может быть в любом поддерживаемом формате, например JPEG, PNG или EMF.

#### Вопрос: Какова цель создания и подписания новой строки подписи в документе Word?

О: Создание и подписание новой строки подписи в документе Word с помощью Aspose.Words for .NET позволяет вам добавить заполнитель для подписи, а затем подписать документ с помощью цифрового сертификата. Этот процесс обеспечивает подлинность и целостность документа, предоставляя доказательства одобрения или согласия.

#### Вопрос: Могу ли я создать и подписать несколько строк подписи в документе Word, используя Aspose.Words для .NET?

О: Да, вы можете создать и подписать несколько строк подписи в документе Word, используя Aspose.Words для .NET. Каждая строка подписи может иметь свой уникальный идентификатор и параметры. Вы можете повторить действия, чтобы создать и подписать дополнительные строки подписи в документе.

#### Вопрос: Могу ли я изменить строку подписи или добавить дополнительную информацию после ее подписания?

О: После подписания строки подписи она становится частью содержимого документа и не может быть изменена отдельно. Однако вы можете добавить дополнительную информацию или контент после подписанной строки подписи.

#### Вопрос: Могу ли я проверить цифровую подпись документа, содержащего строку подписи?

 О: Да, Aspose.Words for .NET предоставляет функциональные возможности для проверки цифровой подписи документа, содержащего строку подписи. Вы можете использовать`DigitalSignatureUtil.Verify` метод проверки действительности и подлинности цифровой подписи.

#### Вопрос: Какой формат файлов поддерживает Aspose.Words for .NET для создания и подписания строк подписи?

О: Aspose.Words for .NET поддерживает создание и подписание строк подписи в формате файла DOCX. Вы можете создавать и подписывать строки подписи в файлах DOCX, используя предоставленные методы и классы.