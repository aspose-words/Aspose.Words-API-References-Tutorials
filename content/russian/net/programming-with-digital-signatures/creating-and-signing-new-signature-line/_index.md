---
title: Создание и подписание новой строки подписи
linktitle: Создание и подписание новой строки подписи
second_title: API обработки документов Aspose.Words
description: Узнайте, как создать и поставить цифровую подпись в строке подписи в документе Word с помощью Aspose.Words для .NET, с помощью этого пошагового руководства. Идеально подходит для автоматизации документооборота.
type: docs
weight: 10
url: /ru/net/programming-with-digital-signatures/creating-and-signing-new-signature-line/
---
## Введение

Привет! Итак, у вас есть документ Word, и вам нужно добавить строку подписи, а затем подписать его цифровой подписью. Звучит сложно? Нисколько! Благодаря Aspose.Words для .NET вы можете легко добиться этого, написав всего несколько строк кода. В этом уроке мы проведем вас через весь процесс: от настройки среды до сохранения документа с новой блестящей подписью. Готовый? Давайте погрузимся!

## Предварительные условия

Прежде чем мы перейдем к коду, давайте убедимся, что у вас есть все необходимое:
1.  Aspose.Words для .NET – вы можете[скачай это здесь](https://releases.aspose.com/words/net/).
2. Среда разработки .NET — настоятельно рекомендуется использовать Visual Studio.
3. Документ для подписи. Создайте простой документ Word или используйте существующий.
4.  Файл сертификата — необходим для цифровых подписей. Вы можете использовать`.pfx` файл.
5. Изображения для строки подписи — опционально файл изображения для подписи.

## Импортировать пространства имен

Во-первых, нам нужно импортировать необходимые пространства имен. Этот шаг имеет решающее значение, поскольку он настраивает среду для использования функций Aspose.Words.

```csharp
using System;
using System.IO;
using Aspose.Words;
using Aspose.Words.Drawing;
using Aspose.Words.Saving;
using Aspose.Words.Signing;
```

## Шаг 1. Настройка каталога документов

Любой проект нуждается в хорошем начале. Давайте настроим путь к каталогу ваших документов. Здесь ваши документы будут сохранены и восстановлены.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## Шаг 2. Создание нового документа

Теперь давайте создадим новый документ Word, используя Aspose.Words. Это будет наш холст, на котором мы добавим строку подписи.

```csharp
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## Шаг 3. Вставка строки подписи

 Вот где происходит волшебство. Вставляем строку подписи в наш документ с помощью`DocumentBuilder` сорт.

```csharp
SignatureLine signatureLine = builder.InsertSignatureLine(new SignatureLineOptions()).SignatureLine;
```

## Шаг 4. Сохранение документа со строкой подписи

Как только строка подписи будет на месте, нам нужно сохранить документ. Это промежуточный шаг, прежде чем мы приступим к его подписанию.

```csharp
doc.Save(dataDir + "SignDocuments.SignatureLine.docx");
```

## Шаг 5. Настройка параметров подписи

Теперь давайте настроим параметры подписания документа. Сюда входит указание идентификатора строки подписи и изображения, которое будет использоваться.

```csharp
SignOptions signOptions = new SignOptions
{
    SignatureLineId = signatureLine.Id,
    SignatureLineImage = File.ReadAllBytes(dataDir + "Enhanced Windows MetaFile.emf")
};
```

## Шаг 6. Загрузка сертификата

Цифровые подписи требуют сертификата. Здесь мы загружаем файл сертификата, который будет использоваться для подписи документа.

```csharp
CertificateHolder certHolder = CertificateHolder.Create(dataDir + "morzal.pfx", "aw");
```

## Шаг 7: Подписание документа

 Это последний шаг. Мы используем`DigitalSignatureUtil`класс для подписания документа. Подписанный документ сохраняется под новым именем.

```csharp
DigitalSignatureUtil.Sign(dataDir + "SignDocuments.SignatureLine.docx",
    dataDir + "SignDocuments.NewSignatureLine.docx", certHolder, signOptions);
```

## Заключение

И вот оно! Выполняя эти шаги, вы успешно создали новый документ Word, добавили строку подписи и подписали его цифровой подписью с помощью Aspose.Words для .NET. Это мощный инструмент, который упрощает автоматизацию документов. Независимо от того, имеете ли вы дело с контрактами, соглашениями или любыми официальными документами, этот метод гарантирует, что они надежно подписаны и проверены.

## Часто задаваемые вопросы

### Могу ли я использовать другие форматы изображений для строки подписи?
Да, вы можете использовать различные форматы изображений, такие как PNG, JPG, BMP и т. д.

###  Необходимо ли использовать`.pfx` file for the certificate?
 Да, а`.pfx` file — это распространенный формат для хранения криптографической информации, включая сертификаты и закрытые ключи.

### Могу ли я добавить несколько строк подписи в один документ?
Абсолютно! Вы можете вставить несколько строк подписи, повторив шаг вставки для каждой подписи.

### Что делать, если у меня нет цифрового сертификата?
Вам потребуется получить цифровой сертификат от доверенного центра сертификации или создать его с помощью таких инструментов, как OpenSSL.

### Как проверить цифровую подпись в документе?
Вы можете открыть подписанный документ в Word и перейти к сведениям о подписи, чтобы проверить подлинность и целостность подписи.