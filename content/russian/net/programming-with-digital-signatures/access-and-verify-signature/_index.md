---
title: Доступ и проверка подписи в документе Word
linktitle: Доступ и проверка подписи в документе Word
second_title: API обработки документов Aspose.Words
description: Получите доступ к цифровым подписям в документах Word и проверьте их с помощью Aspose.Words for .NET с помощью этого подробного пошагового руководства. Обеспечьте подлинность документа без особых усилий.
type: docs
weight: 10
url: /ru/net/programming-with-digital-signatures/access-and-verify-signature/
---
## Введение

Привет, коллеги-энтузиасты технологий! Вы когда-нибудь оказывались в ситуации, когда вам нужно было получить доступ к цифровым подписям в документе Word и проверить их, но вы не знали, с чего начать? Что ж, вам повезло! Сегодня мы погружаемся в чудесный мир Aspose.Words for .NET, мощной библиотеки, которая упрощает работу с документами Word. Мы проведем вас через этот процесс шаг за шагом, поэтому к концу этого руководства вы станете профессионалом в проверке цифровых подписей в документах Word. Давайте начнем!

## Предварительные условия

Прежде чем мы углубимся в мельчайшие детали, вам необходимо иметь в виду несколько вещей:

1. Visual Studio: убедитесь, что на вашем компьютере установлена Visual Studio. Здесь вы будете писать и запускать свой код.
2.  Aspose.Words для .NET: вам необходимо установить Aspose.Words для .NET. Вы можете скачать его[здесь](https://releases.aspose.com/words/net/) . Не забудьте получить бесплатную пробную версию[здесь](https://releases.aspose.com/) если вы еще этого не сделали!
3. Документ Word с цифровой подписью. Имейте документ Word, уже имеющий цифровую подпись. Это файл, с которым вы будете работать для проверки подписей.

## Импортировать пространства имен

Прежде всего, давайте импортируем необходимые пространства имен. Эти пространства имен позволят вам использовать функции Aspose.Words в вашем проекте.

```csharp
using System;
using Aspose.Words;
using Aspose.Words.DigitalSignatures;
```

Хорошо, давайте разобьем это на выполнимые шаги. Каждый шаг проведет вас через определенную часть процесса. Готовый? Пойдем!

## Шаг 1. Настройте свой проект

Прежде чем вы сможете проверить цифровую подпись, вам необходимо настроить проект в Visual Studio. Вот как:

### Создать новый проект

1. Откройте Visual Studio.
2. Нажмите «Создать новый проект».
3. Выберите консольное приложение (.NET Core) или консольное приложение (.NET Framework) в зависимости от ваших предпочтений.
4. Нажмите «Далее», дайте своему проекту имя и нажмите «Создать».

### Установите Aspose.Words для .NET.

1. В обозревателе решений щелкните правой кнопкой мыши имя проекта и выберите «Управление пакетами NuGet».
2. В диспетчере пакетов NuGet найдите Aspose.Words.
3. Нажмите «Установить», чтобы добавить его в свой проект.

## Шаг 2. Загрузите документ Word с цифровой подписью

Теперь, когда ваш проект настроен, давайте загрузим документ Word с цифровой подписью.

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document doc = new Document(dataDir + "Digitally signed.docx");
```

 Заменять`"YOUR DOCUMENT DIRECTORY"` с фактическим путем к каталогу вашего документа. Этот фрагмент кода инициализирует новый`Document` объект и загружает подписанный документ Word.

## Шаг 3. Получите доступ к цифровым подписям

Когда ваш документ загружен, пришло время получить доступ к цифровым подписям.

```csharp
foreach (DigitalSignature signature in doc.DigitalSignatures)
{
    Console.WriteLine("* Signature Found *");
    Console.WriteLine("Is valid: " + signature.IsValid);
    Console.WriteLine("Reason for signing: " + signature.Comments); 
    Console.WriteLine("Time of signing: " + signature.SignTime);
    Console.WriteLine("Subject name: " + signature.CertificateHolder.Certificate.SubjectName.Name);
    Console.WriteLine("Issuer name: " + signature.CertificateHolder.Certificate.IssuerName.Name);
    Console.WriteLine();
}
```

Этот код проходит через каждую цифровую подпись в документе и распечатывает различные сведения о подписи. Давайте разберем, что делает каждая часть:

1. Подпись найдена: указывает, что подпись найдена.
2. Действительна: проверяет, действительна ли подпись.
3. Причина подписания: отображает причину подписания, если она доступна.
4. Время подписания: показывает время подписания документа.
5. Имя субъекта: извлекает имя субъекта из сертификата.
6. Имя эмитента: извлекает имя эмитента из сертификата.

## Шаг 4. Запустите свой код

Когда все настроено, пришло время запустить код и увидеть результаты.


1. Нажмите F5 или кнопку «Пуск» в Visual Studio, чтобы запустить программу.
2. Если ваш документ подписан цифровой подписью, вы увидите данные подписи, напечатанные в консоли.

## Шаг 5. Обработка потенциальных ошибок

Всегда полезно устранять любые потенциальные ошибки, которые могут возникнуть. Давайте добавим в наш код базовую обработку ошибок.

```csharp
try
{
    // Путь к каталогу документов.
    string dataDir = "YOUR DOCUMENT DIRECTORY";
    Document doc = new Document(dataDir + "Digitally signed.docx");

    foreach (DigitalSignature signature in doc.DigitalSignatures)
    {
        Console.WriteLine("* Signature Found *");
        Console.WriteLine("Is valid: " + signature.IsValid);
        Console.WriteLine("Reason for signing: " + signature.Comments); 
        Console.WriteLine("Time of signing: " + signature.SignTime);
        Console.WriteLine("Subject name: " + signature.CertificateHolder.Certificate.SubjectName.Name);
        Console.WriteLine("Issuer name: " + signature.CertificateHolder.Certificate.IssuerName.Name);
        Console.WriteLine();
    }
}
catch (Exception ex)
{
    Console.WriteLine("An error occurred: " + ex.Message);
}
```

Это позволит отловить любые исключения, которые могут возникнуть, и вывести сообщение об ошибке.

## Заключение

И вот оно! Вы успешно получили доступ к цифровым подписям в документе Word и проверили их с помощью Aspose.Words for .NET. Это не так сложно, как кажется, правда? С помощью этих шагов вы сможете уверенно обращаться с цифровыми подписями в документах Word, гарантируя их подлинность и целостность. Приятного кодирования!

## Часто задаваемые вопросы

### Могу ли я использовать Aspose.Words для .NET для добавления цифровых подписей в документ Word?

Да, вы можете использовать Aspose.Words для .NET для добавления цифровых подписей в документы Word. Библиотека предоставляет комплексные возможности как для добавления, так и для проверки цифровых подписей.

### Какие типы цифровых подписей можно проверить с помощью Aspose.Words for .NET?

Aspose.Words for .NET может проверять цифровые подписи в файлах DOCX, использующих сертификаты X.509.

### Совместим ли Aspose.Words для .NET со всеми версиями Microsoft Word?

Aspose.Words for .NET поддерживает все версии документов Microsoft Word, включая DOC, DOCX, RTF и другие.

### Как получить временную лицензию на Aspose.Words для .NET?

 Вы можете получить временную лицензию на Aspose.Words для .NET на сайте[здесь](https://purchase.aspose.com/temporary-license/). Это позволяет вам опробовать все возможности библиотеки без каких-либо ограничений.

### Где я могу найти дополнительную документацию по Aspose.Words для .NET?

 Вы можете найти подробную документацию по Aspose.Words для .NET.[здесь](https://reference.aspose.com/words/net/).