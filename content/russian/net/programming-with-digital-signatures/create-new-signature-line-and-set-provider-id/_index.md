---
title: Создать новую строку подписи и задать идентификатор поставщика
linktitle: Создать новую строку подписи и задать идентификатор поставщика
second_title: API обработки документов Aspose.Words
description: Узнайте, как создать новую строку подписи и задать идентификатор поставщика в документах Word с помощью Aspose.Words для .NET. Пошаговое руководство.
type: docs
weight: 10
url: /ru/net/programming-with-digital-signatures/create-new-signature-line-and-set-provider-id/
---
## Введение

Привет, энтузиасты технологий! Вы когда-нибудь задумывались, как добавить строку подписи в документы Word программным способом? Что ж, сегодня мы погрузимся именно в это с помощью Aspose.Words для .NET. Это руководство проведет вас через каждый шаг, делая создание новой строки подписи и установку идентификатора поставщика в документах Word максимально простым. Независимо от того, автоматизируете ли вы обработку документов или просто хотите оптимизировать свой рабочий процесс, это руководство поможет вам.

## Предпосылки

Прежде чем приступить к работе, давайте убедимся, что у нас есть все необходимое:

1.  Aspose.Words для .NET: если вы еще этого не сделали, загрузите его[здесь](https://releases.aspose.com/words/net/).
2. Среда разработки: Visual Studio или любая другая среда разработки C#.
3. .NET Framework: Убедитесь, что у вас установлен .NET Framework.
4. Сертификат PFX: Для подписи документов вам понадобится сертификат PFX. Вы можете получить его в доверенном центре сертификации.

## Импорт пространств имен

Для начала давайте импортируем необходимые пространства имен в ваш проект C#:

```csharp
using Aspose.Words;
using Aspose.Words.Drawing;
using Aspose.Words.Signing;
using System;
```

Хорошо, давайте перейдем к сути. Вот подробное описание каждого шага по созданию новой строки подписи и установке идентификатора поставщика.

## Шаг 1: Создайте новый документ

Для начала нам нужно создать новый документ Word. Это будет холст для нашей строки подписи.

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

 В этом фрагменте мы инициализируем новый`Document` и а`DocumentBuilder` .`DocumentBuilder` помогает нам добавлять элементы в наш документ.

## Шаг 2: Определите параметры строки подписи

Далее мы определяем параметры для нашей строки подписи. Сюда входят имя подписавшего, должность, адрес электронной почты и другие данные.

```csharp
SignatureLineOptions signatureLineOptions = new SignatureLineOptions
{
    Signer = "vderyushev",
    SignerTitle = "QA",
    Email = "vderyushev@aspose.com",
    ShowDate = true,
    DefaultInstructions = false,
    Instructions = "Please sign here.",
    AllowComments = true
};
```

Эти опции персонализируют строку подписи, делая ее четкой и профессиональной.

## Шаг 3: Вставьте строку подписи

Установив все необходимые параметры, мы можем вставить строку подписи в документ.

```csharp
SignatureLine signatureLine = builder.InsertSignatureLine(signatureLineOptions).SignatureLine;
signatureLine.ProviderId = Guid.Parse("CF5A7BB4-8F3C-4756-9DF6-BEF7F13259A2");
```

 Здесь,`InsertSignatureLine` Метод добавляет строку подписи, и мы присваиваем ей уникальный идентификатор провайдера.

## Шаг 4: Сохраните документ.

После вставки строки подписи сохраним документ.

```csharp
doc.Save(dataDir + "SignDocuments.SignatureLineProviderId.docx");
```

Это сохранит ваш документ с новой добавленной строкой подписи.

## Шаг 5: Настройте параметры подписи

Теперь нам нужно настроить параметры для подписания документа. Сюда входят идентификатор строки подписи, идентификатор поставщика, комментарии и время подписания.

```csharp
SignOptions signOptions = new SignOptions
{
    SignatureLineId = signatureLine.Id,
    ProviderId = signatureLine.ProviderId,
    Comments = "Document was signed by vderyushev",
    SignTime = DateTime.Now
};
```

Эти параметры гарантируют, что документ подписан с правильными данными.

## Шаг 6: Создайте держателя сертификата

Для подписи документа будем использовать PFX-сертификат. Создадим для него держателя сертификата.

```csharp
CertificateHolder certHolder = CertificateHolder.Create(dataDir + "morzal.pfx", "aw");
```

 Обязательно замените`"morzal.pfx"` с вашим фактическим файлом сертификата и`"aw"` с паролем вашего сертификата.

## Шаг 7: Подпишите документ

Наконец, мы подписываем документ с помощью утилиты цифровой подписи.

```csharp
DigitalSignatureUtil.Sign(dataDir + "SignDocuments.SignatureLineProviderId.docx", 
    dataDir + "SignDocuments.CreateNewSignatureLineAndSetProviderId.docx", certHolder, signOptions);
```

Это подпишет документ и сохранит его как новый файл.

## Заключение

И вот оно! Вы успешно создали новую строку подписи и установили идентификатор поставщика в документе Word с помощью Aspose.Words для .NET. Эта мощная библиотека невероятно упрощает управление и автоматизацию задач обработки документов. Попробуйте и посмотрите, как она может оптимизировать ваш рабочий процесс.

## Часто задаваемые вопросы

### Могу ли я настроить внешний вид строки подписи?
 Конечно! Вы можете настроить различные параметры в`SignatureLineOptions`в соответствии с вашими потребностями.

### Что делать, если у меня нет сертификата PFX?
Вам нужно будет получить его от доверенного центра сертификации. Это необходимо для цифровой подписи документов.

### Могу ли я добавить в документ несколько строк подписи?
Да, вы можете добавить столько строк подписи, сколько необходимо, повторяя процесс вставки с различными параметрами.

### Совместим ли Aspose.Words для .NET с .NET Core?
Да, Aspose.Words для .NET поддерживает .NET Core, что делает его универсальным для различных сред разработки.

### Насколько безопасны цифровые подписи?
Цифровые подписи, созданные с помощью Aspose.Words, обладают высокой степенью безопасности при условии использования действительного и доверенного сертификата.