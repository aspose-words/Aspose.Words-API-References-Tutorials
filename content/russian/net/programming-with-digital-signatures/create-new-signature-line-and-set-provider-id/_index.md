---
title: Создайте новую строку подписи и установите идентификатор поставщика
linktitle: Создайте новую строку подписи и установите идентификатор поставщика
second_title: API обработки документов Aspose.Words
description: Узнайте, как создать новую строку подписи и установить идентификатор поставщика в документах Word с помощью Aspose.Words для .NET. Пошаговое руководство.
type: docs
weight: 10
url: /ru/net/programming-with-digital-signatures/create-new-signature-line-and-set-provider-id/
---
## Введение

Привет, любители технологий! Вы когда-нибудь задумывались, как программно добавить строку подписи в документы Word? Что ж, сегодня мы углубимся именно в это, используя Aspose.Words для .NET. Это руководство проведет вас через каждый шаг, упрощая создание новой строки подписи и установку идентификатора поставщика в документах Word. Независимо от того, автоматизируете ли вы обработку документов или просто хотите оптимизировать рабочий процесс, это руководство поможет вам.

## Предварительные условия

Прежде чем мы запачкаем руки, давайте убедимся, что у нас есть все необходимое:

1.  Aspose.Words для .NET: загрузите его, если вы еще этого не сделали.[здесь](https://releases.aspose.com/words/net/).
2. Среда разработки: Visual Studio или любая другая среда разработки C#.
3. .NET Framework: убедитесь, что у вас установлена .NET Framework.
4. Сертификат PFX. Для подписания документов вам понадобится сертификат PFX. Вы можете получить его в доверенном центре сертификации.

## Импортировать пространства имен

Прежде всего, давайте импортируем необходимые пространства имен в ваш проект C#:

```csharp
using Aspose.Words;
using Aspose.Words.Drawing;
using Aspose.Words.Signing;
using System;
```

Хорошо, давайте перейдем к мелочам. Ниже приведено подробное описание каждого шага по созданию новой строки подписи и установке идентификатора поставщика.

## Шаг 1. Создайте новый документ

Для начала нам нужно создать новый документ Word. Это будет холст для нашей фирменной линии.

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

 В этом фрагменте мы инициализируем новый`Document` и`DocumentBuilder` .`DocumentBuilder` помогает нам добавлять элементы в наш документ.

## Шаг 2. Определите параметры строки подписи

Далее мы определяем параметры нашей строки подписи. Сюда входят имя, должность, адрес электронной почты и другие данные подписывающего лица.

```csharp
SignatureLineOptions signatureLineOptions = new SignatureLineOptions
{
    Signer = "vderyushev",
    SignerTitle = "QA",
    Email = "vderyushev@aspose.com",
    ShowDate = true,
    DefaultInstructions = false,
    Instructions = "Please sign here.",
    AllowComments = true
};
```

Эти параметры персонализируют линию подписи, делая ее четкой и профессиональной.

## Шаг 3. Вставьте строку подписи.

Теперь, когда наши параметры установлены, мы можем вставить строку подписи в документ.

```csharp
SignatureLine signatureLine = builder.InsertSignatureLine(signatureLineOptions).SignatureLine;
signatureLine.ProviderId = Guid.Parse("CF5A7BB4-8F3C-4756-9DF6-BEF7F13259A2");
```

 Здесь`InsertSignatureLine` Метод добавляет строку подписи, и мы присваиваем ей уникальный идентификатор провайдера.

## Шаг 4. Сохраните документ

После вставки строки подписи сохраним документ.

```csharp
doc.Save(dataDir + "SignDocuments.SignatureLineProviderId.docx");
```

Это сохранит ваш документ с новой добавленной строкой подписи.

## Шаг 5. Настройте параметры подписи

Теперь нам нужно настроить параметры подписания документа. Сюда входят идентификатор строки подписи, идентификатор поставщика, комментарии и время подписи.

```csharp
SignOptions signOptions = new SignOptions
{
    SignatureLineId = signatureLine.Id,
    ProviderId = signatureLine.ProviderId,
    Comments = "Document was signed by vderyushev",
    SignTime = DateTime.Now
};
```

Эти параметры гарантируют, что документ будет подписан с указанием правильных данных.

## Шаг 6. Создайте владельца сертификата

Чтобы подписать документ, мы будем использовать сертификат PFX. Давайте создадим для него держателя сертификата.

```csharp
CertificateHolder certHolder = CertificateHolder.Create(dataDir + "morzal.pfx", "aw");
```

 Обязательно замените`"morzal.pfx"` с вашим фактическим файлом сертификата и`"aw"` с паролем вашего сертификата.

## Шаг 7: Подпишите документ

Наконец, мы подписываем документ с помощью утилиты цифровой подписи.

```csharp
DigitalSignatureUtil.Sign(dataDir + "SignDocuments.SignatureLineProviderId.docx", 
    dataDir + "SignDocuments.CreateNewSignatureLineAndSetProviderId.docx", certHolder, signOptions);
```

Это подпишет документ и сохранит его как новый файл.

## Заключение

И вот оно! Вы успешно создали новую строку подписи и установили идентификатор поставщика в документе Word с помощью Aspose.Words для .NET. Эта мощная библиотека позволяет невероятно легко управлять задачами по обработке документов и автоматизировать их. Попробуйте и посмотрите, как он может упростить ваш рабочий процесс.

## Часто задаваемые вопросы

### Могу ли я настроить внешний вид строки подписи?
Абсолютно! Вы можете настроить различные параметры в`SignatureLineOptions` в соответствии с вашими потребностями.

### Что делать, если у меня нет сертификата PFX?
Вам необходимо получить его в доверенном центре сертификации. Это важно для цифровой подписи документов.

### Могу ли я добавить в документ несколько строк подписи?
Да, вы можете добавить столько строк подписи, сколько необходимо, повторяя процесс вставки с разными вариантами.

### Совместим ли Aspose.Words для .NET с .NET Core?
Да, Aspose.Words for .NET поддерживает .NET Core, что делает его универсальным для различных сред разработки.

### Насколько безопасны цифровые подписи?
Цифровые подписи, созданные с помощью Aspose.Words, имеют высокий уровень безопасности при условии, что вы используете действительный и надежный сертификат.