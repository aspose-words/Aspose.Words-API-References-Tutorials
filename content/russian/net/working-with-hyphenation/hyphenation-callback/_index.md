---
title: Обратный вызов расстановки переносов
linktitle: Обратный вызов расстановки переносов
second_title: API обработки документов Aspose.Words
description: Узнайте, как реализовать обратный вызов расстановки переносов в Aspose.Words для .NET, чтобы улучшить форматирование документов, с помощью этого подробного пошагового руководства.
type: docs
weight: 10
url: /ru/net/working-with-hyphenation/hyphenation-callback/
---

## Введение

Привет! Вы когда-нибудь сталкивались со сложностями форматирования текста, особенно при работе с языками, требующими расстановки переносов? Ты не один. Расстановка переносов, хотя и имеет решающее значение для правильной компоновки текста, может вызывать головную боль. Но знаете что? Aspose.Words для .NET поможет вам. Эта мощная библиотека позволяет легко управлять форматированием текста, включая обработку переносов с помощью механизма обратного вызова. Заинтригованы? Давайте углубимся в подробности того, как можно реализовать обратный вызов расстановки переносов с помощью Aspose.Words для .NET.

## Предварительные условия

Прежде чем мы запачкаем руки кодом, давайте убедимся, что у вас есть все необходимое:

1.  Aspose.Words для .NET: убедитесь, что у вас есть библиотека. Ты можешь[скачай это здесь](https://releases.aspose.com/words/net/).
2. IDE: среда разработки, такая как Visual Studio.
3. Базовые знания C#: Понимание C# и .NET framework.
4. Словари расстановки переносов: словари расстановки переносов для языков, которые вы планируете использовать.
5.  Лицензия Aspose: действующая лицензия Aspose. Вы можете получить[временная лицензия](https://purchase.aspose.com/temporary-license/) если у вас его нет.

## Импортировать пространства имен

Прежде всего, давайте импортируем необходимые пространства имен. Это гарантирует, что наш код будет иметь доступ ко всем классам и методам, которые нам нужны из Aspose.Words.

```csharp
using Aspose.Words;
using System;
using System.IO;
```

## Шаг 1. Зарегистрируйте обратный вызов расстановки переносов

Для начала нам нужно зарегистрировать обратный вызов расстановки переносов. Здесь мы говорим Aspose.Words использовать нашу собственную логику расстановки переносов.

```csharp
try
{
    // Зарегистрируйте обратный вызов расстановки переносов.
    Hyphenation.Callback = new CustomHyphenationCallback();
}
catch (Exception e)
{
    Console.WriteLine($"Error registering hyphenation callback: {e.Message}");
}
```

 Здесь мы создаем экземпляр нашего пользовательского обратного вызова и назначаем его`Hyphenation.Callback`.

## Шаг 2. Определите путь к документу

Далее нам нужно определить каталог, в котором хранятся наши документы. Это очень важно, поскольку мы будем загружать и сохранять документы по этому пути.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

 Заменять`"YOUR DOCUMENT DIRECTORY"` с фактическим путем к вашим документам.

## Шаг 3. Загрузите документ

Теперь давайте загрузим документ, требующий расстановки переносов.

```csharp
Document document = new Document(dataDir + "German text.docx");
```

 Здесь мы загружаем текстовый документ на немецком языке. Вы можете заменить`"German text.docx"` с именем файла вашего документа.

## Шаг 4. Сохраните документ

После загрузки документа мы сохраняем его в новый файл, применяя при этом обратный вызов расстановки переносов.

```csharp
document.Save(dataDir + "TreatmentByCesureWithRecall.pdf");
```

Эта строка сохраняет документ в формате PDF с применением расстановки переносов.

## Шаг 5. Обработка исключения в словаре отсутствующих переносов

Иногда вы можете столкнуться с проблемой отсутствия словаря расстановки переносов. Давайте разберемся с этим.

```csharp
catch (Exception e) when (e.Message.StartsWith("Missing hyphenation dictionary"))
{
    Console.WriteLine(e.Message);
}
finally
{
    Hyphenation.Callback = null;
}
```

В этом блоке мы перехватываем конкретное исключение, связанное с отсутствующими словарями, и печатаем сообщение.

## Шаг 6. Реализация пользовательского класса обратного вызова расстановки переносов

 Теперь давайте реализуем`CustomHyphenationCallback` класс, который обрабатывает запрос словарей расстановки переносов.

```csharp
public class CustomHyphenationCallback : IHyphenationCallback
{
    public void RequestDictionary(string language)
    {
        string dictionaryFolder = MyDir;
        string dictionaryFullFileName;
        switch (language)
        {
            case "en-US":
                dictionaryFullFileName = Path.Combine(dictionaryFolder, "hyph_en_US.dic");
                break;
            case "de-CH":
                dictionaryFullFileName = Path.Combine(dictionaryFolder, "hyph_de_CH.dic");
                break;
            default:
                throw new Exception($"Missing hyphenation dictionary for {language}.");
        }
        // Зарегистрируйте словарь для запрошенного языка.
        Hyphenation.RegisterDictionary(language, dictionaryFullFileName);
    }
}
```

 В этом классе`RequestDictionary` Метод вызывается всякий раз, когда необходим словарь расстановки переносов. Он проверяет язык и регистрирует соответствующий словарь.

## Заключение

И вот оно! Вы только что узнали, как реализовать обратный вызов расстановки переносов в Aspose.Words для .NET. Следуя этим шагам, вы сможете обеспечить красивое форматирование своих документов независимо от языка. Независимо от того, имеете ли вы дело с английским, немецким или любым другим языком, этот метод позволяет вам легко расставлять переносы.

## Часто задаваемые вопросы

### Что такое Aspose.Words для .NET?
Aspose.Words for .NET — это мощная библиотека для работы с документами, которая позволяет разработчикам программно создавать, изменять и конвертировать документы.

### Почему расстановка переносов важна при форматировании документа?
Расстановка переносов улучшает компоновку текста, разбивая слова в нужных местах, делая документ более читабельным и визуально привлекательным.

### Могу ли я использовать Aspose.Words бесплатно?
 Aspose.Words предлагает бесплатную пробную версию. Ты можешь его достать[здесь](https://releases.aspose.com/).

### Как получить словарь расстановки переносов?
Словари расстановки переносов можно скачать с различных интернет-ресурсов или при необходимости создать свои.

### Что произойдет, если словарь расстановки переносов отсутствует?
 Если словарь отсутствует,`RequestDictionary` Метод генерирует исключение, которое вы можете обработать, чтобы проинформировать пользователя или предоставить резервный вариант.