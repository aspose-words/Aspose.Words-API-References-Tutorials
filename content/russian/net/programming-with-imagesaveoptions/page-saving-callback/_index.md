---
title: Обратный вызов при сохранении страницы
linktitle: Обратный вызов при сохранении страницы
second_title: API обработки документов Aspose.Words
description: Узнайте, как настроить сохранение страниц документа в изображения с помощью Aspose.Words для .NET.
type: docs
weight: 10
url: /ru/net/programming-with-imagesaveoptions/page-saving-callback/
---

В этом руководстве мы рассмотрим исходный код C#, предоставленный для использования обратного вызова сохранения страницы с параметрами сохранения изображений Aspose.Words для .NET. Эта функция позволяет выполнять дополнительные действия при сохранении каждой страницы документа в виде изображения.

## Шаг 1. Настройка среды

Прежде чем начать, убедитесь, что вы настроили свою среду разработки с помощью Aspose.Words для .NET. Убедитесь, что вы добавили необходимые ссылки и импортировали соответствующие пространства имен.

## Шаг 2: Загрузка документа

```csharp
// Путь к каталогу ваших документов
string dataDir = "YOUR DOCUMENTS DIRECTORY";

Document doc = new Document(dataDir + "Rendering.docx");
```

 На этом этапе мы загружаем документ, используя`Document` метод и передав путь к файлу DOCX для загрузки.

## Шаг 3. Настройте параметры резервного копирования образа

```csharp
ImageSaveOptions imageSaveOptions = new ImageSaveOptions(SaveFormat.Png)
{
     PageSet = new PageSet(new PageRange(0, doc.PageCount - 1)),
     PageSavingCallback = new HandlePageSavingCallback()
};
```

 На этом этапе мы настраиваем параметры сохранения изображения, создавая новый файл.`ImageSaveOptions` объект. Указываем нужный формат резервной копии, здесь «Png» для формата PNG. Мы используем`PageSet` чтобы указать диапазон страниц для сохранения, здесь от первой страницы до последней страницы документа (`doc.PageCount - 1`). Мы также установили`PageSavingCallback` к экземпляру`HandlePageSavingCallback`, который представляет собой специальный класс для обработки обратного вызова сохранения страницы.

## Шаг 4. Реализация обратного вызова страницы сохранения

```csharp
public class HandlePageSavingCallback : IPageSavingCallback
{
     public void PageSaving(PageSavingArgs args)
     {
         // Реализуйте свои пользовательские действия здесь
         // Вы можете получить доступ к информации о странице через свойство args.PageIndex.
         // Вы также можете изменить параметры сохранения для каждой страницы индивидуально.
     }
}
```

 На этом этапе мы реализуем`HandlePageSavingCallback` класс, который реализует`IPageSavingCallback` интерфейс. Вы можете настроить этот класс, добавив свои конкретные действия в`PageSaving` метод. Вы можете получить доступ к информации о странице через`args.PageIndex` собственность`PageSavingArgs` объект, переданный в качестве аргумента.

## Шаг 5. Сохранение страниц в виде изображений

```csharp
doc.Save(dataDir + "WorkingWithImageSaveOptions.PageSavingCallback.png", imageSaveOptions);
```

 На этом последнем этапе мы сохраняем каждую страницу документа как изображение, используя`Save` метод и передавая путь к выходному файлу с помощью`.png` расширение вместе с указанными параметрами сохранения.

Теперь вы можете запускать исходный код для выполнения дополнительных действий при сохранении каждой страницы документа в виде изображения. Полученный файл будет сохранен в указанном каталоге с именем «WorkingWithImageSaveOptions.PageSavingCallback.png».

### Пример исходного кода для обратного вызова сохранения страницы с использованием Aspose.Words для .NET


```csharp 
//Путь к каталогу ваших документов
string dataDir = "YOUR DOCUMENT DIRECTORY"; 


Document doc = new Document(dataDir + "Rendering.docx");

ImageSaveOptions imageSaveOptions = new ImageSaveOptions(SaveFormat.Png)
{
	PageSet = new PageSet(new PageRange(0, doc.PageCount - 1)),
	PageSavingCallback = new HandlePageSavingCallback()
};

doc.Save(dataDir + "WorkingWithImageSaveOptions.PageSavingCallback.png", imageSaveOptions);
        
```

## Заключение

В этом руководстве мы рассмотрели функцию обратного вызова сохранения страницы с параметрами сохранения изображений Aspose.Words для .NET. Мы узнали, как выполнять специальные действия при сохранении каждой страницы документа в виде изображения.

Эта функция полезна, если вы хотите выполнить определенные операции на каждой странице при преобразовании в изображения. Вы можете получить доступ к информации о странице и использовать ее для настройки параметров резервного копирования или выполнения другой обработки, специфичной для страницы.

Aspose.Words for .NET предлагает широкий спектр расширенных функций для манипулирования и создания документов. Напоминание о сохранении страницы — один из многих мощных инструментов, позволяющих настроить процесс сохранения страниц в изображениях.