---
title: Вставить документ при замене
linktitle: Вставить документ при замене
second_title: API обработки документов Aspose.Words
description: Узнайте, как вставить документ при замене с помощью Aspose.Words для .NET.
type: docs
weight: 10
url: /ru/net/clone-and-combine-documents/insert-document-at-replace/
---
В этом уроке мы покажем вам, как вставить документ в другой документ при замене с помощью функции «Вставить документ при замене» в Aspose.Words для .NET. Выполните следующие действия, чтобы понять исходный код и выполнить вставку документа.

## Шаг 1: Загрузка основного документа

Для начала укажите каталог для ваших документов и загрузите основной документ в объект Document. Вот как:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENTS DIRECTORY";
Document mainDoc = new Document(MyDir + "Document insert 1.docx");
```

## Шаг 2. Настройте параметры поиска и замены

Теперь мы настроим параметры поиска и замены, указав направление поиска и обратный вызов замены для вставки документа в другой документ. Вот как:

```csharp
// Настройте параметры поиска и замены.
FindReplaceOptions options = new FindReplaceOptions
{
Direction = FindReplaceDirection.Backward,
ReplacingCallback = new InsertDocumentAtReplaceHandler()
};
```

## Шаг 3. Вызов метода замены

Теперь мы вызовем метод replace, чтобы найти и заменить указанный текст пустой строкой, используя настроенные параметры. Вот как:

```csharp
mainDoc.Range.Replace(new Regex("\\[MY_DOCUMENT\\]"), "", options);
mainDoc.Save(dataDir + "CloneAndCombineDocuments.InsertDocumentAtReplace.docx");
```

### Пример исходного кода для вставки документа при замене с использованием Aspose.Words для .NET

Вот полный исходный код функции «Вставка документа» при замене Aspose.Words на .NET:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document mainDoc = new Document(MyDir + "Document insertion 1.docx");

// Установите параметры поиска и замены.
FindReplaceOptions options = new FindReplaceOptions
{
	Direction = FindReplaceDirection.Backward, 
	ReplacingCallback = new InsertDocumentAtReplaceHandler()
};

// Вызовите метод замены.
mainDoc.Range.Replace(new Regex("\\[MY_DOCUMENT\\]"), "", options);
mainDoc.Save(dataDir + "CloneAndCombineDocuments.InsertDocumentAtReplace.docx");
```

## Заключение

В этом руководстве мы рассмотрели, как вставить документ в другой документ во время замены с помощью функции «Вставить документ при замене» в Aspose.Words для .NET. Настроив параметры поиска и замены и предоставив необходимые данные, вы можете динамически собирать документы, заменяя определенные заполнители содержимым других шаблонов или разделов документов. Aspose.Words для .NET предлагает мощный и гибкий способ управления сложными задачами по манипулированию документами, что делает его ценным инструментом для автоматизации сценариев создания документов и вставки контента.

### Часто задаваемые вопросы

#### Вопрос: Какова цель вставки документа в другой документ во время замены?

О: Вставка документа в другой документ во время замены позволяет динамически заменять определенный заполнитель содержимым отдельного документа. Эта функция особенно полезна, когда вы хотите собрать более крупный документ, объединив различные предварительно определенные шаблоны или разделы документов в определенные заполнители.

#### Вопрос: Как вставить документ в другой документ во время замены с помощью Aspose.Words for .NET?

О: Чтобы вставить документ в другой документ во время замены с помощью Aspose.Words for .NET, выполните следующие действия:
1. Загрузите основной документ, содержащий заполнители, в объект Document.
2. Настройте параметры поиска и замены, включая направление поиска и обратный вызов замены для обработки вставки документа.
3. Вызовите метод replace с соответствующим шаблоном поиска, заменив заполнители пустой строкой, используя настроенные параметры.

#### Вопрос: Могу ли я настроить поведение вставки во время замены?

О: Да, вы можете настроить поведение вставки во время замены, реализовав собственный ReplacingCallback. Наследуя интерфейс IReplacingCallback, вы можете управлять тем, как документы вставляются и объединяются в соответствии с вашими конкретными требованиями при замене заполнителей.

#### Вопрос: Могу ли я заменить несколько заполнителей разными документами?

О: Да, вы можете заменить несколько заполнителей разными документами, указав соответствующие шаблоны поиска для каждого заполнителя и предоставив соответствующие документы для вставки.