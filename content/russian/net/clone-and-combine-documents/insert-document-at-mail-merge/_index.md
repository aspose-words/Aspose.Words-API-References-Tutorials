---
title: Вставить документ при слиянии писем
linktitle: Вставить документ при слиянии писем
second_title: API обработки документов Aspose.Words
description: Узнайте, как вставить документ в другой во время слияния писем с помощью Aspose.Words для .NET.
type: docs
weight: 10
url: /ru/net/clone-and-combine-documents/insert-document-at-mail-merge/
---
В этом уроке мы покажем вам, как вставить документ в другой документ во время слияния почты, используя функцию «Вставить документ во время слияния почты» в Aspose.Words для .NET. Выполните следующие действия, чтобы понять исходный код и выполнить вставку документа.

## Шаг 1: Загрузка основного документа

Для начала укажите каталог для ваших документов и загрузите основной документ в объект Document. Вот как:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENTS DIRECTORY";
Document mainDoc = new Document(MyDir + "Document insert 1.docx");
```

## Шаг 2. Настройте слияние почты

Теперь давайте настроим слияние почты и укажем обратный вызов слияния полей для вставки документа в другой документ. Вот как:

```csharp
mainDoc.MailMerge.FieldMergingCallback = new InsertDocumentAtMailMergeHandler();
```

## Шаг 3. Запуск слияния почты

Мы запустим слияние почты, указав имена полей слияния и соответствующие данные. Вот как:

```csharp
mainDoc.MailMerge.Execute(new[] { "Document_1" }, new object[] { MyDir + "Document insertion 2.docx" });
mainDoc.Save(dataDir + "CloneAndCombineDocuments.InsertDocumentAtMailMerge.doc");
```

### Пример исходного кода для вставки документа при слиянии с использованием Aspose.Words для .NET

Вот полный исходный код функции «Вставка документа в слияние почты» Aspose.Words для .NET:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document mainDoc = new Document(MyDir + "Document insertion 1.docx");

mainDoc.MailMerge.FieldMergingCallback = new InsertDocumentAtMailMergeHandler();
// В основном документе есть поле слияния под названием «Документ_1».
// Соответствующие данные для этого поля содержат полный путь к документу.
// Это должно быть вставлено в это поле.
mainDoc.MailMerge.Execute(new[] { "Document_1" }, new object[] { MyDir + "Document insertion 2.docx" });

mainDoc.Save(dataDir + "CloneAndCombineDocuments.InsertDocumentAtMailMerge.doc");
```

С помощью этого кода вы сможете вставлять документ в другой документ во время слияния почты, используя Aspose.Words для .NET. Полученный документ будет сохранен под новым именем.


## Заключение

В этом руководстве мы рассмотрели, как вставить документ в другой документ во время слияния почты с помощью функции «Вставить документ во время слияния почты» в Aspose.Words для .NET. Настроив слияние почты и предоставив необходимые данные, вы можете динамически собирать документы, объединяя различные шаблоны документов или разделы. Aspose.Words для .NET предоставляет гибкий и мощный способ управления сложными сценариями создания документов, что делает его ценным инструментом для автоматизации задач создания документов и манипулирования ими.

### Часто задаваемые вопросы

#### Вопрос: Какова цель вставки документа в другой документ во время слияния писем?

О: Вставка документа в другой документ во время слияния почты позволяет вам динамически комбинировать различные шаблоны документов или разделы на основе данных, предоставленных в процессе слияния. Эта функция особенно полезна, когда вы хотите собрать сложные документы путем объединения различных предварительно определенных шаблонов или разделов в окончательный документ.

#### Вопрос: Как вставить документ в другой документ во время слияния почты с помощью Aspose.Words for .NET?

О: Чтобы вставить документ в другой документ во время слияния почты с помощью Aspose.Words for .NET, выполните следующие действия:
1. Загрузите основной документ, который будет служить базой, в объект Document.
2. Настройте слияние почты и укажите обратный вызов слияния полей для обработки вставки документа.
3. Запустите слияние писем с именами полей слияния и соответствующими данными (путь к вставляемому документу).

#### Вопрос: Как настроить поведение вставки во время слияния писем?

О: Чтобы настроить поведение вставки во время слияния почты, вы можете реализовать собственный FieldMergingCallback, унаследовав его от интерфейса IFieldMergingCallback. Это позволяет вам контролировать вставку и объединение документов в соответствии с вашими конкретными требованиями.

#### Вопрос: Могу ли я вставить несколько документов во время слияния писем?

О: Да, вы можете вставить несколько документов во время слияния почты, указав соответствующие данные для каждого поля слияния. Для каждого поля слияния, требующего вставки документа, укажите путь к соответствующему документу в качестве данных.


