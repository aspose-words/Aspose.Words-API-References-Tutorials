---
title: Вставить форму
linktitle: Вставить форму
second_title: API обработки документов Aspose.Words
description: Узнайте, как вставлять и изменять фигуры в документах Word с помощью Aspose.Words для .NET, следуя нашему пошаговому руководству.
type: docs
weight: 10
url: /ru/net/programming-with-shapes/insert-shape/
---
## Введение

Когда дело доходит до создания визуально привлекательных и хорошо структурированных документов Word, формы могут играть важную роль. Добавляете ли вы стрелки, блоки или даже сложные пользовательские формы, возможность программно манипулировать этими элементами обеспечивает непревзойденную гибкость. В этом уроке мы рассмотрим, как вставлять и манипулировать формами в документах Word с помощью Aspose.Words для .NET.

## Предпосылки

Прежде чем приступить к изучению руководства, убедитесь, что у вас выполнены следующие предварительные условия:

1.  Aspose.Words для .NET: Загрузите и установите последнюю версию с сайта[Страница релизов Aspose](https://releases.aspose.com/words/net/).
2. Среда разработки: подходящая среда разработки .NET, например Visual Studio.
3. Базовые знания C#: знакомство с языком программирования C# и основными концепциями.

## Импорт пространств имен

Для начала вам необходимо импортировать необходимые пространства имен в ваш проект C#:

```csharp
using Aspose.Words;
using Aspose.Words.Drawing;
```

## Шаг 1: Настройте свой проект

Прежде чем начать вставлять фигуры, вам необходимо настроить свой проект и добавить библиотеку Aspose.Words для .NET.

1. Создайте новый проект: откройте Visual Studio и создайте новый проект консольного приложения C#.
2. Добавьте Aspose.Words для .NET: установите библиотеку Aspose.Words для .NET через диспетчер пакетов NuGet.

```bash
Install-Package Aspose.Words
```

## Шаг 2: Инициализация документа

Сначала вам необходимо инициализировать новый документ и конструктор документов, который поможет в его создании.

```csharp
// Путь к каталогу ваших документов
string dataDir = "YOUR DOCUMENT DIRECTORY";

// Инициализировать новый документ
Document doc = new Document();

// Инициализируйте DocumentBuilder, чтобы помочь создать документ
DocumentBuilder builder = new DocumentBuilder(doc);
```

## Шаг 3: Вставьте фигуру

Теперь давайте вставим фигуру в документ. Начнем с добавления простого текстового поля.

```csharp
// Вставьте форму текстового поля в документ
Shape shape = builder.InsertShape(ShapeType.TextBox, RelativeHorizontalPosition.Page, 100, RelativeVerticalPosition.Page, 100, 50, 50, WrapType.None);

// Повернуть форму
shape.Rotation = 30.0;
```

В этом примере мы вставляем текстовое поле в позицию (100, 100) с шириной и высотой по 50 единиц каждая. Мы также поворачиваем фигуру на 30 градусов.

## Шаг 4: Добавьте еще одну форму

Давайте добавим в документ еще одну фигуру, на этот раз без указания положения.

```csharp
// Добавить еще одну форму текстового поля
Shape secondShape = builder.InsertShape(ShapeType.TextBox, 50, 50);

// Повернуть форму
secondShape.Rotation = 30.0;
```

Этот фрагмент кода вставляет еще одно текстовое поле с такими же размерами и поворотом, как у первого, но без указания его положения.

## Шаг 5: Сохраните документ.

 После добавления фигур последний шаг — сохранить документ. Мы будем использовать`OoxmlSaveOptions` для указания формата сохранения.

```csharp
// Определите параметры сохранения с соблюдением требований
OoxmlSaveOptions saveOptions = new OoxmlSaveOptions(SaveFormat.Docx)
{
    Compliance = OoxmlCompliance.Iso29500_2008_Transitional
};

// Сохранить документ
doc.Save(dataDir + "WorkingWithShapes.InsertShape.docx", saveOptions);
```

## Заключение

И вот оно! Вы успешно вставили и обработали фигуры в документе Word с помощью Aspose.Words для .NET. В этом руководстве были рассмотрены основы, но Aspose.Words предлагает множество дополнительных функций для работы с фигурами, например, пользовательские стили, соединители и групповые фигуры.

 Для более подробной информации посетите[Документация Aspose.Words для .NET](https://reference.aspose.com/words/net/).

## Часто задаваемые вопросы

### Как вставлять различные типы фигур?
Вы можете изменить`ShapeType` в`InsertShape` метод вставки различных типов фигур, таких как круги, прямоугольники и стрелки.

### Могу ли я добавить текст внутри фигур?
 Да, вы можете использовать`builder.Write` метод добавления текста внутрь фигур после их вставки.

### Можно ли стилизовать формы?
 Да, вы можете стилизовать фигуры, задавая такие свойства, как`FillColor`, `StrokeColor` , и`StrokeWeight`.

### Как позиционировать фигуры относительно других элементов?
 Используйте`RelativeHorizontalPosition` и`RelativeVerticalPosition` свойства для позиционирования фигур относительно других элементов в документе.

### Могу ли я сгруппировать несколько фигур вместе?
 Да, Aspose.Words для .NET позволяет группировать фигуры с помощью`GroupShape` сорт.