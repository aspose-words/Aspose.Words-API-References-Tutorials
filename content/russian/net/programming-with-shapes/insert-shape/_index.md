---
title: Вставить фигуру
linktitle: Вставить фигуру
second_title: API обработки документов Aspose.Words
description: Узнайте, как вставлять фигуры в документы Word и манипулировать ими с помощью Aspose.Words for .NET, с помощью нашего пошагового руководства.
type: docs
weight: 10
url: /ru/net/programming-with-shapes/insert-shape/
---
## Введение

Когда дело доходит до создания визуально привлекательных и хорошо структурированных документов Word, формы могут сыграть жизненно важную роль. Добавляете ли вы стрелки, прямоугольники или даже сложные пользовательские фигуры, возможность программного управления этими элементами обеспечивает беспрецедентную гибкость. В этом уроке мы рассмотрим, как вставлять фигуры в документы Word и манипулировать ими с помощью Aspose.Words для .NET.

## Предварительные условия

Прежде чем приступить к изучению руководства, убедитесь, что у вас есть следующие предварительные условия:

1.  Aspose.Words для .NET: загрузите и установите последнюю версию с сайта[Страница релизов Aspose](https://releases.aspose.com/words/net/).
2. Среда разработки: подходящая среда разработки .NET, например Visual Studio.
3. Базовые знания C#: Знакомство с языком программирования C# и основными концепциями.

## Импортировать пространства имен

Для начала вам необходимо импортировать необходимые пространства имен в ваш проект C#:

```csharp
using Aspose.Words;
using Aspose.Words.Drawing;
```

## Шаг 1. Настройте свой проект

Прежде чем вы сможете начать вставлять фигуры, вам необходимо настроить проект и добавить библиотеку Aspose.Words для .NET.

1. Создайте новый проект. Откройте Visual Studio и создайте новый проект консольного приложения C#.
2. Добавьте Aspose.Words for .NET: установите библиотеку Aspose.Words for .NET через диспетчер пакетов NuGet.

```bash
Install-Package Aspose.Words
```

## Шаг 2. Инициализируйте документ

Во-первых, вам нужно будет инициализировать новый документ и построитель документов, который поможет в создании документа.

```csharp
// Путь к каталогу ваших документов
string dataDir = "YOUR DOCUMENT DIRECTORY";

// Инициализировать новый документ
Document doc = new Document();

// Инициализируйте DocumentBuilder, чтобы помочь создать документ.
DocumentBuilder builder = new DocumentBuilder(doc);
```

## Шаг 3. Вставьте фигуру

Теперь давайте вставим фигуру в документ. Начнем с добавления простого текстового поля.

```csharp
// Вставка фигуры текстового поля в документ
Shape shape = builder.InsertShape(ShapeType.TextBox, RelativeHorizontalPosition.Page, 100, RelativeVerticalPosition.Page, 100, 50, 50, WrapType.None);

// Поворот фигуры
shape.Rotation = 30.0;
```

В этом примере мы вставляем текстовое поле в позицию (100, 100) шириной и высотой по 50 единиц каждое. Также поворачиваем фигуру на 30 градусов.

## Шаг 4: Добавьте еще одну фигуру

Давайте добавим в документ еще одну фигуру, на этот раз без указания положения.

```csharp
// Добавьте еще одну форму текстового поля
Shape secondShape = builder.InsertShape(ShapeType.TextBox, 50, 50);

// Поворот фигуры
secondShape.Rotation = 30.0;
```

Этот фрагмент кода вставляет еще одно текстовое поле с теми же размерами и поворотом, что и первое, но без указания его положения.

## Шаг 5: Сохраните документ

 После добавления фигур последний шаг — сохранить документ. Мы будем использовать`OoxmlSaveOptions` чтобы указать формат сохранения.

```csharp
// Определите параметры сохранения с соблюдением требований
OoxmlSaveOptions saveOptions = new OoxmlSaveOptions(SaveFormat.Docx)
{
    Compliance = OoxmlCompliance.Iso29500_2008_Transitional
};

// Сохраните документ
doc.Save(dataDir + "WorkingWithShapes.InsertShape.docx", saveOptions);
```

## Заключение

И вот оно! Вы успешно вставили фигуры в документ Word и манипулировали ими с помощью Aspose.Words for .NET. В этом руководстве рассмотрены основы, но Aspose.Words предлагает множество более продвинутых функций для работы с фигурами, таких как пользовательские стили, соединители и групповые фигуры.

 Для получения более подробной информации посетите[Документация Aspose.Words для .NET](https://reference.aspose.com/words/net/).

## Часто задаваемые вопросы

### Как вставлять разные типы фигур?
Вы можете изменить`ShapeType` в`InsertShape` метод для вставки различных типов фигур, таких как круги, прямоугольники и стрелки.

### Могу ли я добавить текст внутри фигур?
 Да, вы можете использовать`builder.Write` метод для добавления текста внутри фигур после их вставки.

### Можно ли стилизовать фигуры?
 Да, вы можете стилизовать фигуры, установив такие свойства, как`FillColor`, `StrokeColor` , и`StrokeWeight`.

### Как расположить фигуры относительно других элементов?
 Используйте`RelativeHorizontalPosition`и`RelativeVerticalPosition` свойства для расположения фигур относительно других элементов в документе.

### Могу ли я сгруппировать несколько фигур вместе?
 Да, Aspose.Words для .NET позволяет группировать фигуры с помощью`GroupShape` сорт.