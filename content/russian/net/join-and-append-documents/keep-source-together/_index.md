---
title: Держите стол вместе
linktitle: Держите стол вместе
second_title: API обработки документов Aspose.Words
description: Узнайте, как предотвратить разрыв таблиц на разных страницах с помощью Aspose.Words для .NET с помощью этого пошагового руководства. Обеспечьте аккуратный, профессионально выглядящий документ Word
type: docs
weight: 10
url: /ru/net/join-and-append-documents/keep-source-together/
---
## Введение

Таблицы являются неотъемлемой частью многих документов Word, но иногда вы можете столкнуться с ситуацией, когда ваша таблица разбивается на две страницы. Это может нарушить поток вашего документа и повлиять на его читаемость. Разве не было бы здорово, если бы был способ сохранить всю таблицу вместе на одной странице? Что ж, с Aspose.Words для .NET есть простое решение этой проблемы! В этом уроке мы рассмотрим, как предотвратить разбиение таблиц на страницы, гарантируя, что ваш документ будет выглядеть аккуратно и профессионально.

## Предпосылки

Прежде чем приступить к обучению, давайте убедимся, что у вас есть все необходимое для успешного освоения материала.

### Библиотека Aspose.Words для .NET

Во-первых, вам нужно установить Aspose.Words for .NET. Это мощная библиотека, которая позволяет вам работать с документами Word программно.

- [Загрузить Aspose.Words для .NET](https://releases.aspose.com/words/net/)

### Среда разработки

У вас должна быть настроена среда разработки для запуска кода C#, например:

- Visual Studio (любая последняя версия)
- .NET Framework 2.0 или более поздняя версия

### Документ Word с таблицей

 Вам понадобится документ Word, содержащий таблицу. В этом уроке мы будем работать с образцом документа под названием`"Table spanning two pages.docx"`. Этот файл содержит таблицу, которая в настоящее время занимает две страницы.

### Временная лицензия (необязательно)

 Хотя Aspose.Words поставляется с бесплатной пробной версией, вы можете использовать[временная лицензия](https://purchase.aspose.com/temporary-license/) раскрыть весь потенциал библиотеки.

## Импортные пакеты

Перед написанием любого кода нам нужно импортировать необходимые пространства имен для работы с Aspose.Words for .NET. Добавьте следующие импорты в начало вашего файла кода:

```csharp
using Aspose.Words;
using Aspose.Words.Tables;
```

 Эти пространства имен предоставляют вам доступ к таким классам, как`Document`, `Table`, `Cell`и другие, которые мы будем использовать в этом уроке.

## Шаг 1: Загрузите документ

 Первое, что нам нужно сделать, это загрузить документ Word, содержащий таблицу. Для этого мы воспользуемся`Document` класс из Aspose.Words. Этот класс позволяет открывать и обрабатывать файлы Word программным способом.

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENTS DIRECTORY";

Document doc = new Document(dataDir + "Table spanning two pages.docx");
```

 В этом фрагменте кода мы указываем местоположение нашего документа. Заменить`"YOUR DOCUMENTS DIRECTORY"` с фактическим каталогом, где хранится ваш документ.

## Шаг 2: Доступ к таблице

После загрузки документа следующим шагом будет доступ к таблице, которую мы хотим сохранить. В этом примере мы предполагаем, что таблица является первой таблицей в документе.

```csharp
Table table = (Table) doc.GetChild(NodeType.Table, 0, true);
```

 Эта строка кода находит первую таблицу в документе.`GetChild` метод извлекает определенный тип узла, который в данном случае является`NodeType.Table` .`0` указывает, что нам нужна первая таблица, а`true`флаг гарантирует, что мы будем выполнять рекурсивный поиск по всем дочерним узлам.

## Шаг 3: Цикл по ячейкам таблицы

Теперь нам нужно пройтись по каждой ячейке в таблице. Поскольку таблица содержит несколько строк, а каждая строка содержит несколько ячеек, мы пройдемся по каждой ячейке и убедимся, что она не разобьется на страницах.

```csharp
foreach (Cell cell in table.GetChildNodes(NodeType.Cell, true))
{
    cell.EnsureMinimum();
```

 Здесь,`GetChildNodes` извлекает все ячейки в таблице, и мы проходим по каждой из них.`EnsureMinimum()` Метод гарантирует, что каждая ячейка содержит хотя бы один абзац, так как пустая ячейка может вызвать проблемы в дальнейшем.

## Шаг 4: Установите свойство KeepWithNext

 Чтобы таблица не разрывалась на разных страницах, нам нужно установить`KeepWithNext` свойство для каждого абзаца в таблице. Это свойство гарантирует, что абзац останется со следующим абзацем, эффективно предотвращая разрывы страниц между ними.

```csharp
    foreach (Paragraph para in cell.Paragraphs)
        if (!(cell.ParentRow.IsLastRow && para.IsEndOfCell))
            para.ParagraphFormat.KeepWithNext = true;
```

 Этот цикл проверяет каждый абзац внутри каждой ячейки. Условие гарантирует, что мы не применим`KeepWithNext`свойство к последнему абзацу в последней строке. В противном случае свойство не будет иметь никакого эффекта, поскольку нет следующего абзаца.

## Шаг 5: Сохраните документ.

 Наконец, после применения`KeepWithNext` свойство, нам необходимо сохранить измененный документ.

```csharp
doc.Save(dataDir + "WorkingWithTables.KeepTableTogether.docx");
```

Эта строка сохраняет обновленный документ с новым именем, сохраняя исходный файл. Теперь вы можете открыть полученный файл и увидеть, что таблица больше не разделена на две страницы!

## Заключение

И вот вам! Выполнив эти простые шаги, вы можете легко предотвратить разрыв таблиц на разных страницах в документах Word с помощью Aspose.Words для .NET. Независимо от того, работаете ли вы над отчетами, контрактами или другими документами, сохранение таблиц в целости обеспечивает более отточенный, профессиональный вид.

Прелесть Aspose.Words заключается в его гибкости и простоте использования, что позволяет вам программно манипулировать документами Word без необходимости установки Microsoft Word на вашем компьютере. Теперь, когда вы освоили ведение таблиц вместе, изучите другие возможности библиотеки, чтобы вывести свои навыки обработки документов на новый уровень!

## Часто задаваемые вопросы

### Почему моя таблица все еще разрывается между страницами после использования этого кода?

 Если ваш стол все еще ломается, убедитесь, что вы применили`KeepWithNext` свойство правильно. Дважды проверьте, что все абзацы, кроме последнего, в каждой ячейке имеют это свойство.

### Могу ли я сохранить вместе только определенные строки?

 Да, вы можете выборочно применять`KeepWithNext` свойство для определенных строк или абзацев в таблице, чтобы контролировать, какие части должны оставаться вместе.

### Работает ли этот метод с большими таблицами?

Для очень больших таблиц Word может по-прежнему разбивать их на страницы, если на одной странице недостаточно места для размещения всей таблицы. Рассмотрите возможность настройки форматирования или полей таблицы для размещения больших таблиц.

### Могу ли я использовать этот метод с другими форматами документов?

Да! Aspose.Words for .NET поддерживает множество форматов, таких как DOC, DOCX, PDF и другие. Этот же метод работает во всех форматах, поддерживающих таблицы.

### Является ли Aspose.Words for .NET бесплатной библиотекой?

 Aspose.Words for .NET предлагает бесплатную пробную версию, но для полного доступа ко всем функциям вам необходимо приобрести лицензию. Вы можете изучить варианты лицензирования на[Страница покупки Aspose](https://purchase.aspose.com/buy).