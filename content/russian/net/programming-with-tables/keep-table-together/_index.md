---
title: Держите стол вместе
linktitle: Держите стол вместе
second_title: API обработки документов Aspose.Words
description: Узнайте, как предотвратить разбивку таблиц по страницам в документах Word с помощью Aspose.Words для .NET. Следуйте нашему руководству, чтобы поддерживать профессиональные и читаемые документы.
type: docs
weight: 10
url: /ru/net/programming-with-tables/keep-table-together/
---
## Введение

Вы когда-нибудь расстраивались, когда таблица в вашем документе Word разделялась на две страницы? Как будто ваша тщательно выложенная информация вдруг решила сделать перерыв на полпути! Размещение таблиц на одной странице имеет решающее значение для читабельности и представления. Будь то отчет, проектное предложение или просто личный документ, разделение таблиц может быть весьма неприятным. К счастью для нас, в Aspose.Words for .NET есть отличный способ решить эту проблему. В этом уроке мы рассмотрим шаги, которые помогут сохранить ваши столы в целости и сохранности. Давайте погрузимся!

## Предварительные условия

Прежде чем мы начнем, убедитесь, что у вас есть следующее:

1.  Aspose.Words для .NET. Если вы еще не установили его, его можно загрузить с сайта[здесь](https://releases.aspose.com/words/net/).
2. Документ Word с таблицей. Мы будем работать с образцом документа, в котором таблица занимает несколько страниц.
3. Базовые знания C#. В этом руководстве предполагается, что у вас есть базовые знания программирования на C#.

## Импортировать пространства имен

Прежде всего, давайте импортируем необходимые пространства имен. Это даст нам доступ к необходимым нам классам и методам из Aspose.Words для .NET.

```csharp
using Aspose.Words;
using Aspose.Words.Tables;
```

Давайте разобьем этот процесс на простые и понятные шаги. Мы начнем с загрузки нашего документа и закончим сохранением обновленного документа, в котором таблица останется целой.

## Шаг 1. Загрузите документ

 Чтобы работать с документом Word, нам сначала необходимо его загрузить. Мы будем использовать`Document` класс для этого.

```csharp
// Путь к каталогу ваших документов
string dataDir = "YOUR DOCUMENT DIRECTORY";

Document doc = new Document(dataDir + "Table spanning two pages.docx");
```

## Шаг 2. Доступ к таблице

Далее нам нужно получить таблицу, которую мы хотим сохранить. Предположим, что это первая таблица в документе.

```csharp
Table table = (Table) doc.GetChild(NodeType.Table, 0, true);
```

## Шаг 3. Установите KeepWithNext для абзацев

 Чтобы таблица не разбивалась на страницы, нам нужно установить`KeepWithNext` свойство для каждого абзаца таблицы, за исключением последних абзацев последней строки.

```csharp
foreach (Cell cell in table.GetChildNodes(NodeType.Cell, true))
{
    cell.EnsureMinimum();
    foreach (Paragraph para in cell.Paragraphs)
    {
        if (!(cell.ParentRow.IsLastRow && para.IsEndOfCell))
            para.ParagraphFormat.KeepWithNext = true;
    }
}
```

## Шаг 4. Сохраните документ

Наконец, мы сохраняем обновленный документ. Это применит наши изменения и обеспечит сохранение таблицы на одной странице.

```csharp
doc.Save(dataDir + "WorkingWithTables.KeepTableTogether.docx");
```

## Заключение

И вот оно! С помощью всего лишь нескольких строк кода вы можете предотвратить разбиение таблиц на страницы в документах Word. Это простое, но эффективное решение гарантирует, что ваши таблицы останутся аккуратными и профессиональными, улучшая читаемость ваших документов. Aspose.Words for .NET упрощает решение таких проблем с форматированием, позволяя вам сосредоточиться на создании отличного контента.

## Часто задаваемые вопросы

### Могу ли я объединить несколько таблиц, используя этот метод?  
Да, вы можете применить одну и ту же логику к нескольким таблицам, просматривая каждую таблицу в документе.

### Что делать, если моя таблица слишком велика и не помещается на одной странице?  
Если таблица слишком велика и не помещается на одной странице, она все равно будет охватывать несколько страниц. Этот метод гарантирует, что таблицы меньшего размера останутся нетронутыми без разделения.

### Есть ли способ автоматизировать это для всех таблиц в документе?  
 Да, вы можете просмотреть все таблицы в документе и применить`KeepWithNext` свойство к каждому абзацу.

### Нужна ли мне платная лицензия на Aspose.Words для .NET?  
Вы можете начать с бесплатной пробной версии с[здесь](https://releases.aspose.com/), но для полной функциональности рекомендуется платная лицензия.

### Могу ли я применить к таблице другое форматирование, сохранив ее целостность?  
Абсолютно! Вы можете отформатировать таблицу по мере необходимости, сохраняя при этом ее целостность на одной странице.