---
title: Держите стол вместе
linktitle: Держите стол вместе
second_title: API обработки документов Aspose.Words
description: Узнайте, как предотвратить разрыв таблиц между страницами в документах Word с помощью Aspose.Words для .NET. Следуйте нашему руководству, чтобы поддерживать профессиональные, читабельные документы.
type: docs
weight: 10
url: /ru/net/programming-with-tables/keep-table-together/
---
## Введение

Вы когда-нибудь были разочарованы, когда таблица в документе Word разбивалась на две страницы? Это как будто ваша тщательно выложенная информация внезапно решила сделать перерыв на полпути! Размещение таблиц на одной странице имеет решающее значение для удобства чтения и представления. Будь то отчет, проектное предложение или просто личный документ, разделение таблиц может быть довольно резким. К счастью для нас, Aspose.Words for .NET предлагает отличный способ решения этой проблемы. В этом руководстве мы рассмотрим шаги, которые позволят сохранить ваши таблицы целыми и четкими. Давайте погрузимся в это!

## Предпосылки

Прежде чем начать, убедитесь, что у вас есть следующее:

1.  Aspose.Words для .NET — если вы еще не установили его, вы можете загрузить его с[здесь](https://releases.aspose.com/words/net/).
2. Документ Word с таблицей. Мы будем работать с образцом документа, который содержит таблицу, охватывающую несколько страниц.
3. Базовые знания C#. В этом руководстве предполагается, что у вас есть базовые знания программирования на C#.

## Импорт пространств имен

Для начала давайте импортируем необходимые пространства имен. Это даст нам доступ к нужным нам классам и методам из Aspose.Words for .NET.

```csharp
using Aspose.Words;
using Aspose.Words.Tables;
```

Давайте разобьем процесс на простые, усвояемые шаги. Начнем с загрузки нашего документа и закончим сохранением обновленного документа, в котором таблица остается вместе.

## Шаг 1: Загрузите документ

 Для работы с документом Word нам сначала нужно его загрузить. Мы будем использовать`Document` класс за это.

```csharp
// Путь к каталогу ваших документов
string dataDir = "YOUR DOCUMENT DIRECTORY";

Document doc = new Document(dataDir + "Table spanning two pages.docx");
```

## Шаг 2: Доступ к таблице

Далее нам нужно получить таблицу, которую мы хотим сохранить. Предположим, что это первая таблица в документе.

```csharp
Table table = (Table) doc.GetChild(NodeType.Table, 0, true);
```

## Шаг 3: Установите KeepWithNext для абзацев

 Чтобы таблица не разрывалась на разных страницах, нам нужно установить`KeepWithNext` свойство для каждого абзаца в таблице, за исключением последних абзацев в последней строке.

```csharp
foreach (Cell cell in table.GetChildNodes(NodeType.Cell, true))
{
    cell.EnsureMinimum();
    foreach (Paragraph para in cell.Paragraphs)
    {
        if (!(cell.ParentRow.IsLastRow && para.IsEndOfCell))
            para.ParagraphFormat.KeepWithNext = true;
    }
}
```

## Шаг 4: Сохраните документ.

Наконец, сохраняем обновленный документ. Это применит наши изменения и обеспечит сохранение таблицы на одной странице.

```csharp
doc.Save(dataDir + "WorkingWithTables.KeepTableTogether.docx");
```

## Заключение

И вот оно! Всего несколько строк кода — и вы можете предотвратить разбиение таблиц на страницы в документах Word. Это простое, но эффективное решение гарантирует, что ваши таблицы останутся аккуратными и профессиональными, что повысит читабельность ваших документов. Aspose.Words для .NET упрощает обработку таких проблем с форматированием, позволяя вам сосредоточиться на создании отличного контента.

## Часто задаваемые вопросы

### Можно ли с помощью этого метода объединить несколько таблиц?  
Да, вы можете применить одну и ту же логику к нескольким таблицам, выполнив итерацию по каждой таблице в документе.

### Что делать, если моя таблица слишком велика и не помещается на одной странице?  
Если таблица слишком велика, чтобы поместиться на одной странице, она все равно будет охватывать несколько страниц. Этот метод гарантирует, что таблицы меньшего размера останутся нетронутыми без разбиения.

### Есть ли способ автоматизировать это для всех таблиц в документе?  
 Да, вы можете просмотреть все таблицы в документе и применить`KeepWithNext` свойство к каждому абзацу.

### Нужна ли мне платная лицензия для Aspose.Words для .NET?  
Вы можете начать с бесплатной пробной версии[здесь](https://releases.aspose.com/), но для полной функциональности рекомендуется платная лицензия.

### Могу ли я применить другое форматирование к таблице, сохранив ее целостность?  
Конечно! Вы можете отформатировать таблицу по своему усмотрению, при этом убедившись, что она находится на одной странице.