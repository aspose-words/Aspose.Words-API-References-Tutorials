---
title: Предпочтительные настройки ширины
linktitle: Предпочтительные настройки ширины
second_title: API обработки документов Aspose.Words
description: Узнайте, как создавать таблицы с абсолютной, относительной и автоматической настройкой ширины в Aspose.Words для .NET с помощью этого пошагового руководства.
type: docs
weight: 10
url: /ru/net/programming-with-tables/preferred-width-settings/
---
## Введение

Таблицы — это мощный способ систематизировать и представить информацию в документах Word. При работе с таблицами в Aspose.Words for .NET у вас есть несколько вариантов установки ширины ячеек таблицы, чтобы они идеально соответствовали макету вашего документа. Это руководство проведет вас через процесс создания таблиц с предпочтительными настройками ширины с помощью Aspose.Words для .NET, уделяя особое внимание параметрам абсолютного, относительного и автоматического размера. 

## Предварительные условия

Прежде чем приступить к изучению руководства, убедитесь, что у вас есть следующее:

1.  Aspose.Words for .NET: убедитесь, что в вашей среде разработки установлен Aspose.Words for .NET. Вы можете скачать его[здесь](https://releases.aspose.com/words/net/).

2. Среда разработки .NET: настройте среду разработки .NET, например Visual Studio.

3. Базовые знания C#. Знакомство с программированием на C# поможет вам лучше понять фрагменты кода и примеры.

4.  Документация Aspose.Words: см.[Документация Aspose.Words](https://reference.aspose.com/words/net/) для получения подробной информации об API и дальнейшего чтения.

## Импортировать пространства имен

Прежде чем приступить к написанию кода, вам необходимо импортировать необходимые пространства имен в ваш проект C#:

```csharp
using Aspose.Words;
using Aspose.Words.Tables;
```

Эти пространства имен обеспечивают доступ к основным функциям Aspose.Words и объекту Table, позволяя вам манипулировать таблицами документов.

Давайте разобьем процесс создания таблицы с различными предпочтительными настройками ширины на понятные и выполнимые шаги.

## Шаг 1. Инициализируйте документ и DocumentBuilder

Рубрика: Создание нового документа и DocumentBuilder

 Объяснение: Начните с создания нового документа Word и`DocumentBuilder` пример.`DocumentBuilder` Класс предоставляет простой способ добавления содержимого в документ.

```csharp
// Определите путь для сохранения документа.
string dataDir = "YOUR DOCUMENT DIRECTORY";

// Создайте новый документ.
Document doc = new Document();

// Создайте DocumentBuilder для этого документа.
DocumentBuilder builder = new DocumentBuilder(doc);
```

 Здесь вы указываете каталог, в котором будет сохранен документ, и инициализируете`Document`и`DocumentBuilder` объекты.

## Шаг 2. Вставьте первую ячейку таблицы с абсолютной шириной

Вставьте первую ячейку в таблицу с фиксированной шириной 40 пунктов. Это гарантирует, что эта ячейка всегда будет иметь ширину 40 пунктов независимо от размера таблицы.

```csharp

// Вставьте ячейку абсолютного размера.
builder.InsertCell();
builder.CellFormat.PreferredWidth = PreferredWidth.FromPoints(40);
builder.CellFormat.Shading.BackgroundPatternColor = Color.LightYellow;
builder.Writeln("Cell at 40 points width");
```

На этом этапе вы начинаете создавать таблицу и вставляете ячейку абсолютной ширины.`PreferredWidth.FromPoints(40)` метод устанавливает ширину ячейки равной 40 точкам, и`Shading.BackgroundPatternColor` применяет светло-желтый цвет фона.

## Шаг 3. Вставьте ячейку относительного размера

Вставьте еще одну ячейку шириной 20 % от общей ширины таблицы. Этот относительный размер гарантирует, что ячейка будет пропорционально ширине таблицы.

```csharp
// Вставьте ячейку относительного (процентного) размера.
builder.InsertCell();
builder.CellFormat.PreferredWidth = PreferredWidth.FromPercent(20);
builder.CellFormat.Shading.BackgroundPatternColor = Color.LightBlue;
builder.Writeln("Cell at 20% width");
```

Ширина этой ячейки будет составлять 20 % от общей ширины таблицы, что позволяет адаптировать ее к различным размерам экрана или макетам документов.

### Шаг 4. Вставьте ячейку с автоматическим размером

Наконец, вставьте ячейку, размер которой автоматически изменяется в зависимости от оставшегося доступного места в таблице.

```csharp
// Вставьте ячейку с автоматическим размером.
builder.InsertCell();
builder.CellFormat.PreferredWidth = PreferredWidth.Auto;
builder.CellFormat.Shading.BackgroundPatternColor = Color.LightGreen;
builder.Writeln("Cell automatically sized. The size of this cell is calculated from the table preferred width.");
builder.Writeln("In this case the cell will fill up the rest of the available space.");
```

`PreferredWidth.Auto` Настройка позволяет этой ячейке расширяться или сжиматься в зависимости от пространства, оставшегося после учета других ячеек. Это гарантирует, что расположение стола будет выглядеть сбалансированным и профессиональным.

## Шаг 5. Завершите оформление и сохраните документ

Вставив все ячейки, заполните таблицу и сохраните документ по указанному вами пути.

```csharp
// Сохраните документ.
doc.Save(dataDir + "WorkingWithTables.PreferredWidthSettings.docx");
```

На этом этапе таблица завершается, а документ сохраняется под именем «WorkingWithTables.PreferredWidthSettings.docx» в указанном вами каталоге.

## Заключение

Создание таблиц с предпочтительными настройками ширины в Aspose.Words для .NET не составит труда, если вы поймете различные доступные параметры размера. Если вам нужна фиксированная, относительная или автоматическая ширина ячеек, Aspose.Words обеспечивает гибкость для эффективной обработки различных сценариев компоновки таблиц. Следуя шагам, описанным в этом руководстве, вы сможете обеспечить хорошо структурированную и визуально привлекательную таблицу в документах Word.

## Часто задаваемые вопросы

### В чем разница между абсолютной и относительной шириной ячеек?
Абсолютная ширина ячеек фиксирована и не меняется, а относительная ширина регулируется в зависимости от общей ширины таблицы.

### Могу ли я использовать отрицательные проценты для относительной ширины?
Нет, отрицательные проценты недопустимы для ширины ячеек. Допускаются только положительные проценты.

### Как работает функция автоматического изменения размера?
Автоматическое изменение размера регулирует ширину ячейки, чтобы заполнить все оставшееся пространство в таблице после изменения размера других ячеек.

### Могу ли я применять разные стили к ячейкам с разными настройками ширины?
Да, вы можете применять к ячейкам различные стили и форматирование независимо от настроек их ширины.

### Что произойдет, если общая ширина таблицы меньше суммы ширин всех ячеек?
Таблица автоматически отрегулирует ширину ячеек в соответствии с доступным пространством, что может привести к уменьшению некоторых ячеек.