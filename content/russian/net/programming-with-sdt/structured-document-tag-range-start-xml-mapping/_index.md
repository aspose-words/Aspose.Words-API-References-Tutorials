---
title: Диапазон тегов структурированного документа. Начало сопоставления XML.
linktitle: Диапазон тегов структурированного документа. Начало сопоставления XML.
second_title: API обработки документов Aspose.Words
description: Узнайте, как динамически привязывать данные XML к тегам структурированных документов в Word с помощью Aspose.Words для .NET. Следуйте нашему пошаговому руководству.
type: docs
weight: 10
url: /ru/net/programming-with-sdt/structured-document-tag-range-start-xml-mapping/
---
## Введение

Вы когда-нибудь хотели динамически вставлять данные XML в документ Word? Что ж, вам повезло! Aspose.Words для .NET упрощает эту задачу. В этом руководстве мы углубимся в сопоставление начального XML-сопоставления диапазона тегов структурированного документа. Эта функция позволяет вам привязывать пользовательские части XML к элементам управления содержимым, обеспечивая плавное обновление содержимого вашего документа вместе с вашими XML-данными. Готовы превратить ваши документы в динамичные шедевры.

## Предварительные условия

Прежде чем мы перейдем к кодированию, давайте убедимся, что у вас есть все необходимое:

1.  Библиотека Aspose.Words для .NET: убедитесь, что у вас установлена последняя версия. Вы можете скачать его[здесь](https://releases.aspose.com/words/net/).
2. Среда разработки: Visual Studio или любая другая среда разработки, поддерживающая C#.
3. Базовые знания C#: Знание программирования на C# обязательно.
4. Документ Word: образец документа Word для работы.

## Импортировать пространства имен

Прежде всего, давайте импортируем необходимые пространства имен. Это обеспечит доступ ко всем необходимым классам и методам в Aspose.Words для .NET.

```csharp
using System;
using Aspose.Words;
using Aspose.Words.Markup;
using System.Text;
```

## Шаг 1. Настройте каталог документов

Каждому проекту нужен фундамент, верно? Здесь мы устанавливаем путь к каталогу ваших документов.

```csharp
// Путь к каталогу ваших документов
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## Шаг 2. Загрузите документ Word

Далее загружаем документ Word. Это документ, в который мы будем вставлять наши XML-данные.

```csharp
Document doc = new Document(dataDir + "Multi-section structured document tags.docx");
```

## Шаг 3. Добавьте пользовательскую часть XML

Нам нужно создать часть XML, содержащую данные, которые мы хотим вставить, и добавить ее в коллекцию CustomXmlPart документа. Эта пользовательская часть XML будет служить источником данных для наших тегов структурированного документа.

### Создание XML-части

Сначала сгенерируйте уникальный идентификатор для части XML и определите его содержимое.

```csharp
// Создайте часть XML, содержащую данные, и добавьте ее в коллекцию CustomXmlPart документа.
string xmlPartId = Guid.NewGuid().ToString("B");
string xmlPartContent = "<root><text>Text element #1</text><text>Text element #2</text></root>";
CustomXmlPart xmlPart = doc.CustomXmlParts.Add(xmlPartId, xmlPartContent);
```

### Проверка содержимого части XML

Чтобы убедиться, что часть XML добавлена правильно, мы печатаем ее содержимое.

```csharp
Console.WriteLine(Encoding.UTF8.GetString(xmlPart.Data));
```

## Шаг 4. Создайте тег структурированного документа

Тег структурированного документа (SDT) — это элемент управления содержимым, который можно привязать к части XML. Здесь мы создаем SDT, который будет отображать содержимое нашей пользовательской части XML.

Сначала найдите начало диапазона SDT в документе.

```csharp
StructuredDocumentTagRangeStart sdtRangeStart = (StructuredDocumentTagRangeStart)doc.GetChild(NodeType.StructuredDocumentTagRangeStart, 0, true);
```

## Шаг 5. Установите сопоставление XML для SDT

Теперь пришло время связать нашу XML-часть с SDT. Устанавливая сопоставление XML, мы указываем, какая часть данных XML должна отображаться в SDT.

 XPath указывает на конкретный элемент XML-части, который мы хотим отобразить. Здесь мы указываем на второй`<text>` элемент внутри`<root>` элемент.

```csharp
// Установите сопоставление для нашего StructuredDocumentTag.
sdtRangeStart.XmlMapping.SetMapping(xmlPart, "/root[1]/text[2]", null);
```

## Шаг 6: Сохраните документ

Наконец, сохраните документ, чтобы увидеть изменения в действии. SDT в документе Word теперь будет отображать указанное содержимое XML.

```csharp
doc.Save(dataDir + "WorkingWithSdt.StructuredDocumentTagRangeStartXmlMapping.docx");
```

## Заключение

И вот оно! Вы успешно сопоставили часть XML с тегом структурированного документа в документе Word с помощью Aspose.Words для .NET. Эта мощная функция позволяет без особых усилий создавать динамические и управляемые данными документы. Независимо от того, создаете ли вы отчеты, счета-фактуры или документы любого другого типа, сопоставление XML может значительно упростить ваш рабочий процесс.

## Часто задаваемые вопросы

### Что такое структурированный тег документа в Word?
Теги структурированных документов, также известные как элементы управления содержимым, представляют собой контейнеры для определенных типов содержимого в документах Word. Их можно использовать для привязки данных, ограничения редактирования или помощи пользователям в создании документов.

### Как я могу динамически обновлять содержимое части XML?
 Вы можете обновить содержимое части XML, изменив`xmlPartContent` строку перед добавлением ее в документ. Просто обновите строку новыми данными и добавьте ее в`CustomXmlParts` коллекция.

### Могу ли я связать несколько частей XML с разными SDT в одном документе?
Да, вы можете связать несколько частей XML с разными SDT в одном документе. Каждый SDT может иметь свою собственную уникальную часть XML и сопоставление XPath.

### Можно ли сопоставить сложные структуры XML с SDT?
Абсолютно! Вы можете сопоставить сложные структуры XML с SDT, используя подробные выражения XPath, которые точно указывают на нужные элементы внутри части XML.

### Как удалить часть XML из документа?
 Вы можете удалить часть XML, вызвав`Remove` метод на`CustomXmlParts` сбор, прохождение`xmlPartId` части XML, которую вы хотите удалить.